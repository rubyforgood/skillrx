// cytoscape@3.31.2 downloaded from https://ga.jspm.io/npm:cytoscape@3.31.2/dist/cytoscape.esm.mjs

function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||false,n.configurable=true,"value"in n&&(n.writable=true),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),Object.defineProperty(e,"prototype",{writable:false}),e}function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t){a&&(e=a);var n=0,F=function(){};return{s:F,n:function(){return n>=e.length?{done:true}:{done:false,value:e[n++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=true,s=false;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){s=true,i=e},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw i}}}}function _defineProperty$1(e,t,a){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:a,enumerable:true,configurable:true,writable:true}):e[t]=a,e}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterableToArrayLimit(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,o,s,l=[],u=true,v=false;try{if(o=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;u=!1}else for(;!(u=(n=o.call(a)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){v=true,i=e}finally{try{if(!u&&null!=a.return&&(s=a.return(),Object(s)!==s))return}finally{if(v)throw i}}return l}}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:t+""}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}var e=typeof window==="undefined"?null:window;var t=e?e.navigator:null;e?e.document:null;var a=_typeof("");var n=_typeof({});var i=_typeof((function(){}));var o=typeof HTMLElement==="undefined"?"undefined":_typeof(HTMLElement);var s=function instanceStr(e){return e&&e.instanceString&&u(e.instanceString)?e.instanceString():null};var l=function string(e){return e!=null&&_typeof(e)==a};var u=function fn(e){return e!=null&&_typeof(e)===i};var v=function array(e){return!y(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)};var c=function plainObject(e){return e!=null&&_typeof(e)===n&&!v(e)&&e.constructor===Object};var d=function object(e){return e!=null&&_typeof(e)===n};var h=function number(e){return e!=null&&_typeof(e)===_typeof(1)&&!isNaN(e)};var p=function integer(e){return h(e)&&Math.floor(e)===e};var g=function htmlElement(e){return"undefined"===o?void 0:null!=e&&e instanceof HTMLElement};var y=function elementOrCollection(e){return m(e)||b(e)};var m=function element(e){return s(e)==="collection"&&e._private.single};var b=function collection(e){return s(e)==="collection"&&!e._private.single};var x=function core(e){return s(e)==="core"};var w=function stylesheet(e){return s(e)==="stylesheet"};var E=function event(e){return s(e)==="event"};var T=function emptyString(e){return e===void 0||e===null||!(e!==""&&!e.match(/^\s+$/))};var S=function domElement(e){return typeof HTMLElement!=="undefined"&&e instanceof HTMLElement};var k=function boundingBox(e){return c(e)&&h(e.x1)&&h(e.x2)&&h(e.y1)&&h(e.y2)};var P=function promise(e){return d(e)&&u(e.then)};var _=function ms(){return t&&t.userAgent.match(/msie|trident|edge/i)};var D=function memoize(e,t){t||(t=function keyFn(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";var e=[];for(var t=0;t<arguments.length;t++)e.push(arguments[t]);return e.join("$")});var a=function memoizedFn(){var n=this;var i=arguments;var o;var s=t.apply(n,i);var l=a.cache;(o=l[s])||(o=l[s]=e.apply(n,i));return o};a.cache={};return a};var I=D((function(e){return e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}));var M=D((function(e){return e.replace(/(-\w)/g,(function(e){return e[1].toUpperCase()}))}));var R=D((function(e,t){return e+t[0].toUpperCase()+t.substring(1)}),(function(e,t){return e+"$"+t}));var L=function capitalize(e){return T(e)?e:e.charAt(0).toUpperCase()+e.substring(1)};var N="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))";var O="rgb[a]?\\(("+N+"[%]?)\\s*,\\s*("+N+"[%]?)\\s*,\\s*("+N+"[%]?)(?:\\s*,\\s*("+N+"))?\\)";var z="rgb[a]?\\((?:"+N+"[%]?)\\s*,\\s*(?:"+N+"[%]?)\\s*,\\s*(?:"+N+"[%]?)(?:\\s*,\\s*(?:"+N+"))?\\)";var V="hsl[a]?\\(("+N+")\\s*,\\s*("+N+"[%])\\s*,\\s*("+N+"[%])(?:\\s*,\\s*("+N+"))?\\)";var q="hsl[a]?\\((?:"+N+")\\s*,\\s*(?:"+N+"[%])\\s*,\\s*(?:"+N+"[%])(?:\\s*,\\s*(?:"+N+"))?\\)";var j="\\#[0-9a-fA-F]{3}";var H="\\#[0-9a-fA-F]{6}";var W=function ascending(e,t){return e<t?-1:e>t?1:0};var X=function descending(e,t){return-1*W(e,t)};var Y=Object.assign!=null?Object.assign.bind(Object):function(e){var t=arguments;for(var a=1;a<t.length;a++){var n=t[a];if(n!=null){var i=Object.keys(n);for(var o=0;o<i.length;o++){var s=i[o];e[s]=n[s]}}}return e};var G=function hex2tuple(e){if((e.length===4||e.length===7)&&e[0]==="#"){var t=e.length===4;var a,n,i;var o=16;if(t){a=parseInt(e[1]+e[1],o);n=parseInt(e[2]+e[2],o);i=parseInt(e[3]+e[3],o)}else{a=parseInt(e[1]+e[2],o);n=parseInt(e[3]+e[4],o);i=parseInt(e[5]+e[6],o)}return[a,n,i]}};var K=function hsl2tuple(e){var t;var a,n,i,o,s,l,u;function hue2rgb(e,t,a){a<0&&(a+=1);a>1&&(a-=1);return a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}var v=new RegExp("^"+V+"$").exec(e);if(v){a=parseInt(v[1]);a<0?a=(360- -1*a%360)%360:a>360&&(a%=360);a/=360;n=parseFloat(v[2]);if(n<0||n>100)return;n/=100;i=parseFloat(v[3]);if(i<0||i>100)return;i/=100;o=v[4];if(o!==void 0){o=parseFloat(o);if(o<0||o>1)return}if(n===0)s=l=u=Math.round(i*255);else{var c=i<.5?i*(1+n):i+n-i*n;var d=2*i-c;s=Math.round(255*hue2rgb(d,c,a+1/3));l=Math.round(255*hue2rgb(d,c,a));u=Math.round(255*hue2rgb(d,c,a-1/3))}t=[s,l,u,o]}return t};var U=function rgb2tuple(e){var t;var a=new RegExp("^"+O+"$").exec(e);if(a){t=[];var n=[];for(var i=1;i<=3;i++){var o=a[i];o[o.length-1]==="%"&&(n[i]=true);o=parseFloat(o);n[i]&&(o=o/100*255);if(o<0||o>255)return;t.push(Math.floor(o))}var s=n[1]||n[2]||n[3];var l=n[1]&&n[2]&&n[3];if(s&&!l)return;var u=a[4];if(u!==void 0){u=parseFloat(u);if(u<0||u>1)return;t.push(u)}}return t};var Z=function colorname2tuple(e){return J[e.toLowerCase()]};var Q=function color2tuple(e){return(v(e)?e:null)||Z(e)||G(e)||U(e)||K(e)};var J={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var ee=function setMap(e){var t=e.map;var a=e.keys;var n=a.length;for(var i=0;i<n;i++){var o=a[i];if(c(o))throw Error("Tried to set map with object key");if(i<a.length-1){t[o]==null&&(t[o]={});t=t[o]}else t[o]=e.value}};var te=function getMap(e){var t=e.map;var a=e.keys;var n=a.length;for(var i=0;i<n;i++){var o=a[i];if(c(o))throw Error("Tried to get map with object key");t=t[o];if(t==null)return t}return t};var re=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}
/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */var ae;var ne;function requireIsObject(){if(ne)return ae;ne=1;function isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}ae=isObject;return ae}var ie;var oe;function require_freeGlobal(){if(oe)return ie;oe=1;var e=typeof re=="object"&&re&&re.Object===Object&&re;ie=e;return ie}var se;var le;function require_root(){if(le)return se;le=1;var e=require_freeGlobal();var t=typeof self=="object"&&self&&self.Object===Object&&self;var a=e||t||Function("return this")();se=a;return se}var ue;var ve;function requireNow(){if(ve)return ue;ve=1;var e=require_root();
/**
	 * Gets the timestamp of the number of milliseconds that have elapsed since
	 * the Unix epoch (1 January 1970 00:00:00 UTC).
	 *
	 * @static
	 * @memberOf _
	 * @since 2.4.0
	 * @category Date
	 * @returns {number} Returns the timestamp.
	 * @example
	 *
	 * _.defer(function(stamp) {
	 *   console.log(_.now() - stamp);
	 * }, _.now());
	 * // => Logs the number of milliseconds it took for the deferred invocation.
	 */var now=function(){return e.Date.now()};ue=now;return ue}var ce;var de;function require_trimmedEndIndex(){if(de)return ce;de=1;var e=/\s/;
/**
	 * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace
	 * character of `string`.
	 *
	 * @private
	 * @param {string} string The string to inspect.
	 * @returns {number} Returns the index of the last non-whitespace character.
	 */function trimmedEndIndex(t){var a=t.length;while(a--&&e.test(t.charAt(a)));return a}ce=trimmedEndIndex;return ce}var he;var fe;function require_baseTrim(){if(fe)return he;fe=1;var e=require_trimmedEndIndex();var t=/^\s+/;
/**
	 * The base implementation of `_.trim`.
	 *
	 * @private
	 * @param {string} string The string to trim.
	 * @returns {string} Returns the trimmed string.
	 */function baseTrim(a){return a?a.slice(0,e(a)+1).replace(t,""):a}he=baseTrim;return he}var pe;var ge;function require_Symbol(){if(ge)return pe;ge=1;var e=require_root();var t=e.Symbol;pe=t;return pe}var ye;var me;function require_getRawTag(){if(me)return ye;me=1;var e=require_Symbol();var t=Object.prototype;var a=t.hasOwnProperty;var n=t.toString;var i=e?e.toStringTag:void 0;
/**
	 * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
	 *
	 * @private
	 * @param {*} value The value to query.
	 * @returns {string} Returns the raw `toStringTag`.
	 */function getRawTag(e){var t=a.call(e,i),o=e[i];try{e[i]=void 0;var s=true}catch(e){}var l=n.call(e);s&&(t?e[i]=o:delete e[i]);return l}ye=getRawTag;return ye}var be;var xe;function require_objectToString(){if(xe)return be;xe=1;var e=Object.prototype;var t=e.toString;
/**
	 * Converts `value` to a string using `Object.prototype.toString`.
	 *
	 * @private
	 * @param {*} value The value to convert.
	 * @returns {string} Returns the converted string.
	 */function objectToString(e){return t.call(e)}be=objectToString;return be}var we;var Ee;function require_baseGetTag(){if(Ee)return we;Ee=1;var e=require_Symbol(),t=require_getRawTag(),a=require_objectToString();var n="[object Null]",i="[object Undefined]";var o=e?e.toStringTag:void 0;
/**
	 * The base implementation of `getTag` without fallbacks for buggy environments.
	 *
	 * @private
	 * @param {*} value The value to query.
	 * @returns {string} Returns the `toStringTag`.
	 */function baseGetTag(e){return e==null?e===void 0?i:n:o&&o in Object(e)?t(e):a(e)}we=baseGetTag;return we}
/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */var Ce;var Te;function requireIsObjectLike(){if(Te)return Ce;Te=1;function isObjectLike(e){return e!=null&&typeof e=="object"}Ce=isObjectLike;return Ce}var Se;var ke;function requireIsSymbol(){if(ke)return Se;ke=1;var e=require_baseGetTag(),t=requireIsObjectLike();var a="[object Symbol]";
/**
	 * Checks if `value` is classified as a `Symbol` primitive or object.
	 *
	 * @static
	 * @memberOf _
	 * @since 4.0.0
	 * @category Lang
	 * @param {*} value The value to check.
	 * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.
	 * @example
	 *
	 * _.isSymbol(Symbol.iterator);
	 * // => true
	 *
	 * _.isSymbol('abc');
	 * // => false
	 */function isSymbol(n){return typeof n=="symbol"||t(n)&&e(n)==a}Se=isSymbol;return Se}var Pe;var _e;function requireToNumber(){if(_e)return Pe;_e=1;var e=require_baseTrim(),t=requireIsObject(),a=requireIsSymbol();var n=NaN;var i=/^[-+]0x[0-9a-f]+$/i;var o=/^0b[01]+$/i;var s=/^0o[0-7]+$/i;var l=parseInt;
/**
	 * Converts `value` to a number.
	 *
	 * @static
	 * @memberOf _
	 * @since 4.0.0
	 * @category Lang
	 * @param {*} value The value to process.
	 * @returns {number} Returns the number.
	 * @example
	 *
	 * _.toNumber(3.2);
	 * // => 3.2
	 *
	 * _.toNumber(Number.MIN_VALUE);
	 * // => 5e-324
	 *
	 * _.toNumber(Infinity);
	 * // => Infinity
	 *
	 * _.toNumber('3.2');
	 * // => 3.2
	 */function toNumber(u){if(typeof u=="number")return u;if(a(u))return n;if(t(u)){var v=typeof u.valueOf=="function"?u.valueOf():u;u=t(v)?v+"":v}if(typeof u!="string")return u===0?u:+u;u=e(u);var c=o.test(u);return c||s.test(u)?l(u.slice(2),c?2:8):i.test(u)?n:+u}Pe=toNumber;return Pe}var De;var Ae;function requireDebounce(){if(Ae)return De;Ae=1;var e=requireIsObject(),t=requireNow(),a=requireToNumber();var n="Expected a function";var i=Math.max,o=Math.min;
/**
	 * Creates a debounced function that delays invoking `func` until after `wait`
	 * milliseconds have elapsed since the last time the debounced function was
	 * invoked. The debounced function comes with a `cancel` method to cancel
	 * delayed `func` invocations and a `flush` method to immediately invoke them.
	 * Provide `options` to indicate whether `func` should be invoked on the
	 * leading and/or trailing edge of the `wait` timeout. The `func` is invoked
	 * with the last arguments provided to the debounced function. Subsequent
	 * calls to the debounced function return the result of the last `func`
	 * invocation.
	 *
	 * **Note:** If `leading` and `trailing` options are `true`, `func` is
	 * invoked on the trailing edge of the timeout only if the debounced function
	 * is invoked more than once during the `wait` timeout.
	 *
	 * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
	 * until to the next tick, similar to `setTimeout` with a timeout of `0`.
	 *
	 * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
	 * for details over the differences between `_.debounce` and `_.throttle`.
	 *
	 * @static
	 * @memberOf _
	 * @since 0.1.0
	 * @category Function
	 * @param {Function} func The function to debounce.
	 * @param {number} [wait=0] The number of milliseconds to delay.
	 * @param {Object} [options={}] The options object.
	 * @param {boolean} [options.leading=false]
	 *  Specify invoking on the leading edge of the timeout.
	 * @param {number} [options.maxWait]
	 *  The maximum time `func` is allowed to be delayed before it's invoked.
	 * @param {boolean} [options.trailing=true]
	 *  Specify invoking on the trailing edge of the timeout.
	 * @returns {Function} Returns the new debounced function.
	 * @example
	 *
	 * // Avoid costly calculations while the window size is in flux.
	 * jQuery(window).on('resize', _.debounce(calculateLayout, 150));
	 *
	 * // Invoke `sendMail` when clicked, debouncing subsequent calls.
	 * jQuery(element).on('click', _.debounce(sendMail, 300, {
	 *   'leading': true,
	 *   'trailing': false
	 * }));
	 *
	 * // Ensure `batchLog` is invoked once after 1 second of debounced calls.
	 * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });
	 * var source = new EventSource('/stream');
	 * jQuery(source).on('message', debounced);
	 *
	 * // Cancel the trailing debounced invocation.
	 * jQuery(window).on('popstate', debounced.cancel);
	 */function debounce(s,l,u){var v,c,d,h,p,g,y=0,m=false,b=false,x=true;if(typeof s!="function")throw new TypeError(n);l=a(l)||0;if(e(u)){m=!!u.leading;b="maxWait"in u;d=b?i(a(u.maxWait)||0,l):d;x="trailing"in u?!!u.trailing:x}function invokeFunc(e){var t=v,a=c;v=c=void 0;y=e;h=s.apply(a,t);return h}function leadingEdge(e){y=e;p=setTimeout(timerExpired,l);return m?invokeFunc(e):h}function remainingWait(e){var t=e-g,a=e-y,n=l-t;return b?o(n,d-a):n}function shouldInvoke(e){var t=e-g,a=e-y;return g===void 0||t>=l||t<0||b&&a>=d}function timerExpired(){var e=t();if(shouldInvoke(e))return trailingEdge(e);p=setTimeout(timerExpired,remainingWait(e))}function trailingEdge(e){p=void 0;if(x&&v)return invokeFunc(e);v=c=void 0;return h}function cancel(){p!==void 0&&clearTimeout(p);y=0;v=g=c=p=void 0}function flush(){return p===void 0?h:trailingEdge(t())}function debounced(){var e=t(),a=shouldInvoke(e);v=arguments;c=this;g=e;if(a){if(p===void 0)return leadingEdge(g);if(b){clearTimeout(p);p=setTimeout(timerExpired,l);return invokeFunc(g)}}p===void 0&&(p=setTimeout(timerExpired,l));return h}debounced.cancel=cancel;debounced.flush=flush;return debounced}De=debounce;return De}var Be=requireDebounce();var Ie=getDefaultExportFromCjs(Be);var Me=e?e.performance:null;var Re=Me&&Me.now?function(){return Me.now()}:function(){return Date.now()};var Le=function(){if(e){if(e.requestAnimationFrame)return function(t){e.requestAnimationFrame(t)};if(e.mozRequestAnimationFrame)return function(t){e.mozRequestAnimationFrame(t)};if(e.webkitRequestAnimationFrame)return function(t){e.webkitRequestAnimationFrame(t)};if(e.msRequestAnimationFrame)return function(t){e.msRequestAnimationFrame(t)}}return function(e){e&&setTimeout((function(){e(Re())}),1e3/60)}}();var Ne=function requestAnimationFrame(e){return Le(e)};var Oe=Re;var Fe=9261;var ze=65599;var Ve=5381;var qe=function hashIterableInts(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fe;var a=t;var n;for(;;){n=e.next();if(n.done)break;a=a*ze+n.value|0}return a};var je=function hashInt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fe;return t*ze+e|0};var He=function hashIntAlt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ve;return(t<<5)+t+e|0};var We=function combineHashes(e,t){return e*2097152+t};var Xe=function combineHashesArray(e){return e[0]*2097152+e[1]};var Ye=function hashArrays(e,t){return[je(e[0],t[0]),He(e[1],t[1])]};var Ge=function hashIntsArray(e,t){var a={value:0,done:false};var n=0;var i=e.length;var o={next:function next(){n<i?a.value=e[n++]:a.done=true;return a}};return qe(o,t)};var Ke=function hashString(e,t){var a={value:0,done:false};var n=0;var i=e.length;var o={next:function next(){n<i?a.value=e.charCodeAt(n++):a.done=true;return a}};return qe(o,t)};var Ue=function hashStrings(){return Ze(arguments)};var Ze=function hashStringsArray(e){var t;for(var a=0;a<e.length;a++){var n=e[a];t=a===0?Ke(n):Ke(n,t)}return t};var $e=true;var Qe=console.warn!=null;var Je=console.trace!=null;var et=Number.MAX_SAFE_INTEGER||9007199254740991;var tt=function trueify(){return true};var rt=function falsify(){return false};var at=function zeroify(){return 0};var nt=function noop(){};var it=function error(e){throw new Error(e)};var ot=function warnings(e){if(e===void 0)return $e;$e=!!e};var st=function warn(e){if(ot())if(Qe)console.warn(e);else{console.log(e);Je&&console.trace()}};var lt=function clone(e){return Y({},e)};var ut=function copy(e){return e==null?e:v(e)?e.slice():c(e)?lt(e):e};var vt=function copyArray(e){return e.slice()};var ct=function uuid(e,t){for(t=e="";e++<36;t+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return t};var dt={};var ht=function staticEmptyObject(){return dt};var ft=function defaults(e){var t=Object.keys(e);return function(a){var n={};for(var i=0;i<t.length;i++){var o=t[i];var s=a==null?void 0:a[o];n[o]=s===void 0?e[o]:s}return n}};var pt=function removeFromArray(e,t,a){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)};var gt=function clearArray(e){e.splice(0,e.length)};var yt=function push(e,t){for(var a=0;a<t.length;a++){var n=t[a];e.push(n)}};var mt=function getPrefixedProperty(e,t,a){a&&(t=R(a,t));return e[t]};var bt=function setPrefixedProperty(e,t,a,n){a&&(t=R(a,t));e[t]=n};var xt=function(){function ObjectMap(){_classCallCheck(this,ObjectMap);this._obj={}}return _createClass(ObjectMap,[{key:"set",value:function set(e,t){this._obj[e]=t;return this}},{key:"delete",value:function _delete(e){this._obj[e]=void 0;return this}},{key:"clear",value:function clear(){this._obj={}}},{key:"has",value:function has(e){return this._obj[e]!==void 0}},{key:"get",value:function get(e){return this._obj[e]}}])}();var wt=typeof Map!=="undefined"?Map:xt;var Et="undefined";var Ct=function(){function ObjectSet(e){_classCallCheck(this,ObjectSet);this._obj=Object.create(null);this.size=0;if(e!=null){var t;t=e.instanceString!=null&&e.instanceString()===this.instanceString()?e.toArray():e;for(var a=0;a<t.length;a++)this.add(t[a])}}return _createClass(ObjectSet,[{key:"instanceString",value:function instanceString(){return"set"}},{key:"add",value:function add(e){var t=this._obj;if(t[e]!==1){t[e]=1;this.size++}}},{key:"delete",value:function _delete(e){var t=this._obj;if(t[e]===1){t[e]=0;this.size--}}},{key:"clear",value:function clear(){this._obj=Object.create(null)}},{key:"has",value:function has(e){return this._obj[e]===1}},{key:"toArray",value:function toArray(){var e=this;return Object.keys(this._obj).filter((function(t){return e.has(t)}))}},{key:"forEach",value:function forEach(e,t){return this.toArray().forEach(e,t)}}])}();var Tt=(typeof Set==="undefined"?"undefined":_typeof(Set))!==Et?Set:Ct;var St=function Element(e,t){var a=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e!==void 0&&t!==void 0&&x(e)){var n=t.group;n==null&&(n=t.data&&t.data.source!=null&&t.data.target!=null?"edges":"nodes");if(n==="nodes"||n==="edges"){this.length=1;this[0]=this;var i=this._private={cy:e,single:true,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:false,listeners:[],group:n,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:true,selected:!!t.selected,selectable:t.selectable===void 0||!!t.selectable,locked:!!t.locked,grabbed:false,grabbable:t.grabbable===void 0||!!t.grabbable,pannable:t.pannable===void 0?n==="edges":!!t.pannable,active:false,classes:new Tt,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:t.parent&&t.parent.isNode()?t.parent:null,traversalCache:{},backgrounding:false,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};i.position.x==null&&(i.position.x=0);i.position.y==null&&(i.position.y=0);if(t.renderedPosition){var o=t.renderedPosition;var s=e.pan();var u=e.zoom();i.position={x:(o.x-s.x)/u,y:(o.y-s.y)/u}}var c=[];v(t.classes)?c=t.classes:l(t.classes)&&(c=t.classes.split(/\s+/));for(var d=0,h=c.length;d<h;d++){var p=c[d];p&&p!==""&&i.classes.add(p)}this.createEmitter();(a===void 0||a)&&this.restore();var g=t.style||t.css;if(g){st("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead.");this.style(g)}}else it("An element must be of type `nodes` or `edges`; you specified `"+n+"`")}else it("An element must have a core reference and parameters set")};var kt=function defineSearch(e){e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs};return function searchFn(t,a,n){var i;if(c(t)&&!y(t)){i=t;t=i.roots||i.root;a=i.visit;n=i.directed}n=arguments.length!==2||u(a)?n:a;a=u(a)?a:function(){};var o=this._private.cy;var s=t=l(t)?this.filter(t):t;var v=[];var d=[];var h={};var p={};var g={};var m=0;var b;var x=this.byGroup(),w=x.nodes,E=x.edges;for(var T=0;T<s.length;T++){var S=s[T];var k=S.id();if(S.isNode()){v.unshift(S);if(e.bfs){g[k]=true;d.push(S)}p[k]=0}}var P,_=function _loop(){var t=e.bfs?v.shift():v.pop();var i=t.id();if(e.dfs){if(g[i])return 0;g[i]=true;d.push(t)}var o=p[i];var s=h[i];var l=s!=null?s.source():null;var u=s!=null?s.target():null;var c=s==null?void 0:t.same(l)?u[0]:l[0];var y;y=a(t,s,c,m++,o);if(y===true){b=t;return 1}if(y===false)return 1;var x=t.connectedEdges().filter((function(e){return(!n||e.source().same(t))&&E.has(e)}));for(var T=0;T<x.length;T++){var S=x[T];var k=S.connectedNodes().filter((function(e){return!e.same(t)&&w.has(e)}));var P=k.id();if(k.length!==0&&!g[P]){k=k[0];v.push(k);if(e.bfs){g[P]=true;d.push(k)}h[P]=S;p[P]=p[i]+1}}};while(v.length!==0){P=_();if(P!==0&&P===1)break}var D=o.collection();for(var I=0;I<d.length;I++){var M=d[I];var R=h[M.id()];R!=null&&D.push(R);D.push(M)}return{path:o.collection(D),found:o.collection(b)}}};var Pt={breadthFirstSearch:kt({bfs:true}),depthFirstSearch:kt({dfs:true})};Pt.bfs=Pt.breadthFirstSearch;Pt.dfs=Pt.depthFirstSearch;var _t={exports:{}};var Dt=_t.exports;var At;function requireHeap$1(){if(At)return _t.exports;At=1;(function(e){(function(){var t,a,n,i,o,s,l,u,v,c,d,h,p,g,y;n=Math.floor,c=Math.min;a=function(e,t){return e<t?-1:e>t?1:0};v=function(e,t,i,o,s){var l;i==null&&(i=0);s==null&&(s=a);if(i<0)throw new Error("lo must be non-negative");o==null&&(o=e.length);while(i<o){l=n((i+o)/2);s(t,e[l])<0?o=l:i=l+1}return[].splice.apply(e,[i,i-i].concat(t)),t};s=function(e,t,n){n==null&&(n=a);e.push(t);return g(e,0,e.length-1,n)};o=function(e,t){var n,i;t==null&&(t=a);n=e.pop();if(e.length){i=e[0];e[0]=n;y(e,0,t)}else i=n;return i};u=function(e,t,n){var i;n==null&&(n=a);i=e[0];e[0]=t;y(e,0,n);return i};l=function(e,t,n){var i;n==null&&(n=a);if(e.length&&n(e[0],t)<0){i=[e[0],t],t=i[0],e[0]=i[1];y(e,0,n)}return t};i=function(e,t){var i,o,s,l,u,v;t==null&&(t=a);l=function(){v=[];for(var t=0,a=n(e.length/2);0<=a?t<a:t>a;0<=a?t++:t--)v.push(t);return v}.apply(this).reverse();u=[];for(o=0,s=l.length;o<s;o++){i=l[o];u.push(y(e,i,t))}return u};p=function(e,t,n){var i;n==null&&(n=a);i=e.indexOf(t);if(i!==-1){g(e,0,i,n);return y(e,i,n)}};d=function(e,t,n){var o,s,u,v,c;n==null&&(n=a);s=e.slice(0,t);if(!s.length)return s;i(s,n);c=e.slice(t);for(u=0,v=c.length;u<v;u++){o=c[u];l(s,o,n)}return s.sort(n).reverse()};h=function(e,t,n){var s,l,u,d,h,p,g,y,m;n==null&&(n=a);if(t*10<=e.length){u=e.slice(0,t).sort(n);if(!u.length)return u;l=u[u.length-1];g=e.slice(t);for(d=0,p=g.length;d<p;d++){s=g[d];if(n(s,l)<0){v(u,s,0,null,n);u.pop();l=u[u.length-1]}}return u}i(e,n);m=[];for(h=0,y=c(t,e.length);0<=y?h<y:h>y;0<=y?++h:--h)m.push(o(e,n));return m};g=function(e,t,n,i){var o,s,l;i==null&&(i=a);o=e[n];while(n>t){l=n-1>>1;s=e[l];if(!(i(o,s)<0))break;e[n]=s;n=l}return e[n]=o};y=function(e,t,n){var i,o,s,l,u;n==null&&(n=a);o=e.length;u=t;s=e[t];i=2*t+1;while(i<o){l=i+1;l<o&&!(n(e[i],e[l])<0)&&(i=l);e[t]=e[i];t=i;i=2*t+1}e[t]=s;return g(e,u,t,n)};t=function(){Heap.push=s;Heap.pop=o;Heap.replace=u;Heap.pushpop=l;Heap.heapify=i;Heap.updateItem=p;Heap.nlargest=d;Heap.nsmallest=h;function Heap(e){this.cmp=e!=null?e:a;this.nodes=[]}Heap.prototype.push=function(e){return s(this.nodes,e,this.cmp)};Heap.prototype.pop=function(){return o(this.nodes,this.cmp)};Heap.prototype.peek=function(){return this.nodes[0]};Heap.prototype.contains=function(e){return this.nodes.indexOf(e)!==-1};Heap.prototype.replace=function(e){return u(this.nodes,e,this.cmp)};Heap.prototype.pushpop=function(e){return l(this.nodes,e,this.cmp)};Heap.prototype.heapify=function(){return i(this.nodes,this.cmp)};Heap.prototype.updateItem=function(e){return p(this.nodes,e,this.cmp)};Heap.prototype.clear=function(){return this.nodes=[]};Heap.prototype.empty=function(){return this.nodes.length===0};Heap.prototype.size=function(){return this.nodes.length};Heap.prototype.clone=function(){var e;e=new Heap;e.nodes=this.nodes.slice(0);return e};Heap.prototype.toArray=function(){return this.nodes.slice(0)};Heap.prototype.insert=Heap.prototype.push;Heap.prototype.top=Heap.prototype.peek;Heap.prototype.front=Heap.prototype.peek;Heap.prototype.has=Heap.prototype.contains;Heap.prototype.copy=Heap.prototype.clone;return Heap}();(function(t,a){return e.exports=a()})(0,(function(){return t}))}).call(Dt)})(_t);return _t.exports}var Bt;var It;function requireHeap(){if(It)return Bt;It=1;Bt=requireHeap$1();return Bt}var Mt=requireHeap();var Rt=getDefaultExportFromCjs(Mt);var Lt=ft({root:null,weight:function weight(e){return 1},directed:false});var Nt={dijkstra:function dijkstra(e){if(!c(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var a=Lt(e),n=a.root,i=a.weight,o=a.directed;var s=this;var u=i;var v=l(n)?this.filter(n)[0]:n[0];var d={};var h={};var p={};var g=this.byGroup(),y=g.nodes,m=g.edges;m.unmergeBy((function(e){return e.isLoop()}));var b=function getDist(e){return d[e.id()]};var x=function setDist(e,t){d[e.id()]=t;w.updateItem(e)};var w=new Rt((function(e,t){return b(e)-b(t)}));for(var E=0;E<y.length;E++){var T=y[E];d[T.id()]=T.same(v)?0:Infinity;w.push(T)}var S=function distBetween(e,t){var a=(o?e.edgesTo(t):e.edgesWith(t)).intersect(m);var n=Infinity;var i;for(var s=0;s<a.length;s++){var l=a[s];var v=u(l);if(v<n||!i){n=v;i=l}}return{edge:i,dist:n}};while(w.size()>0){var k=w.pop();var P=b(k);var _=k.id();p[_]=P;if(P!==Infinity){var D=k.neighborhood().intersect(y);for(var I=0;I<D.length;I++){var M=D[I];var R=M.id();var L=S(k,M);var N=P+L.dist;if(N<b(M)){x(M,N);h[R]={node:k,edge:L.edge}}}}}return{distanceTo:function distanceTo(e){var t=l(e)?y.filter(e)[0]:e[0];return p[t.id()]},pathTo:function pathTo(e){var t=l(e)?y.filter(e)[0]:e[0];var a=[];var n=t;var i=n.id();if(t.length>0){a.unshift(t);while(h[i]){var o=h[i];a.unshift(o.edge);a.unshift(o.node);n=o.node;i=n.id()}}return s.spawn(a)}}}};var Ot={kruskal:function kruskal(e){e=e||function(e){return 1};var t=this.byGroup(),a=t.nodes,n=t.edges;var i=a.length;var o=new Array(i);var s=a;var l=function findSetIndex(e){for(var t=0;t<o.length;t++){var a=o[t];if(a.has(e))return t}};for(var u=0;u<i;u++)o[u]=this.spawn(a[u]);var v=n.sort((function(t,a){return e(t)-e(a)}));for(var c=0;c<v.length;c++){var d=v[c];var h=d.source()[0];var p=d.target()[0];var g=l(h);var y=l(p);var m=o[g];var b=o[y];if(g!==y){s.merge(d);m.merge(b);o.splice(y,1)}}return s}};var Ft=ft({root:null,goal:null,weight:function weight(e){return 1},heuristic:function heuristic(e){return 0},directed:false});var zt={aStar:function aStar(e){var t=this.cy();var a=Ft(e),n=a.root,i=a.goal,o=a.heuristic,s=a.directed,l=a.weight;n=t.collection(n)[0];i=t.collection(i)[0];var u=n.id();var v=i.id();var c={};var d={};var h={};var p=new Rt((function(e,t){return d[e.id()]-d[t.id()]}));var g=new Tt;var y={};var m={};var b=function addToOpenSet(e,t){p.push(e);g.add(t)};var x,w;var E=function popFromOpenSet(){x=p.pop();w=x.id();g.delete(w)};var T=function isInOpenSet(e){return g.has(e)};b(n,u);c[u]=0;d[u]=o(n);var S=0;while(p.size()>0){E();S++;if(w===v){var k=[];var P=i;var _=v;var D=m[_];for(;;){k.unshift(P);D!=null&&k.unshift(D);P=y[_];if(P==null)break;_=P.id();D=m[_]}return{found:true,distance:c[w],path:this.spawn(k),steps:S}}h[w]=true;var I=x._private.edges;for(var M=0;M<I.length;M++){var R=I[M];if(this.hasElementWithId(R.id())&&(!s||R.data("source")===w)){var L=R.source();var N=R.target();var O=L.id()!==w?L:N;var z=O.id();if(this.hasElementWithId(z)&&!h[z]){var V=c[w]+l(R);if(T(z)){if(V<c[z]){c[z]=V;d[z]=V+o(O);y[z]=x;m[z]=R}}else{c[z]=V;d[z]=V+o(O);b(O,z);y[z]=x;m[z]=R}}}}}return{found:false,distance:void 0,path:void 0,steps:S}}};var Vt=ft({weight:function weight(e){return 1},directed:false});var qt={floydWarshall:function floydWarshall(e){var t=this.cy();var a=Vt(e),n=a.weight,i=a.directed;var o=n;var s=this.byGroup(),u=s.nodes,v=s.edges;var c=u.length;var d=c*c;var h=function indexOf(e){return u.indexOf(e)};var p=function atIndex(e){return u[e]};var g=new Array(d);for(var y=0;y<d;y++){var m=y%c;var b=(y-m)/c;g[y]=b===m?0:Infinity}var x=new Array(d);var w=new Array(d);for(var E=0;E<v.length;E++){var T=v[E];var S=T.source()[0];var k=T.target()[0];if(S!==k){var P=h(S);var _=h(k);var D=P*c+_;var I=o(T);if(g[D]>I){g[D]=I;x[D]=_;w[D]=T}if(!i){var M=_*c+P;if(!i&&g[M]>I){g[M]=I;x[M]=P;w[M]=T}}}}for(var R=0;R<c;R++)for(var L=0;L<c;L++){var N=L*c+R;for(var O=0;O<c;O++){var z=L*c+O;var V=R*c+O;if(g[N]+g[V]<g[z]){g[z]=g[N]+g[V];x[z]=x[N]}}}var q=function getArgEle(e){return(l(e)?t.filter(e):e)[0]};var j=function indexOfArgEle(e){return h(q(e))};var H={distance:function distance(e,t){var a=j(e);var n=j(t);return g[a*c+n]},path:function path(e,a){var n=j(e);var i=j(a);var o=p(n);if(n===i)return o.collection();if(x[n*c+i]==null)return t.collection();var path=t.collection();var s=n;var l;path.merge(o);while(n!==i){s=n;n=x[n*c+i];l=w[s*c+n];path.merge(l);path.merge(p(n))}return path}};return H}};var jt=ft({weight:function weight(e){return 1},directed:false,root:null});var Ht={bellmanFord:function bellmanFord(e){var t=this;var a=jt(e),n=a.weight,i=a.directed,o=a.root;var s=n;var u=this;var v=this.cy();var c=this.byGroup(),d=c.edges,h=c.nodes;var p=h.length;var g=new wt;var y=false;var m=[];o=v.collection(o)[0];d.unmergeBy((function(e){return e.isLoop()}));var b=d.length;var x=function getInfo(e){var t=g.get(e.id());if(!t){t={};g.set(e.id(),t)}return t};var w=function getNodeFromTo(e){return(l(e)?v.$(e):e)[0]};var E=function distanceTo(e){return x(w(e)).dist};var T=function pathTo(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;var n=w(e);var i=[];var s=n;for(;;){if(s==null)return t.spawn();var l=x(s),v=l.edge,c=l.pred;i.unshift(s[0]);if(s.same(a)&&i.length>0)break;v!=null&&i.unshift(v);s=c}return u.spawn(i)};for(var S=0;S<p;S++){var k=h[S];var P=x(k);k.same(o)?P.dist=0:P.dist=Infinity;P.pred=null;P.edge=null}var _=false;var D=function checkForEdgeReplacement(e,t,a,n,i,o){var s=n.dist+o;if(s<i.dist&&!a.same(n.edge)){i.dist=s;i.pred=e;i.edge=a;_=true}};for(var I=1;I<p;I++){_=false;for(var M=0;M<b;M++){var R=d[M];var L=R.source();var N=R.target();var O=s(R);var z=x(L);var V=x(N);D(L,N,R,z,V,O);i||D(N,L,R,V,z,O)}if(!_)break}if(_){var q=[];for(var j=0;j<b;j++){var H=d[j];var W=H.source();var X=H.target();var Y=s(H);var G=x(W).dist;var K=x(X).dist;if(G+Y<K||!i&&K+Y<G){if(!y){st("Graph contains a negative weight cycle for Bellman-Ford");y=true}if(e.findNegativeWeightCycles===false)break;var U=[];G+Y<K&&U.push(W);!i&&K+Y<G&&U.push(X);var Z=U.length;for(var Q=0;Q<Z;Q++){var J=U[Q];var ee=[J];ee.push(x(J).edge);var te=x(J).pred;while(ee.indexOf(te)===-1){ee.push(te);ee.push(x(te).edge);te=x(te).pred}ee=ee.slice(ee.indexOf(te));var re=ee[0].id();var ae=0;for(var ne=2;ne<ee.length;ne+=2)if(ee[ne].id()<re){re=ee[ne].id();ae=ne}ee=ee.slice(ae).concat(ee.slice(0,ae));ee.push(ee[0]);var ie=ee.map((function(e){return e.id()})).join(",");if(q.indexOf(ie)===-1){m.push(u.spawn(ee));q.push(ie)}}}}}return{distanceTo:E,pathTo:T,hasNegativeWeightCycle:y,negativeWeightCycles:m}}};var Wt=Math.sqrt(2);var Xt=function collapse(e,t,a){a.length===0&&it("Karger-Stein must be run on a connected (sub)graph");var n=a[e];var i=n[1];var o=n[2];var s=t[i];var l=t[o];var u=a;for(var v=u.length-1;v>=0;v--){var c=u[v];var d=c[1];var h=c[2];(t[d]===s&&t[h]===l||t[d]===l&&t[h]===s)&&u.splice(v,1)}for(var p=0;p<u.length;p++){var g=u[p];if(g[1]===l){u[p]=g.slice();u[p][1]=s}else if(g[2]===l){u[p]=g.slice();u[p][2]=s}}for(var y=0;y<t.length;y++)t[y]===l&&(t[y]=s);return u};var Yt=function contractUntil(e,t,a,n){while(a>n){var i=Math.floor(Math.random()*t.length);t=Xt(i,e,t);a--}return t};var Gt={kargerStein:function kargerStein(){var e=this;var t=this.byGroup(),a=t.nodes,n=t.edges;n.unmergeBy((function(e){return e.isLoop()}));var i=a.length;var o=n.length;var s=Math.ceil(Math.pow(Math.log(i)/Math.LN2,2));var l=Math.floor(i/Wt);if(!(i<2)){var u=[];for(var v=0;v<o;v++){var c=n[v];u.push([v,a.indexOf(c.source()),a.indexOf(c.target())])}var d=Infinity;var h=[];var p=new Array(i);var g=new Array(i);var y=new Array(i);var m=function copyNodesMap(e,t){for(var a=0;a<i;a++)t[a]=e[a]};for(var b=0;b<=s;b++){for(var x=0;x<i;x++)g[x]=x;var w=Yt(g,u.slice(),i,l);var E=w.slice();m(g,y);var T=Yt(g,w,l,2);var S=Yt(y,E,l,2);if(T.length<=S.length&&T.length<d){d=T.length;h=T;m(g,p)}else if(S.length<=T.length&&S.length<d){d=S.length;h=S;m(y,p)}}var k=this.spawn(h.map((function(e){return n[e[0]]})));var P=this.spawn();var _=this.spawn();var D=p[0];for(var I=0;I<p.length;I++){var M=p[I];var R=a[I];M===D?P.merge(R):_.merge(R)}var L=function constructComponent(t){var a=e.spawn();t.forEach((function(t){a.merge(t);t.connectedEdges().forEach((function(t){e.contains(t)&&!k.contains(t)&&a.merge(t)}))}));return a};var N=[L(P),L(_)];var O={cut:k,components:N,partition1:P,partition2:_};return O}it("At least 2 nodes are required for Karger-Stein algorithm")}};var Kt=function copyPosition(e){return{x:e.x,y:e.y}};var Ut=function modelToRenderedPosition(e,t,a){return{x:e.x*t+a.x,y:e.y*t+a.y}};var Zt=function renderedToModelPosition(e,t,a){return{x:(e.x-a.x)/t,y:(e.y-a.y)/t}};var $t=function array2point(e){return{x:e[0],y:e[1]}};var Qt=function min(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length;var min=Infinity;for(var n=t;n<a;n++){var i=e[n];isFinite(i)&&(min=Math.min(i,min))}return min};var Jt=function max(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length;var max=-Infinity;for(var n=t;n<a;n++){var i=e[n];isFinite(i)&&(max=Math.max(i,max))}return max};var er=function mean(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length;var n=0;var i=0;for(var o=t;o<a;o++){var s=e[o];if(isFinite(s)){n+=s;i++}}return n/i};var tr=function median(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length;var n=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];var i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];var o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];if(n)e=e.slice(t,a);else{a<e.length&&e.splice(a,e.length-a);t>0&&e.splice(0,t)}var s=0;for(var l=e.length-1;l>=0;l--){var u=e[l];if(o){if(!isFinite(u)){e[l]=-Infinity;s++}}else e.splice(l,1)}i&&e.sort((function(e,t){return e-t}));var v=e.length;var c=Math.floor(v/2);return v%2!==0?e[c+1+s]:(e[c-1+s]+e[c+s])/2};var rr=function deg2rad(e){return Math.PI*e/180};var ar=function getAngleFromDisp(e,t){return Math.atan2(t,e)-Math.PI/2};var nr=Math.log2||function(e){return Math.log(e)/Math.log(2)};var ir=function signum(e){return e>0?1:e<0?-1:0};var or=function dist(e,t){return Math.sqrt(sr(e,t))};var sr=function sqdist(e,t){var a=t.x-e.x;var n=t.y-e.y;return a*a+n*n};var lr=function inPlaceSumNormalize(e){var t=e.length;var a=0;for(var n=0;n<t;n++)a+=e[n];for(var i=0;i<t;i++)e[i]=e[i]/a;return e};var ur=function qbezierAt(e,t,a,n){return(1-n)*(1-n)*e+2*(1-n)*n*t+n*n*a};var vr=function qbezierPtAt(e,t,a,n){return{x:ur(e.x,t.x,a.x,n),y:ur(e.y,t.y,a.y,n)}};var cr=function lineAt(e,t,a,n){var i={x:t.x-e.x,y:t.y-e.y};var o=or(e,t);var s={x:i.x/o,y:i.y/o};a=a==null?0:a;n=n!=null?n:a*o;return{x:e.x+s.x*n,y:e.y+s.y*n}};var dr=function bound(e,t,a){return Math.max(e,Math.min(a,t))};var hr=function makeBoundingBox(e){if(e==null)return{x1:Infinity,y1:Infinity,x2:-Infinity,y2:-Infinity,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}};var fr=function copyBoundingBox(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}};var pr=function clearBoundingBox(e){e.x1=Infinity;e.y1=Infinity;e.x2=-Infinity;e.y2=-Infinity;e.w=0;e.h=0};var gr=function shiftBoundingBox(e,t,a){return{x1:e.x1+t,x2:e.x2+t,y1:e.y1+a,y2:e.y2+a,w:e.w,h:e.h}};var yr=function updateBoundingBox(e,t){e.x1=Math.min(e.x1,t.x1);e.x2=Math.max(e.x2,t.x2);e.w=e.x2-e.x1;e.y1=Math.min(e.y1,t.y1);e.y2=Math.max(e.y2,t.y2);e.h=e.y2-e.y1};var mr=function expandBoundingBoxByPoint(e,t,a){e.x1=Math.min(e.x1,t);e.x2=Math.max(e.x2,t);e.w=e.x2-e.x1;e.y1=Math.min(e.y1,a);e.y2=Math.max(e.y2,a);e.h=e.y2-e.y1};var br=function expandBoundingBox(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;e.x1-=t;e.x2+=t;e.y1-=t;e.y2+=t;e.w=e.x2-e.x1;e.h=e.y2-e.y1;return e};var xr=function expandBoundingBoxSides(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0];var a,n,i,o;if(t.length===1)a=n=i=o=t[0];else if(t.length===2){a=i=t[0];o=n=t[1]}else if(t.length===4){var s=_slicedToArray(t,4);a=s[0];n=s[1];i=s[2];o=s[3]}e.x1-=o;e.x2+=n;e.y1-=a;e.y2+=i;e.w=e.x2-e.x1;e.h=e.y2-e.y1;return e};var wr=function assignBoundingBox(e,t){e.x1=t.x1;e.y1=t.y1;e.x2=t.x2;e.y2=t.y2;e.w=e.x2-e.x1;e.h=e.y2-e.y1};var Er=function boundingBoxesIntersect(e,t){return!(e.x1>t.x2)&&(!(t.x1>e.x2)&&(!(e.x2<t.x1)&&(!(t.x2<e.x1)&&(!(e.y2<t.y1)&&(!(t.y2<e.y1)&&(!(e.y1>t.y2)&&!(t.y1>e.y2)))))))};var Cr=function inBoundingBox(e,t,a){return e.x1<=t&&t<=e.x2&&e.y1<=a&&a<=e.y2};var Tr=function pointInBoundingBox(e,t){return Cr(e,t.x,t.y)};var Sr=function boundingBoxInBoundingBox(e,t){return Cr(e,t.x1,t.y1)&&Cr(e,t.x2,t.y2)};var kr=function roundRectangleIntersectLine(e,t,a,n,i,o,s){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto";var u=l==="auto"?Ur(i,o):l;var v=i/2;var c=o/2;u=Math.min(u,v,c);var d=u!==v,h=u!==c;var p;if(d){var g=a-v+u-s;var y=n-c-s;var m=a+v-u+s;var b=y;p=jr(e,t,a,n,g,y,m,b,false);if(p.length>0)return p}if(h){var x=a+v+s;var w=n-c+u-s;var E=x;var T=n+c-u+s;p=jr(e,t,a,n,x,w,E,T,false);if(p.length>0)return p}if(d){var S=a-v+u-s;var k=n+c+s;var P=a+v-u+s;var _=k;p=jr(e,t,a,n,S,k,P,_,false);if(p.length>0)return p}if(h){var D=a-v-s;var I=n-c+u-s;var M=D;var R=n+c-u+s;p=jr(e,t,a,n,D,I,M,R,false);if(p.length>0)return p}var L;var N=a-v+u;var O=n-c+u;L=Vr(e,t,a,n,N,O,u+s);if(L.length>0&&L[0]<=N&&L[1]<=O)return[L[0],L[1]];var z=a+v-u;var V=n-c+u;L=Vr(e,t,a,n,z,V,u+s);if(L.length>0&&L[0]>=z&&L[1]<=V)return[L[0],L[1]];var q=a+v-u;var j=n+c-u;L=Vr(e,t,a,n,q,j,u+s);if(L.length>0&&L[0]>=q&&L[1]>=j)return[L[0],L[1]];var H=a-v+u;var W=n+c-u;L=Vr(e,t,a,n,H,W,u+s);return L.length>0&&L[0]<=H&&L[1]>=W?[L[0],L[1]]:[]};var Pr=function inLineVicinity(e,t,a,n,i,o,s){var l=s;var u=Math.min(a,i);var v=Math.max(a,i);var c=Math.min(n,o);var d=Math.max(n,o);return u-l<=e&&e<=v+l&&c-l<=t&&t<=d+l};var _r=function inBezierVicinity(e,t,a,n,i,o,s,l,u){var v={x1:Math.min(a,s,i)-u,x2:Math.max(a,s,i)+u,y1:Math.min(n,l,o)-u,y2:Math.max(n,l,o)+u};return!(e<v.x1||e>v.x2||t<v.y1||t>v.y2)};var Dr=function solveQuadratic(e,t,a,n){a-=n;var i=t*t-4*e*a;if(i<0)return[];var o=Math.sqrt(i);var s=2*e;var l=(-t+o)/s;var u=(-t-o)/s;return[l,u]};var Ar=function solveCubic(e,t,a,n,i){var o=1e-5;e===0&&(e=o);t/=e;a/=e;n/=e;var s,l,u,v,c,d,h,p;l=(3*a-t*t)/9;u=-27*n+t*(9*a-t*t*2);u/=54;s=l*l*l+u*u;i[1]=0;h=t/3;if(s>0){c=u+Math.sqrt(s);c=c<0?-Math.pow(-c,1/3):Math.pow(c,1/3);d=u-Math.sqrt(s);d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3);i[0]=-h+c+d;h+=(c+d)/2;i[4]=i[2]=-h;h=Math.sqrt(3)*(-d+c)/2;i[3]=h;i[5]=-h}else{i[5]=i[3]=0;if(s!==0){l=-l;v=l*l*l;v=Math.acos(u/Math.sqrt(v));p=2*Math.sqrt(l);i[0]=-h+p*Math.cos(v/3);i[2]=-h+p*Math.cos((v+2*Math.PI)/3);i[4]=-h+p*Math.cos((v+4*Math.PI)/3)}else{p=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3);i[0]=2*p-h;i[4]=i[2]=-(p+h)}}};var Br=function sqdistToQuadraticBezier(e,t,a,n,i,o,s,l){var u=1*a*a-4*a*i+2*a*s+4*i*i-4*i*s+s*s+n*n-4*n*o+2*n*l+4*o*o-4*o*l+l*l;var v=9*a*i-3*a*a-3*a*s-6*i*i+3*i*s+9*n*o-3*n*n-3*n*l-6*o*o+3*o*l;var c=3*a*a-6*a*i+a*s-a*e+2*i*i+2*i*e-s*e+3*n*n-6*n*o+n*l-n*t+2*o*o+2*o*t-l*t;var d=1*a*i-a*a+a*e-i*e+n*o-n*n+n*t-o*t;var h=[];Ar(u,v,c,d,h);var p=1e-7;var g=[];for(var y=0;y<6;y+=2)Math.abs(h[y+1])<p&&h[y]>=0&&h[y]<=1&&g.push(h[y]);g.push(1);g.push(0);var m=-1;var b,x,w;for(var E=0;E<g.length;E++){b=Math.pow(1-g[E],2)*a+2*(1-g[E])*g[E]*i+g[E]*g[E]*s;x=Math.pow(1-g[E],2)*n+2*(1-g[E])*g[E]*o+g[E]*g[E]*l;w=Math.pow(b-e,2)+Math.pow(x-t,2);m>=0?w<m&&(m=w):m=w}return m};var Ir=function sqdistToFiniteLine(e,t,a,n,i,o){var s=[e-a,t-n];var l=[i-a,o-n];var u=l[0]*l[0]+l[1]*l[1];var v=s[0]*s[0]+s[1]*s[1];var c=s[0]*l[0]+s[1]*l[1];var d=c*c/u;return c<0?v:d>u?(e-i)*(e-i)+(t-o)*(t-o):v-d};var Mr=function pointInsidePolygonPoints(e,t,a){var n,i,o,s;var l;var u=0;for(var v=0;v<a.length/2;v++){n=a[v*2];i=a[v*2+1];if(v+1<a.length/2){o=a[(v+1)*2];s=a[(v+1)*2+1]}else{o=a[2*(v+1-a.length/2)];s=a[2*(v+1-a.length/2)+1]}if(n==e&&o==e);else{if(!(n>=e&&e>=o||n<=e&&e<=o))continue;l=(e-n)/(o-n)*(s-i)+i;l>t&&u++}}return u%2!==0};var Rr=function pointInsidePolygon(e,t,a,n,i,o,s,l,u){var v=new Array(a.length);var c;if(l[0]!=null){c=Math.atan(l[1]/l[0]);l[0]<0?c+=Math.PI/2:c=-c-Math.PI/2}else c=l;var d=Math.cos(-c);var h=Math.sin(-c);for(var p=0;p<v.length/2;p++){v[p*2]=o/2*(a[p*2]*d-a[p*2+1]*h);v[p*2+1]=s/2*(a[p*2+1]*d+a[p*2]*h);v[p*2]+=n;v[p*2+1]+=i}var g;if(u>0){var y=Or(v,-u);g=Nr(y)}else g=v;return Mr(e,t,g)};var Lr=function pointInsideRoundPolygon(e,t,a,n,i,o,s,l){var u=new Array(a.length*2);for(var v=0;v<l.length;v++){var c=l[v];u[v*4+0]=c.startX;u[v*4+1]=c.startY;u[v*4+2]=c.stopX;u[v*4+3]=c.stopY;var d=Math.pow(c.cx-e,2)+Math.pow(c.cy-t,2);if(d<=Math.pow(c.radius,2))return true}return Mr(e,t,u)};var Nr=function joinLines(e){var t=new Array(e.length/2);var a,n,i,o;var s,l,u,v;for(var c=0;c<e.length/4;c++){a=e[c*4];n=e[c*4+1];i=e[c*4+2];o=e[c*4+3];if(c<e.length/4-1){s=e[(c+1)*4];l=e[(c+1)*4+1];u=e[(c+1)*4+2];v=e[(c+1)*4+3]}else{s=e[0];l=e[1];u=e[2];v=e[3]}var d=jr(a,n,i,o,s,l,u,v,true);t[c*2]=d[0];t[c*2+1]=d[1]}return t};var Or=function expandPolygon(e,t){var a=new Array(e.length*2);var n,i,o,s;for(var l=0;l<e.length/2;l++){n=e[l*2];i=e[l*2+1];if(l<e.length/2-1){o=e[(l+1)*2];s=e[(l+1)*2+1]}else{o=e[0];s=e[1]}var u=s-i;var v=-(o-n);var c=Math.sqrt(u*u+v*v);var d=u/c;var h=v/c;a[l*4]=n+d*t;a[l*4+1]=i+h*t;a[l*4+2]=o+d*t;a[l*4+3]=s+h*t}return a};var Fr=function intersectLineEllipse(e,t,a,n,i,o){var s=a-e;var l=n-t;s/=i;l/=o;var u=Math.sqrt(s*s+l*l);var v=u-1;if(v<0)return[];var c=v/u;return[(a-e)*c+e,(n-t)*c+t]};var zr=function checkInEllipse(e,t,a,n,i,o,s){e-=i;t-=o;e/=a/2+s;t/=n/2+s;return e*e+t*t<=1};var Vr=function intersectLineCircle(e,t,a,n,i,o,s){var l=[a-e,n-t];var u=[e-i,t-o];var v=l[0]*l[0]+l[1]*l[1];var c=2*(u[0]*l[0]+u[1]*l[1]);var d=u[0]*u[0]+u[1]*u[1]-s*s;var h=c*c-4*v*d;if(h<0)return[];var p=(-c+Math.sqrt(h))/(2*v);var g=(-c-Math.sqrt(h))/(2*v);var y=Math.min(p,g);var m=Math.max(p,g);var b=[];y>=0&&y<=1&&b.push(y);m>=0&&m<=1&&b.push(m);if(b.length===0)return[];var x=b[0]*l[0]+e;var w=b[0]*l[1]+t;if(b.length>1){if(b[0]==b[1])return[x,w];var E=b[1]*l[0]+e;var T=b[1]*l[1]+t;return[x,w,E,T]}return[x,w]};var qr=function midOfThree(e,t,a){return t<=e&&e<=a||a<=e&&e<=t?e:e<=t&&t<=a||a<=t&&t<=e?t:a};var jr=function finiteLinesIntersect(e,t,a,n,i,o,s,l,u){var v=e-i;var c=a-e;var d=s-i;var h=t-o;var p=n-t;var g=l-o;var y=d*h-g*v;var m=c*h-p*v;var b=g*c-d*p;if(b!==0){var x=y/b;var w=m/b;var E=.001;var T=0-E;var S=1+E;return T<=x&&x<=S&&T<=w&&w<=S||u?[e+x*c,t+x*p]:[]}return y===0||m===0?qr(e,a,s)===s?[s,l]:qr(e,a,i)===i?[i,o]:qr(i,s,a)===a?[a,n]:[]:[]};var Hr=function polygonIntersectLine(e,t,a,n,i,o,s,l){var u=[];var v;var c=new Array(a.length);var d=true;o==null&&(d=false);var h;if(d){for(var p=0;p<c.length/2;p++){c[p*2]=a[p*2]*o+n;c[p*2+1]=a[p*2+1]*s+i}if(l>0){var g=Or(c,-l);h=Nr(g)}else h=c}else h=a;var y,m,b,x;for(var w=0;w<h.length/2;w++){y=h[w*2];m=h[w*2+1];if(w<h.length/2-1){b=h[(w+1)*2];x=h[(w+1)*2+1]}else{b=h[0];x=h[1]}v=jr(e,t,n,i,y,m,b,x);v.length!==0&&u.push(v[0],v[1])}return u};var Wr=function roundPolygonIntersectLine(e,t,a,n,i,o,s,l,u){var v=[];var c;var d=new Array(a.length*2);u.forEach((function(a,o){if(o===0){d[d.length-2]=a.startX;d[d.length-1]=a.startY}else{d[o*4-2]=a.startX;d[o*4-1]=a.startY}d[o*4]=a.stopX;d[o*4+1]=a.stopY;c=Vr(e,t,n,i,a.cx,a.cy,a.radius);c.length!==0&&v.push(c[0],c[1])}));for(var h=0;h<d.length/4;h++){c=jr(e,t,n,i,d[h*4],d[h*4+1],d[h*4+2],d[h*4+3],false);c.length!==0&&v.push(c[0],c[1])}if(v.length>2){var p=[v[0],v[1]];var g=Math.pow(p[0]-e,2)+Math.pow(p[1]-t,2);for(var y=1;y<v.length/2;y++){var m=Math.pow(v[y*2]-e,2)+Math.pow(v[y*2+1]-t,2);if(m<=g){p[0]=v[y*2];p[1]=v[y*2+1];g=m}}return p}return v};var Xr=function shortenIntersection(e,t,a){var n=[e[0]-t[0],e[1]-t[1]];var i=Math.sqrt(n[0]*n[0]+n[1]*n[1]);var o=(i-a)/i;o<0&&(o=1e-5);return[t[0]+o*n[0],t[1]+o*n[1]]};var Yr=function generateUnitNgonPointsFitToSquare(e,t){var a=Kr(e,t);a=Gr(a);return a};var Gr=function fitPolygonToSquare(e){var t,a;var n=e.length/2;var i=Infinity,o=Infinity,s=-Infinity,l=-Infinity;for(var u=0;u<n;u++){t=e[2*u];a=e[2*u+1];i=Math.min(i,t);s=Math.max(s,t);o=Math.min(o,a);l=Math.max(l,a)}var v=2/(s-i);var c=2/(l-o);for(var d=0;d<n;d++){t=e[2*d]=e[2*d]*v;a=e[2*d+1]=e[2*d+1]*c;i=Math.min(i,t);s=Math.max(s,t);o=Math.min(o,a);l=Math.max(l,a)}if(o<-1)for(var h=0;h<n;h++)a=e[2*h+1]=e[2*h+1]+(-1-o);return e};var Kr=function generateUnitNgonPoints(e,t){var a=1/e*2*Math.PI;var n=e%2===0?Math.PI/2+a/2:Math.PI/2;n+=t;var i=new Array(e*2);var o;for(var s=0;s<e;s++){o=s*a+n;i[2*s]=Math.cos(o);i[2*s+1]=Math.sin(-o)}return i};var Ur=function getRoundRectangleRadius(e,t){return Math.min(e/4,t/4,8)};var Zr=function getRoundPolygonRadius(e,t){return Math.min(e/10,t/10,8)};var $r=function getCutRectangleCornerLength(){return 8};var Qr=function bezierPtsToQuadCoeff(e,t,a){return[e-2*t+a,2*(t-e),e]};var Jr=function getBarrelCurveConstants(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};var ea=ft({dampingFactor:.8,precision:1e-6,iterations:200,weight:function weight(e){return 1}});var ta={pageRank:function pageRank(e){var t=ea(e),a=t.dampingFactor,n=t.precision,i=t.iterations,o=t.weight;var s=this._private.cy;var l=this.byGroup(),u=l.nodes,v=l.edges;var c=u.length;var d=c*c;var h=v.length;var p=new Array(d);var g=new Array(c);var y=(1-a)/c;for(var m=0;m<c;m++){for(var b=0;b<c;b++){var x=m*c+b;p[x]=0}g[m]=0}for(var w=0;w<h;w++){var E=v[w];var T=E.data("source");var S=E.data("target");if(T!==S){var k=u.indexOfId(T);var P=u.indexOfId(S);var _=o(E);var D=P*c+k;p[D]+=_;g[k]+=_}}var I=1/c+y;for(var M=0;M<c;M++)if(g[M]===0)for(var R=0;R<c;R++){var L=R*c+M;p[L]=I}else for(var N=0;N<c;N++){var O=N*c+M;p[O]=p[O]/g[M]+y}var z=new Array(c);var V=new Array(c);var q;for(var j=0;j<c;j++)z[j]=1;for(var H=0;H<i;H++){for(var W=0;W<c;W++)V[W]=0;for(var X=0;X<c;X++)for(var Y=0;Y<c;Y++){var G=X*c+Y;V[X]+=p[G]*z[Y]}lr(V);q=z;z=V;V=q;var K=0;for(var U=0;U<c;U++){var Z=q[U]-z[U];K+=Z*Z}if(K<n)break}var Q={rank:function rank(e){e=s.collection(e)[0];return z[u.indexOf(e)]}};return Q}};var ra=ft({root:null,weight:function weight(e){return 1},directed:false,alpha:0});var aa={degreeCentralityNormalized:function degreeCentralityNormalized(e){e=ra(e);var t=this.cy();var a=this.nodes();var n=a.length;if(e.directed){var i={};var o={};var s=0;var u=0;for(var v=0;v<n;v++){var c=a[v];var d=c.id();e.root=c;var h=this.degreeCentrality(e);s<h.indegree&&(s=h.indegree);u<h.outdegree&&(u=h.outdegree);i[d]=h.indegree;o[d]=h.outdegree}return{indegree:function indegree(e){if(s==0)return 0;l(e)&&(e=t.filter(e));return i[e.id()]/s},outdegree:function outdegree(e){if(u===0)return 0;l(e)&&(e=t.filter(e));return o[e.id()]/u}}}var p={};var g=0;for(var y=0;y<n;y++){var m=a[y];e.root=m;var b=this.degreeCentrality(e);g<b.degree&&(g=b.degree);p[m.id()]=b.degree}return{degree:function degree(e){if(g===0)return 0;l(e)&&(e=t.filter(e));return p[e.id()]/g}}},degreeCentrality:function degreeCentrality(e){e=ra(e);var t=this.cy();var a=this;var n=e,i=n.root,o=n.weight,s=n.directed,l=n.alpha;i=t.collection(i)[0];if(s){var u=i.connectedEdges();var v=u.filter((function(e){return e.target().same(i)&&a.has(e)}));var c=u.filter((function(e){return e.source().same(i)&&a.has(e)}));var d=v.length;var h=c.length;var p=0;var g=0;for(var y=0;y<v.length;y++)p+=o(v[y]);for(var m=0;m<c.length;m++)g+=o(c[m]);return{indegree:Math.pow(d,1-l)*Math.pow(p,l),outdegree:Math.pow(h,1-l)*Math.pow(g,l)}}var b=i.connectedEdges().intersection(a);var x=b.length;var w=0;for(var E=0;E<b.length;E++)w+=o(b[E]);return{degree:Math.pow(x,1-l)*Math.pow(w,l)}}};aa.dc=aa.degreeCentrality;aa.dcn=aa.degreeCentralityNormalised=aa.degreeCentralityNormalized;var na=ft({harmonic:true,weight:function weight(){return 1},directed:false,root:null});var ia={closenessCentralityNormalized:function closenessCentralityNormalized(e){var t=na(e),a=t.harmonic,n=t.weight,i=t.directed;var o=this.cy();var s={};var u=0;var v=this.nodes();var c=this.floydWarshall({weight:n,directed:i});for(var d=0;d<v.length;d++){var h=0;var p=v[d];for(var g=0;g<v.length;g++)if(d!==g){var y=c.distance(p,v[g]);h+=a?1/y:y}a||(h=1/h);u<h&&(u=h);s[p.id()]=h}return{closeness:function closeness(e){if(u==0)return 0;e=l(e)?o.filter(e)[0].id():e.id();return s[e]/u}}},closenessCentrality:function closenessCentrality(e){var t=na(e),a=t.root,n=t.weight,i=t.directed,o=t.harmonic;a=this.filter(a)[0];var s=this.dijkstra({root:a,weight:n,directed:i});var l=0;var u=this.nodes();for(var v=0;v<u.length;v++){var c=u[v];if(!c.same(a)){var d=s.distanceTo(c);l+=o?1/d:d}}return o?l:1/l}};ia.cc=ia.closenessCentrality;ia.ccn=ia.closenessCentralityNormalised=ia.closenessCentralityNormalized;var oa=ft({weight:null,directed:false});var sa={betweennessCentrality:function betweennessCentrality(e){var t=oa(e),a=t.directed,n=t.weight;var i=n!=null;var o=this.cy();var s=this.nodes();var l={};var u={};var v=0;var c={set:function set(e,t){u[e]=t;t>v&&(v=t)},get:function get(e){return u[e]}};for(var d=0;d<s.length;d++){var h=s[d];var p=h.id();l[p]=a?h.outgoers().nodes():h.openNeighborhood().nodes();c.set(p,0)}var g=function _loop(){var e=s[y].id();var t=[];var a={};var u={};var v={};var d=new Rt((function(e,t){return v[e]-v[t]}));for(var h=0;h<s.length;h++){var p=s[h].id();a[p]=[];u[p]=0;v[p]=Infinity}u[e]=1;v[e]=0;d.push(e);while(!d.empty()){var g=d.pop();t.push(g);if(i)for(var m=0;m<l[g].length;m++){var b=l[g][m];var x=o.getElementById(g);var w=void 0;w=x.edgesTo(b).length>0?x.edgesTo(b)[0]:b.edgesTo(x)[0];var E=n(w);b=b.id();if(v[b]>v[g]+E){v[b]=v[g]+E;d.nodes.indexOf(b)<0?d.push(b):d.updateItem(b);u[b]=0;a[b]=[]}if(v[b]==v[g]+E){u[b]=u[b]+u[g];a[b].push(g)}}else for(var T=0;T<l[g].length;T++){var S=l[g][T].id();if(v[S]==Infinity){d.push(S);v[S]=v[g]+1}if(v[S]==v[g]+1){u[S]=u[S]+u[g];a[S].push(g)}}}var k={};for(var P=0;P<s.length;P++)k[s[P].id()]=0;while(t.length>0){var _=t.pop();for(var D=0;D<a[_].length;D++){var I=a[_][D];k[I]=k[I]+u[I]/u[_]*(1+k[_])}_!=s[y].id()&&c.set(_,c.get(_)+k[_])}};for(var y=0;y<s.length;y++)g();var m={betweenness:function betweenness(e){var t=o.collection(e).id();return c.get(t)},betweennessNormalized:function betweennessNormalized(e){if(v==0)return 0;var t=o.collection(e).id();return c.get(t)/v}};m.betweennessNormalised=m.betweennessNormalized;return m}};sa.bc=sa.betweennessCentrality;var la=ft({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(e){return 1}]});var ua=function setOptions(e){return la(e)};var va=function getSimilarity(e,t){var a=0;for(var n=0;n<t.length;n++)a+=t[n](e);return a};var ca=function addLoops(e,t,a){for(var n=0;n<t;n++)e[n*t+n]=a};var da=function normalize(e,t){var a;for(var n=0;n<t;n++){a=0;for(var i=0;i<t;i++)a+=e[i*t+n];for(var o=0;o<t;o++)e[o*t+n]=e[o*t+n]/a}};var ha=function mmult(e,t,a){var n=new Array(a*a);for(var i=0;i<a;i++){for(var o=0;o<a;o++)n[i*a+o]=0;for(var s=0;s<a;s++)for(var l=0;l<a;l++)n[i*a+l]+=e[i*a+s]*t[s*a+l]}return n};var fa=function expand(e,t,a){var n=e.slice(0);for(var i=1;i<a;i++)e=ha(e,n,t);return e};var pa=function inflate(e,t,a){var n=new Array(t*t);for(var i=0;i<t*t;i++)n[i]=Math.pow(e[i],a);da(n,t);return n};var ga=function hasConverged(e,t,a,n){for(var i=0;i<a;i++){var o=Math.round(e[i]*Math.pow(10,n))/Math.pow(10,n);var s=Math.round(t[i]*Math.pow(10,n))/Math.pow(10,n);if(o!==s)return false}return true};var ya=function assign(e,t,a,n){var i=[];for(var o=0;o<t;o++){var s=[];for(var l=0;l<t;l++)Math.round(e[o*t+l]*1e3)/1e3>0&&s.push(a[l]);s.length!==0&&i.push(n.collection(s))}return i};var ma=function isDuplicate(e,t){for(var a=0;a<e.length;a++)if(!t[a]||e[a].id()!==t[a].id())return false;return true};var ba=function removeDuplicates(e){for(var t=0;t<e.length;t++)for(var a=0;a<e.length;a++)t!=a&&ma(e[t],e[a])&&e.splice(a,1);return e};var xa=function markovClustering(e){var t=this.nodes();var a=this.edges();var n=this.cy();var i=ua(e);var o={};for(var s=0;s<t.length;s++)o[t[s].id()]=s;var l=t.length,u=l*l;var v,c=new Array(u);for(var d=0;d<u;d++)c[d]=0;for(var h=0;h<a.length;h++){var p=a[h];var g=o[p.source().id()];var y=o[p.target().id()];var m=va(p,i.attributes);c[g*l+y]+=m;c[y*l+g]+=m}ca(c,l,i.multFactor);da(c,l);var b=true;var x=0;while(b&&x<i.maxIterations){b=false;v=fa(c,l,i.expandFactor);c=pa(v,l,i.inflateFactor);ga(c,v,u,4)||(b=true);x++}var w=ya(c,l,t,n);w=ba(w);return w};var wa={markovClustering:xa,mcl:xa};var Ea=function identity(e){return e};var Ca=function absDiff(e,t){return Math.abs(t-e)};var Ta=function addAbsDiff(e,t,a){return e+Ca(t,a)};var Sa=function addSquaredDiff(e,t,a){return e+Math.pow(a-t,2)};var ka=function sqrt(e){return Math.sqrt(e)};var Pa=function maxAbsDiff(e,t,a){return Math.max(e,Ca(t,a))};var _a=function getDistance(e,t,a,n,i){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:Ea;var s=n;var l,u;for(var v=0;v<e;v++){l=t(v);u=a(v);s=i(s,l,u)}return o(s)};var Da={euclidean:function euclidean(e,t,a){return e>=2?_a(e,t,a,0,Sa,ka):_a(e,t,a,0,Ta)},squaredEuclidean:function squaredEuclidean(e,t,a){return _a(e,t,a,0,Sa)},manhattan:function manhattan(e,t,a){return _a(e,t,a,0,Ta)},max:function max(e,t,a){return _a(e,t,a,-Infinity,Pa)}};Da["squared-euclidean"]=Da.squaredEuclidean;Da.squaredeuclidean=Da.squaredEuclidean;function clusteringDistance(e,t,a,n,i,o){var s;s=u(e)?e:Da[e]||Da.euclidean;return t===0&&u(e)?s(i,o):s(t,a,n,i,o)}var Aa=ft({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:false,testCentroids:null});var Ba=function setOptions(e){return Aa(e)};var Ia=function getDist(e,t,a,n,i){var o=i!=="kMedoids";var s=o?function(e){return a[e]}:function(e){return n[e](a)};var l=function getQ(e){return n[e](t)};var u=a;var v=t;return clusteringDistance(e,n.length,s,l,u,v)};var Ma=function randomCentroids(e,t,a){var n=a.length;var i=new Array(n);var o=new Array(n);var s=new Array(t);var l=null;for(var u=0;u<n;u++){i[u]=e.min(a[u]).value;o[u]=e.max(a[u]).value}for(var v=0;v<t;v++){l=[];for(var c=0;c<n;c++)l[c]=Math.random()*(o[c]-i[c])+i[c];s[v]=l}return s};var Ra=function classify(e,t,a,n,i){var o=Infinity;var s=0;for(var l=0;l<t.length;l++){var u=Ia(a,e,t[l],n,i);if(u<o){o=u;s=l}}return s};var La=function buildCluster(e,t,a){var n=[];var i=null;for(var o=0;o<t.length;o++){i=t[o];a[i.id()]===e&&n.push(i)}return n};var Na=function haveValuesConverged(e,t,a){return Math.abs(t-e)<=a};var Oa=function haveMatricesConverged(e,t,a){for(var n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++){var o=Math.abs(e[n][i]-t[n][i]);if(o>a)return false}return true};var Fa=function seenBefore(e,t,a){for(var n=0;n<a;n++)if(e===t[n])return true;return false};var za=function randomMedoids(e,t){var a=new Array(t);if(e.length<50)for(var n=0;n<t;n++){var i=e[Math.floor(Math.random()*e.length)];while(Fa(i,a,n))i=e[Math.floor(Math.random()*e.length)];a[n]=i}else for(var o=0;o<t;o++)a[o]=e[Math.floor(Math.random()*e.length)];return a};var Va=function findCost(e,t,a){var n=0;for(var i=0;i<t.length;i++)n+=Ia("manhattan",t[i],e,a,"kMedoids");return n};var qa=function kMeans(e){var t=this.cy();var a=this.nodes();var n=null;var i=Ba(e);var o=new Array(i.k);var s={};var l;if(i.testMode)if(typeof i.testCentroids==="number"){i.testCentroids;l=Ma(a,i.k,i.attributes)}else l=_typeof(i.testCentroids)==="object"?i.testCentroids:Ma(a,i.k,i.attributes);else l=Ma(a,i.k,i.attributes);var u=true;var v=0;while(u&&v<i.maxIterations){for(var c=0;c<a.length;c++){n=a[c];s[n.id()]=Ra(n,l,i.distance,i.attributes,"kMeans")}u=false;for(var d=0;d<i.k;d++){var h=La(d,a,s);if(h.length!==0){var p=i.attributes.length;var g=l[d];var y=new Array(p);var m=new Array(p);for(var b=0;b<p;b++){m[b]=0;for(var x=0;x<h.length;x++){n=h[x];m[b]+=i.attributes[b](n)}y[b]=m[b]/h.length;Na(y[b],g[b],i.sensitivityThreshold)||(u=true)}l[d]=y;o[d]=t.collection(h)}}v++}return o};var ja=function kMedoids(e){var t=this.cy();var a=this.nodes();var n=null;var i=Ba(e);var o=new Array(i.k);var s;var l={};var u;var v=new Array(i.k);i.testMode?typeof i.testCentroids==="number"||(s=_typeof(i.testCentroids)==="object"?i.testCentroids:za(a,i.k)):s=za(a,i.k);var c=true;var d=0;while(c&&d<i.maxIterations){for(var h=0;h<a.length;h++){n=a[h];l[n.id()]=Ra(n,s,i.distance,i.attributes,"kMedoids")}c=false;for(var p=0;p<s.length;p++){var g=La(p,a,l);if(g.length!==0){v[p]=Va(s[p],g,i.attributes);for(var y=0;y<g.length;y++){u=Va(g[y],g,i.attributes);if(u<v[p]){v[p]=u;s[p]=g[y];c=true}}o[p]=t.collection(g)}}d++}return o};var Ha=function updateCentroids(e,t,a,n,i){var o,s;for(var l=0;l<t.length;l++)for(var u=0;u<e.length;u++)n[l][u]=Math.pow(a[l][u],i.m);for(var v=0;v<e.length;v++)for(var c=0;c<i.attributes.length;c++){o=0;s=0;for(var d=0;d<t.length;d++){o+=n[d][v]*i.attributes[c](t[d]);s+=n[d][v]}e[v][c]=o/s}};var Wa=function updateMembership(e,t,a,n,i){for(var o=0;o<e.length;o++)t[o]=e[o].slice();var s,l,u;var v=2/(i.m-1);for(var c=0;c<a.length;c++)for(var d=0;d<n.length;d++){s=0;for(var h=0;h<a.length;h++){l=Ia(i.distance,n[d],a[c],i.attributes,"cmeans");u=Ia(i.distance,n[d],a[h],i.attributes,"cmeans");s+=Math.pow(l/u,v)}e[d][c]=1/s}};var Xa=function assign(e,t,a,n){var i=new Array(a.k);for(var o=0;o<i.length;o++)i[o]=[];var s;var l;for(var u=0;u<t.length;u++){s=-Infinity;l=-1;for(var v=0;v<t[0].length;v++)if(t[u][v]>s){s=t[u][v];l=v}i[l].push(e[u])}for(var c=0;c<i.length;c++)i[c]=n.collection(i[c]);return i};var Ya=function fuzzyCMeans(e){var t=this.cy();var a=this.nodes();var n=Ba(e);var i;var o;var s;var l;var u;l=new Array(a.length);for(var v=0;v<a.length;v++)l[v]=new Array(n.k);s=new Array(a.length);for(var c=0;c<a.length;c++)s[c]=new Array(n.k);for(var d=0;d<a.length;d++){var h=0;for(var p=0;p<n.k;p++){s[d][p]=Math.random();h+=s[d][p]}for(var g=0;g<n.k;g++)s[d][g]=s[d][g]/h}o=new Array(n.k);for(var y=0;y<n.k;y++)o[y]=new Array(n.attributes.length);u=new Array(a.length);for(var m=0;m<a.length;m++)u[m]=new Array(n.k);var b=true;var x=0;while(b&&x<n.maxIterations){b=false;Ha(o,a,s,u,n);Wa(s,l,o,a,n);Oa(s,l,n.sensitivityThreshold)||(b=true);x++}i=Xa(a,s,n,t);return{clusters:i,degreeOfMembership:s}};var Ga={kMeans:qa,kMedoids:ja,fuzzyCMeans:Ya,fcm:Ya};var Ka=ft({distance:"euclidean",linkage:"min",mode:"threshold",threshold:Infinity,addDendrogram:false,dendrogramDepth:0,attributes:[]});var Ua={single:"min",complete:"max"};var Za=function setOptions(e){var t=Ka(e);var a=Ua[t.linkage];a!=null&&(t.linkage=a);return t};var $a=function mergeClosest(e,t,a,n,i){var o=0;var s=Infinity;var l;var u=i.attributes;var v=function getDist(e,t){return clusteringDistance(i.distance,u.length,(function(t){return u[t](e)}),(function(e){return u[e](t)}),e,t)};for(var c=0;c<e.length;c++){var d=e[c].key;var h=a[d][n[d]];if(h<s){o=d;s=h}}if(i.mode==="threshold"&&s>=i.threshold||i.mode==="dendrogram"&&e.length===1)return false;var p=t[o];var g=t[n[o]];var y;y=i.mode==="dendrogram"?{left:p,right:g,key:p.key}:{value:p.value.concat(g.value),key:p.key};e[p.index]=y;e.splice(g.index,1);t[p.key]=y;for(var m=0;m<e.length;m++){var b=e[m];if(p.key===b.key)l=Infinity;else if(i.linkage==="min"){l=a[p.key][b.key];a[p.key][b.key]>a[g.key][b.key]&&(l=a[g.key][b.key])}else if(i.linkage==="max"){l=a[p.key][b.key];a[p.key][b.key]<a[g.key][b.key]&&(l=a[g.key][b.key])}else l=i.linkage==="mean"?(a[p.key][b.key]*p.size+a[g.key][b.key]*g.size)/(p.size+g.size):i.mode==="dendrogram"?v(b.value,p.value):v(b.value[0],p.value[0]);a[p.key][b.key]=a[b.key][p.key]=l}for(var x=0;x<e.length;x++){var w=e[x].key;if(n[w]===p.key||n[w]===g.key){var E=w;for(var T=0;T<e.length;T++){var S=e[T].key;a[w][S]<a[w][E]&&(E=S)}n[w]=E}e[x].index=x}p.key=g.key=p.index=g.index=null;return true};var Qa=function getAllChildren(e,t,a){if(e)if(e.value)t.push(e.value);else{e.left&&Qa(e.left,t);e.right&&Qa(e.right,t)}};var Ja=function buildDendrogram(e,t){if(!e)return"";if(e.left&&e.right){var a=Ja(e.left,t);var n=Ja(e.right,t);var i=t.add({group:"nodes",data:{id:a+","+n}});t.add({group:"edges",data:{source:a,target:i.id()}});t.add({group:"edges",data:{source:n,target:i.id()}});return i.id()}return e.value?e.value.id():void 0};var en=function buildClustersFromTree(e,t,a){if(!e)return[];var n=[],i=[],o=[];if(t===0){e.left&&Qa(e.left,n);e.right&&Qa(e.right,i);o=n.concat(i);return[a.collection(o)]}if(t===1){if(e.value)return[a.collection(e.value)];e.left&&Qa(e.left,n);e.right&&Qa(e.right,i);return[a.collection(n),a.collection(i)]}if(e.value)return[a.collection(e.value)];e.left&&(n=en(e.left,t-1,a));e.right&&(i=en(e.right,t-1,a));return n.concat(i)};var tn=function hierarchicalClustering(e){var t=this.cy();var a=this.nodes();var n=Za(e);var i=n.attributes;var o=function getDist(e,t){return clusteringDistance(n.distance,i.length,(function(t){return i[t](e)}),(function(e){return i[e](t)}),e,t)};var s=[];var l=[];var u=[];var v=[];for(var c=0;c<a.length;c++){var d={value:n.mode==="dendrogram"?a[c]:[a[c]],key:c,index:c};s[c]=d;v[c]=d;l[c]=[];u[c]=0}for(var h=0;h<s.length;h++)for(var p=0;p<=h;p++){var g=void 0;g=n.mode==="dendrogram"?h===p?Infinity:o(s[h].value,s[p].value):h===p?Infinity:o(s[h].value[0],s[p].value[0]);l[h][p]=g;l[p][h]=g;g<l[h][u[h]]&&(u[h]=p)}var y=$a(s,v,l,u,n);while(y)y=$a(s,v,l,u,n);var m;if(n.mode==="dendrogram"){m=en(s[0],n.dendrogramDepth,t);n.addDendrogram&&Ja(s[0],t)}else{m=new Array(s.length);s.forEach((function(e,a){e.key=e.index=null;m[a]=t.collection(e.value)}))}return m};var rn={hierarchicalClustering:tn,hca:tn};var an=ft({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]});var nn=function setOptions(e){var t=e.damping;var a=e.preference;.5<=t&&t<1||it("Damping must range on [0.5, 1).  Got: ".concat(t));var n=["median","mean","min","max"];n.some((function(e){return e===a}))||h(a)||it("Preference must be one of [".concat(n.map((function(e){return"'".concat(e,"'")})).join(", "),"] or a number.  Got: ").concat(a));return an(e)};var sn=function getSimilarity(e,t,a,n){var i=function attr(e,t){return n[t](e)};return-clusteringDistance(e,n.length,(function(e){return i(t,e)}),(function(e){return i(a,e)}),t,a)};var ln=function getPreference(e,t){var a=null;a=t==="median"?tr(e):t==="mean"?er(e):t==="min"?Qt(e):t==="max"?Jt(e):t;return a};var un=function findExemplars(e,t,a){var n=[];for(var i=0;i<e;i++)t[i*e+i]+a[i*e+i]>0&&n.push(i);return n};var vn=function assignClusters(e,t,a){var n=[];for(var i=0;i<e;i++){var o=-1;var s=-Infinity;for(var l=0;l<a.length;l++){var u=a[l];if(t[i*e+u]>s){o=u;s=t[i*e+u]}}o>0&&n.push(o)}for(var v=0;v<a.length;v++)n[a[v]]=a[v];return n};var cn=function assign(e,t,a){var n=vn(e,t,a);for(var i=0;i<a.length;i++){var o=[];for(var s=0;s<n.length;s++)n[s]===a[i]&&o.push(s);var l=-1;var u=-Infinity;for(var v=0;v<o.length;v++){var c=0;for(var d=0;d<o.length;d++)c+=t[o[d]*e+o[v]];if(c>u){l=v;u=c}}a[i]=o[l]}n=vn(e,t,a);return n};var dn=function affinityPropagation(e){var t=this.cy();var a=this.nodes();var n=nn(e);var i={};for(var o=0;o<a.length;o++)i[a[o].id()]=o;var s;var l;var u;var v;var c;var d;s=a.length;l=s*s;u=new Array(l);for(var h=0;h<l;h++)u[h]=-Infinity;for(var p=0;p<s;p++)for(var g=0;g<s;g++)p!==g&&(u[p*s+g]=sn(n.distance,a[p],a[g],n.attributes));v=ln(u,n.preference);for(var y=0;y<s;y++)u[y*s+y]=v;c=new Array(l);for(var m=0;m<l;m++)c[m]=0;d=new Array(l);for(var b=0;b<l;b++)d[b]=0;var x=new Array(s);var w=new Array(s);var E=new Array(s);for(var T=0;T<s;T++){x[T]=0;w[T]=0;E[T]=0}var S=new Array(s*n.minIterations);for(var k=0;k<S.length;k++)S[k]=0;var P;for(P=0;P<n.maxIterations;P++){for(var _=0;_<s;_++){var D=-Infinity,I=-Infinity,M=-1,R=0;for(var L=0;L<s;L++){x[L]=c[_*s+L];R=d[_*s+L]+u[_*s+L];if(R>=D){I=D;D=R;M=L}else R>I&&(I=R)}for(var N=0;N<s;N++)c[_*s+N]=(1-n.damping)*(u[_*s+N]-D)+n.damping*x[N];c[_*s+M]=(1-n.damping)*(u[_*s+M]-I)+n.damping*x[M]}for(var O=0;O<s;O++){var z=0;for(var V=0;V<s;V++){x[V]=d[V*s+O];w[V]=Math.max(0,c[V*s+O]);z+=w[V]}z-=w[O];w[O]=c[O*s+O];z+=w[O];for(var q=0;q<s;q++)d[q*s+O]=(1-n.damping)*Math.min(0,z-w[q])+n.damping*x[q];d[O*s+O]=(1-n.damping)*(z-w[O])+n.damping*x[O]}var j=0;for(var H=0;H<s;H++){var W=d[H*s+H]+c[H*s+H]>0?1:0;S[P%n.minIterations*s+H]=W;j+=W}if(j>0&&(P>=n.minIterations-1||P==n.maxIterations-1)){var X=0;for(var Y=0;Y<s;Y++){E[Y]=0;for(var G=0;G<n.minIterations;G++)E[Y]+=S[G*s+Y];E[Y]!==0&&E[Y]!==n.minIterations||X++}if(X===s)break}}var K=un(s,c,d);var U=cn(s,u,K);var Z={};for(var Q=0;Q<K.length;Q++)Z[K[Q]]=[];for(var J=0;J<a.length;J++){var ee=i[a[J].id()];var te=U[ee];te!=null&&Z[te].push(a[J])}var re=new Array(K.length);for(var ae=0;ae<K.length;ae++)re[ae]=t.collection(Z[K[ae]]);return re};var hn={affinityPropagation:dn,ap:dn};var pn=ft({root:void 0,directed:false});var gn={hierholzer:function hierholzer(e){if(!c(e)){var t=arguments;e={root:t[0],directed:t[1]}}var a=pn(e),n=a.root,i=a.directed;var o=this;var s=false;var u;var v;var d;n&&(d=l(n)?this.filter(n)[0].id():n[0].id());var h={};var p={};i?o.forEach((function(e){var t=e.id();if(e.isNode()){var a=e.indegree(true);var n=e.outdegree(true);var i=a-n;var o=n-a;i==1?u?s=true:u=t:o==1?v?s=true:v=t:(o>1||i>1)&&(s=true);h[t]=[];e.outgoers().forEach((function(e){e.isEdge()&&h[t].push(e.id())}))}else p[t]=[void 0,e.target().id()]})):o.forEach((function(e){var t=e.id();if(e.isNode()){var a=e.degree(true);a%2&&(u?v?s=true:v=t:u=t);h[t]=[];e.connectedEdges().forEach((function(e){return h[t].push(e.id())}))}else p[t]=[e.source().id(),e.target().id()]}));var g={found:false,trail:void 0};if(s)return g;if(v&&u)if(i){if(d&&v!=d)return g;d=v}else{if(d&&v!=d&&u!=d)return g;d||(d=v)}else d||(d=o[0].id());var y=function walk(e){var t=e;var a=[e];var n,o,s;while(h[t].length){n=h[t].shift();o=p[n][0];s=p[n][1];if(t!=s){h[s]=h[s].filter((function(e){return e!=n}));t=s}else if(!i&&t!=o){h[o]=h[o].filter((function(e){return e!=n}));t=o}a.unshift(n);a.unshift(t)}return a};var m=[];var b=[];b=y(d);while(b.length!=1)if(h[b[0]].length==0){m.unshift(o.getElementById(b.shift()));m.unshift(o.getElementById(b.shift()))}else b=y(b.shift()).concat(b);m.unshift(o.getElementById(b.shift()));for(var x in h)if(h[x].length)return g;g.found=true;g.trail=this.spawn(m,true);return g}};var yn=function hopcroftTarjanBiconnected(){var e=this;var t={};var a=0;var n=0;var i=[];var o=[];var s={};var l=function buildComponent(a,n){var s=o.length-1;var l=[];var u=e.spawn();while(o[s].x!=a||o[s].y!=n){l.push(o.pop().edge);s--}l.push(o.pop().edge);l.forEach((function(a){var n=a.connectedNodes().intersection(e);u.merge(a);n.forEach((function(a){var n=a.id();var i=a.connectedEdges().intersection(e);u.merge(a);t[n].cutVertex?u.merge(i.filter((function(e){return e.isLoop()}))):u.merge(i)}))}));i.push(u)};var u=function biconnectedSearch(v,c,d){v===d&&(n+=1);t[c]={id:a,low:a++,cutVertex:false};var h=e.getElementById(c).connectedEdges().intersection(e);if(h.size()===0)i.push(e.spawn(e.getElementById(c)));else{var p,g,y,m;h.forEach((function(e){p=e.source().id();g=e.target().id();y=p===c?g:p;if(y!==d){m=e.id();if(!s[m]){s[m]=true;o.push({x:c,y:y,edge:e})}if(y in t)t[c].low=Math.min(t[c].low,t[y].id);else{u(v,y,c);t[c].low=Math.min(t[c].low,t[y].low);if(t[c].id<=t[y].low){t[c].cutVertex=true;l(c,y)}}}}))}};e.forEach((function(e){if(e.isNode()){var a=e.id();if(!(a in t)){n=0;u(a,a);t[a].cutVertex=n>1}}}));var v=Object.keys(t).filter((function(e){return t[e].cutVertex})).map((function(t){return e.getElementById(t)}));return{cut:e.spawn(v),components:i}};var mn={hopcroftTarjanBiconnected:yn,htbc:yn,htb:yn,hopcroftTarjanBiconnectedComponents:yn};var bn=function tarjanStronglyConnected(){var e=this;var t={};var a=0;var n=[];var i=[];var o=e.spawn(e);var s=function stronglyConnectedSearch(l){i.push(l);t[l]={index:a,low:a++,explored:false};var u=e.getElementById(l).connectedEdges().intersection(e);u.forEach((function(e){var a=e.target().id();if(a!==l){a in t||s(a);t[a].explored||(t[l].low=Math.min(t[l].low,t[a].low))}}));if(t[l].index===t[l].low){var v=e.spawn();for(;;){var c=i.pop();v.merge(e.getElementById(c));t[c].low=t[l].index;t[c].explored=true;if(c===l)break}var d=v.edgesWith(v);var h=v.merge(d);n.push(h);o=o.difference(h)}};e.forEach((function(e){if(e.isNode()){var a=e.id();a in t||s(a)}}));return{cut:o,components:n}};var xn={tarjanStronglyConnected:bn,tsc:bn,tscc:bn,tarjanStronglyConnectedComponents:bn};var wn={};[Pt,Nt,Ot,zt,qt,Ht,Gt,ta,aa,ia,sa,wa,Ga,rn,hn,gn,mn,xn].forEach((function(e){Y(wn,e)}));var En=0;var Cn=1;var Tn=2;var Sn=function api(e){if(!(this instanceof Sn))return new Sn(e);this.id="Thenable/1.0.7";this.state=En;this.fulfillValue=void 0;this.rejectReason=void 0;this.onFulfilled=[];this.onRejected=[];this.proxy={then:this.then.bind(this)};typeof e==="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};Sn.prototype={fulfill:function fulfill(e){return kn(this,Cn,"fulfillValue",e)},reject:function reject(e){return kn(this,Tn,"rejectReason",e)},then:function then(e,t){var a=this;var n=new Sn;a.onFulfilled.push(Dn(e,n,"fulfill"));a.onRejected.push(Dn(t,n,"reject"));Pn(a);return n.proxy}};var kn=function deliver(e,t,a,n){if(e.state===En){e.state=t;e[a]=n;Pn(e)}return e};var Pn=function execute(e){e.state===Cn?_n(e,"onFulfilled",e.fulfillValue):e.state===Tn&&_n(e,"onRejected",e.rejectReason)};var _n=function execute_handlers(e,t,a){if(e[t].length!==0){var n=e[t];e[t]=[];var i=function func(){for(var e=0;e<n.length;e++)n[e](a)};typeof setImmediate==="function"?setImmediate(i):setTimeout(i,0)}};var Dn=function resolver(e,t,a){return function(n){if(typeof e!=="function")t[a].call(t,n);else{var i;try{i=e(n)}catch(e){t.reject(e);return}An(t,i)}}};var An=function resolve(e,t){if(e!==t&&e.proxy!==t){var a;if(_typeof(t)==="object"&&t!==null||typeof t==="function")try{a=t.then}catch(t){e.reject(t);return}if(typeof a!=="function")e.fulfill(t);else{var n=false;try{a.call(t,(function(a){if(!n){n=true;a===t?e.reject(new TypeError("circular thenable chain")):An(e,a)}}),(function(t){if(!n){n=true;e.reject(t)}}))}catch(t){n||e.reject(t)}}}else e.reject(new TypeError("cannot resolve promise with itself"))};Sn.all=function(e){return new Sn((function(t,a){var n=new Array(e.length);var i=0;var o=function fulfill(a,o){n[a]=o;i++;i===e.length&&t(n)};for(var s=0;s<e.length;s++)(function(t){var n=e[t];var i=n!=null&&n.then!=null;if(i)n.then((function(e){o(t,e)}),(function(e){a(e)}));else{var s=n;o(t,s)}})(s)}))};Sn.resolve=function(e){return new Sn((function(t,a){t(e)}))};Sn.reject=function(e){return new Sn((function(t,a){a(e)}))};var Bn=typeof Promise!=="undefined"?Promise:Sn;var In=function Animation(e,t,a){var n=x(e);var i=!n;var o=this._private=Y({duration:1e3},t,a);o.target=e;o.style=o.style||o.css;o.started=false;o.playing=false;o.hooked=false;o.applying=false;o.progress=0;o.completes=[];o.frames=[];o.complete&&u(o.complete)&&o.completes.push(o.complete);if(i){var s=e.position();o.startPosition=o.startPosition||{x:s.x,y:s.y};o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(n){var l=e.pan();o.startPan={x:l.x,y:l.y};o.startZoom=e.zoom()}this.length=1;this[0]=this};var Mn=In.prototype;Y(Mn,{instanceString:function instanceString(){return"animation"},hook:function hook(){var e=this._private;if(!e.hooked){var t;var a=e.target._private.animation;t=e.queue?a.queue:a.current;t.push(this);y(e.target)&&e.target.cy().addToAnimationPool(e.target);e.hooked=true}return this},play:function play(){var e=this._private;e.progress===1&&(e.progress=0);e.playing=true;e.started=false;e.stopped=false;this.hook();return this},playing:function playing(){return this._private.playing},apply:function apply(){var e=this._private;e.applying=true;e.started=false;e.stopped=false;this.hook();return this},applying:function applying(){return this._private.applying},pause:function pause(){var e=this._private;e.playing=false;e.started=false;return this},stop:function stop(){var e=this._private;e.playing=false;e.started=false;e.stopped=true;return this},rewind:function rewind(){return this.progress(0)},fastforward:function fastforward(){return this.progress(1)},time:function time(e){var t=this._private;return e===void 0?t.progress*t.duration:this.progress(e/t.duration)},progress:function progress(e){var t=this._private;var a=t.playing;if(e===void 0)return t.progress;a&&this.pause();t.progress=e;t.started=false;a&&this.play();return this},completed:function completed(){return this._private.progress===1},reverse:function reverse(){var e=this._private;var t=e.playing;t&&this.pause();e.progress=1-e.progress;e.started=false;var a=function swap(t,a){var n=e[t];if(n!=null){e[t]=e[a];e[a]=n}};a("zoom","startZoom");a("pan","startPan");a("position","startPosition");if(e.style)for(var n=0;n<e.style.length;n++){var i=e.style[n];var o=i.name;var s=e.startStyle[o];e.startStyle[o]=i;e.style[n]=s}t&&this.play();return this},promise:function promise(e){var t=this._private;var a;switch(e){case"frame":a=t.frames;break;default:case"complete":case"completed":a=t.completes}return new Bn((function(e,t){a.push((function(){e()}))}))}});Mn.complete=Mn.completed;Mn.run=Mn.play;Mn.running=Mn.playing;var Rn={animated:function animated(){return function animatedImpl(){var e=this;var t=e.length!==void 0;var a=t?e:[e];var n=this._private.cy||this;if(!n.styleEnabled())return false;var i=a[0];return i?i._private.animation.current.length>0:void 0}},clearQueue:function clearQueue(){return function clearQueueImpl(){var e=this;var t=e.length!==void 0;var a=t?e:[e];var n=this._private.cy||this;if(!n.styleEnabled())return this;for(var i=0;i<a.length;i++){var o=a[i];o._private.animation.queue=[]}return this}},delay:function delay(){return function delayImpl(e,t){var a=this._private.cy||this;return a.styleEnabled()?this.animate({delay:e,duration:e,complete:t}):this}},delayAnimation:function delayAnimation(){return function delayAnimationImpl(e,t){var a=this._private.cy||this;return a.styleEnabled()?this.animation({delay:e,duration:e,complete:t}):this}},animation:function animation(){return function animationImpl(e,t){var a=this;var n=a.length!==void 0;var i=n?a:[a];var o=this._private.cy||this;var s=!n;var l=!s;if(!o.styleEnabled())return this;var u=o.style();e=Y({},e,t);var v=Object.keys(e).length===0;if(v)return new In(i[0],e);e.duration===void 0&&(e.duration=400);switch(e.duration){case"slow":e.duration=600;break;case"fast":e.duration=200;break}if(l){e.style=u.getPropsList(e.style||e.css);e.css=void 0}if(l&&e.renderedPosition!=null){var d=e.renderedPosition;var h=o.pan();var p=o.zoom();e.position=Zt(d,p,h)}if(s&&e.panBy!=null){var g=e.panBy;var y=o.pan();e.pan={x:y.x+g.x,y:y.y+g.y}}var m=e.center||e.centre;if(s&&m!=null){var b=o.getCenterPan(m.eles,e.zoom);b!=null&&(e.pan=b)}if(s&&e.fit!=null){var x=e.fit;var w=o.getFitViewport(x.eles||x.boundingBox,x.padding);if(w!=null){e.pan=w.pan;e.zoom=w.zoom}}if(s&&c(e.zoom)){var E=o.getZoomedViewport(e.zoom);if(E!=null){E.zoomed&&(e.zoom=E.zoom);E.panned&&(e.pan=E.pan)}else e.zoom=null}return new In(i[0],e)}},animate:function animate(){return function animateImpl(e,t){var a=this;var n=a.length!==void 0;var i=n?a:[a];var o=this._private.cy||this;if(!o.styleEnabled())return this;t&&(e=Y({},e,t));for(var s=0;s<i.length;s++){var l=i[s];var u=l.animated()&&(e.queue===void 0||e.queue);var v=l.animation(e,u?{queue:true}:void 0);v.play()}return this}},stop:function stop(){return function stopImpl(e,t){var a=this;var n=a.length!==void 0;var i=n?a:[a];var o=this._private.cy||this;if(!o.styleEnabled())return this;for(var s=0;s<i.length;s++){var l=i[s];var u=l._private;var v=u.animation.current;for(var c=0;c<v.length;c++){var d=v[c];var h=d._private;t&&(h.duration=0)}e&&(u.animation.queue=[]);t||(u.animation.current=[])}o.notify("draw");return this}}};
/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */var Ln;var Nn;function requireIsArray(){if(Nn)return Ln;Nn=1;var e=Array.isArray;Ln=e;return Ln}var On;var Fn;function require_isKey(){if(Fn)return On;Fn=1;var e=requireIsArray(),t=requireIsSymbol();var a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;
/**
	 * Checks if `value` is a property name and not a property path.
	 *
	 * @private
	 * @param {*} value The value to check.
	 * @param {Object} [object] The object to query keys on.
	 * @returns {boolean} Returns `true` if `value` is a property name, else `false`.
	 */function isKey(i,o){if(e(i))return false;var s=typeof i;return!(s!="number"&&s!="symbol"&&s!="boolean"&&i!=null&&!t(i))||(n.test(i)||!a.test(i)||o!=null&&i in Object(o))}On=isKey;return On}var zn;var Vn;function requireIsFunction(){if(Vn)return zn;Vn=1;var e=require_baseGetTag(),t=requireIsObject();var a="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",o="[object Proxy]";
/**
	 * Checks if `value` is classified as a `Function` object.
	 *
	 * @static
	 * @memberOf _
	 * @since 0.1.0
	 * @category Lang
	 * @param {*} value The value to check.
	 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
	 * @example
	 *
	 * _.isFunction(_);
	 * // => true
	 *
	 * _.isFunction(/abc/);
	 * // => false
	 */function isFunction(s){if(!t(s))return false;var l=e(s);return l==n||l==i||l==a||l==o}zn=isFunction;return zn}var qn;var jn;function require_coreJsData(){if(jn)return qn;jn=1;var e=require_root();var t=e["__core-js_shared__"];qn=t;return qn}var Hn;var Wn;function require_isMasked(){if(Wn)return Hn;Wn=1;var e=require_coreJsData();var t=function(){var t=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();
/**
	 * Checks if `func` has its source masked.
	 *
	 * @private
	 * @param {Function} func The function to check.
	 * @returns {boolean} Returns `true` if `func` is masked, else `false`.
	 */function isMasked(e){return!!t&&t in e}Hn=isMasked;return Hn}var Xn;var Yn;function require_toSource(){if(Yn)return Xn;Yn=1;var e=Function.prototype;var t=e.toString;
/**
	 * Converts `func` to its source code.
	 *
	 * @private
	 * @param {Function} func The function to convert.
	 * @returns {string} Returns the source code.
	 */function toSource(e){if(e!=null){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}Xn=toSource;return Xn}var Gn;var Kn;function require_baseIsNative(){if(Kn)return Gn;Kn=1;var e=requireIsFunction(),t=require_isMasked(),a=requireIsObject(),n=require_toSource();var i=/[\\^$.*+?()[\]{}|]/g;var o=/^\[object .+?Constructor\]$/;var s=Function.prototype,l=Object.prototype;var u=s.toString;var v=l.hasOwnProperty;var c=RegExp("^"+u.call(v).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");
/**
	 * The base implementation of `_.isNative` without bad shim checks.
	 *
	 * @private
	 * @param {*} value The value to check.
	 * @returns {boolean} Returns `true` if `value` is a native function,
	 *  else `false`.
	 */function baseIsNative(i){if(!a(i)||t(i))return false;var s=e(i)?c:o;return s.test(n(i))}Gn=baseIsNative;return Gn}
/**
 * Gets the value at `key` of `object`.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */var Un;var Zn;function require_getValue(){if(Zn)return Un;Zn=1;function getValue(e,t){return e==null?void 0:e[t]}Un=getValue;return Un}var $n;var Qn;function require_getNative(){if(Qn)return $n;Qn=1;var e=require_baseIsNative(),t=require_getValue();
/**
	 * Gets the native function at `key` of `object`.
	 *
	 * @private
	 * @param {Object} object The object to query.
	 * @param {string} key The key of the method to get.
	 * @returns {*} Returns the function if it's native, else `undefined`.
	 */function getNative(a,n){var i=t(a,n);return e(i)?i:void 0}$n=getNative;return $n}var Jn;var ei;function require_nativeCreate(){if(ei)return Jn;ei=1;var e=require_getNative();var t=e(Object,"create");Jn=t;return Jn}var ti;var ri;function require_hashClear(){if(ri)return ti;ri=1;var e=require_nativeCreate();function hashClear(){this.__data__=e?e(null):{};this.size=0}ti=hashClear;return ti}
/**
 * Removes `key` and its value from the hash.
 *
 * @private
 * @name delete
 * @memberOf Hash
 * @param {Object} hash The hash to modify.
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */var ai;var ni;function require_hashDelete(){if(ni)return ai;ni=1;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}ai=hashDelete;return ai}var ii;var oi;function require_hashGet(){if(oi)return ii;oi=1;var e=require_nativeCreate();var t="__lodash_hash_undefined__";var a=Object.prototype;var n=a.hasOwnProperty;
/**
	 * Gets the hash value for `key`.
	 *
	 * @private
	 * @name get
	 * @memberOf Hash
	 * @param {string} key The key of the value to get.
	 * @returns {*} Returns the entry value.
	 */function hashGet(a){var i=this.__data__;if(e){var o=i[a];return o===t?void 0:o}return n.call(i,a)?i[a]:void 0}ii=hashGet;return ii}var si;var li;function require_hashHas(){if(li)return si;li=1;var e=require_nativeCreate();var t=Object.prototype;var a=t.hasOwnProperty;
/**
	 * Checks if a hash value for `key` exists.
	 *
	 * @private
	 * @name has
	 * @memberOf Hash
	 * @param {string} key The key of the entry to check.
	 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
	 */function hashHas(t){var n=this.__data__;return e?n[t]!==void 0:a.call(n,t)}si=hashHas;return si}var ui;var vi;function require_hashSet(){if(vi)return ui;vi=1;var e=require_nativeCreate();var t="__lodash_hash_undefined__";
/**
	 * Sets the hash `key` to `value`.
	 *
	 * @private
	 * @name set
	 * @memberOf Hash
	 * @param {string} key The key of the value to set.
	 * @param {*} value The value to set.
	 * @returns {Object} Returns the hash instance.
	 */function hashSet(a,n){var i=this.__data__;this.size+=this.has(a)?0:1;i[a]=e&&n===void 0?t:n;return this}ui=hashSet;return ui}var ci;var di;function require_Hash(){if(di)return ci;di=1;var e=require_hashClear(),t=require_hashDelete(),a=require_hashGet(),n=require_hashHas(),i=require_hashSet();
/**
	 * Creates a hash object.
	 *
	 * @private
	 * @constructor
	 * @param {Array} [entries] The key-value pairs to cache.
	 */function Hash(e){var t=-1,a=e==null?0:e.length;this.clear();while(++t<a){var n=e[t];this.set(n[0],n[1])}}Hash.prototype.clear=e;Hash.prototype.delete=t;Hash.prototype.get=a;Hash.prototype.has=n;Hash.prototype.set=i;ci=Hash;return ci}var hi;var fi;function require_listCacheClear(){if(fi)return hi;fi=1;function listCacheClear(){this.__data__=[];this.size=0}hi=listCacheClear;return hi}
/**
 * Performs a
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * comparison between two values to determine if they are equivalent.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.eq(object, object);
 * // => true
 *
 * _.eq(object, other);
 * // => false
 *
 * _.eq('a', 'a');
 * // => true
 *
 * _.eq('a', Object('a'));
 * // => false
 *
 * _.eq(NaN, NaN);
 * // => true
 */var pi;var gi;function requireEq(){if(gi)return pi;gi=1;function eq(e,t){return e===t||e!==e&&t!==t}pi=eq;return pi}var yi;var mi;function require_assocIndexOf(){if(mi)return yi;mi=1;var e=requireEq();
/**
	 * Gets the index at which the `key` is found in `array` of key-value pairs.
	 *
	 * @private
	 * @param {Array} array The array to inspect.
	 * @param {*} key The key to search for.
	 * @returns {number} Returns the index of the matched value, else `-1`.
	 */function assocIndexOf(t,a){var n=t.length;while(n--)if(e(t[n][0],a))return n;return-1}yi=assocIndexOf;return yi}var bi;var xi;function require_listCacheDelete(){if(xi)return bi;xi=1;var e=require_assocIndexOf();var t=Array.prototype;var a=t.splice;
/**
	 * Removes `key` and its value from the list cache.
	 *
	 * @private
	 * @name delete
	 * @memberOf ListCache
	 * @param {string} key The key of the value to remove.
	 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
	 */function listCacheDelete(t){var n=this.__data__,i=e(n,t);if(i<0)return false;var o=n.length-1;i==o?n.pop():a.call(n,i,1);--this.size;return true}bi=listCacheDelete;return bi}var wi;var Ei;function require_listCacheGet(){if(Ei)return wi;Ei=1;var e=require_assocIndexOf();
/**
	 * Gets the list cache value for `key`.
	 *
	 * @private
	 * @name get
	 * @memberOf ListCache
	 * @param {string} key The key of the value to get.
	 * @returns {*} Returns the entry value.
	 */function listCacheGet(t){var a=this.__data__,n=e(a,t);return n<0?void 0:a[n][1]}wi=listCacheGet;return wi}var Ci;var Ti;function require_listCacheHas(){if(Ti)return Ci;Ti=1;var e=require_assocIndexOf();
/**
	 * Checks if a list cache value for `key` exists.
	 *
	 * @private
	 * @name has
	 * @memberOf ListCache
	 * @param {string} key The key of the entry to check.
	 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
	 */function listCacheHas(t){return e(this.__data__,t)>-1}Ci=listCacheHas;return Ci}var Si;var ki;function require_listCacheSet(){if(ki)return Si;ki=1;var e=require_assocIndexOf();
/**
	 * Sets the list cache `key` to `value`.
	 *
	 * @private
	 * @name set
	 * @memberOf ListCache
	 * @param {string} key The key of the value to set.
	 * @param {*} value The value to set.
	 * @returns {Object} Returns the list cache instance.
	 */function listCacheSet(t,a){var n=this.__data__,i=e(n,t);if(i<0){++this.size;n.push([t,a])}else n[i][1]=a;return this}Si=listCacheSet;return Si}var Pi;var _i;function require_ListCache(){if(_i)return Pi;_i=1;var e=require_listCacheClear(),t=require_listCacheDelete(),a=require_listCacheGet(),n=require_listCacheHas(),i=require_listCacheSet();
/**
	 * Creates an list cache object.
	 *
	 * @private
	 * @constructor
	 * @param {Array} [entries] The key-value pairs to cache.
	 */function ListCache(e){var t=-1,a=e==null?0:e.length;this.clear();while(++t<a){var n=e[t];this.set(n[0],n[1])}}ListCache.prototype.clear=e;ListCache.prototype.delete=t;ListCache.prototype.get=a;ListCache.prototype.has=n;ListCache.prototype.set=i;Pi=ListCache;return Pi}var Di;var Ai;function require_Map(){if(Ai)return Di;Ai=1;var e=require_getNative(),t=require_root();var a=e(t,"Map");Di=a;return Di}var Bi;var Ii;function require_mapCacheClear(){if(Ii)return Bi;Ii=1;var e=require_Hash(),t=require_ListCache(),a=require_Map();function mapCacheClear(){this.size=0;this.__data__={hash:new e,map:new(a||t),string:new e}}Bi=mapCacheClear;return Bi}
/**
 * Checks if `value` is suitable for use as unique object key.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is suitable, else `false`.
 */var Mi;var Ri;function require_isKeyable(){if(Ri)return Mi;Ri=1;function isKeyable(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}Mi=isKeyable;return Mi}var Li;var Ni;function require_getMapData(){if(Ni)return Li;Ni=1;var e=require_isKeyable();
/**
	 * Gets the data for `map`.
	 *
	 * @private
	 * @param {Object} map The map to query.
	 * @param {string} key The reference key.
	 * @returns {*} Returns the map data.
	 */function getMapData(t,a){var n=t.__data__;return e(a)?n[typeof a=="string"?"string":"hash"]:n.map}Li=getMapData;return Li}var Oi;var Fi;function require_mapCacheDelete(){if(Fi)return Oi;Fi=1;var e=require_getMapData();
/**
	 * Removes `key` and its value from the map.
	 *
	 * @private
	 * @name delete
	 * @memberOf MapCache
	 * @param {string} key The key of the value to remove.
	 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
	 */function mapCacheDelete(t){var a=e(this,t).delete(t);this.size-=a?1:0;return a}Oi=mapCacheDelete;return Oi}var zi;var Vi;function require_mapCacheGet(){if(Vi)return zi;Vi=1;var e=require_getMapData();
/**
	 * Gets the map value for `key`.
	 *
	 * @private
	 * @name get
	 * @memberOf MapCache
	 * @param {string} key The key of the value to get.
	 * @returns {*} Returns the entry value.
	 */function mapCacheGet(t){return e(this,t).get(t)}zi=mapCacheGet;return zi}var qi;var ji;function require_mapCacheHas(){if(ji)return qi;ji=1;var e=require_getMapData();
/**
	 * Checks if a map value for `key` exists.
	 *
	 * @private
	 * @name has
	 * @memberOf MapCache
	 * @param {string} key The key of the entry to check.
	 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
	 */function mapCacheHas(t){return e(this,t).has(t)}qi=mapCacheHas;return qi}var Hi;var Wi;function require_mapCacheSet(){if(Wi)return Hi;Wi=1;var e=require_getMapData();
/**
	 * Sets the map `key` to `value`.
	 *
	 * @private
	 * @name set
	 * @memberOf MapCache
	 * @param {string} key The key of the value to set.
	 * @param {*} value The value to set.
	 * @returns {Object} Returns the map cache instance.
	 */function mapCacheSet(t,a){var n=e(this,t),i=n.size;n.set(t,a);this.size+=n.size==i?0:1;return this}Hi=mapCacheSet;return Hi}var Xi;var Yi;function require_MapCache(){if(Yi)return Xi;Yi=1;var e=require_mapCacheClear(),t=require_mapCacheDelete(),a=require_mapCacheGet(),n=require_mapCacheHas(),i=require_mapCacheSet();
/**
	 * Creates a map cache object to store key-value pairs.
	 *
	 * @private
	 * @constructor
	 * @param {Array} [entries] The key-value pairs to cache.
	 */function MapCache(e){var t=-1,a=e==null?0:e.length;this.clear();while(++t<a){var n=e[t];this.set(n[0],n[1])}}MapCache.prototype.clear=e;MapCache.prototype.delete=t;MapCache.prototype.get=a;MapCache.prototype.has=n;MapCache.prototype.set=i;Xi=MapCache;return Xi}var Gi;var Ki;function requireMemoize(){if(Ki)return Gi;Ki=1;var e=require_MapCache();var t="Expected a function";
/**
	 * Creates a function that memoizes the result of `func`. If `resolver` is
	 * provided, it determines the cache key for storing the result based on the
	 * arguments provided to the memoized function. By default, the first argument
	 * provided to the memoized function is used as the map cache key. The `func`
	 * is invoked with the `this` binding of the memoized function.
	 *
	 * **Note:** The cache is exposed as the `cache` property on the memoized
	 * function. Its creation may be customized by replacing the `_.memoize.Cache`
	 * constructor with one whose instances implement the
	 * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)
	 * method interface of `clear`, `delete`, `get`, `has`, and `set`.
	 *
	 * @static
	 * @memberOf _
	 * @since 0.1.0
	 * @category Function
	 * @param {Function} func The function to have its output memoized.
	 * @param {Function} [resolver] The function to resolve the cache key.
	 * @returns {Function} Returns the new memoized function.
	 * @example
	 *
	 * var object = { 'a': 1, 'b': 2 };
	 * var other = { 'c': 3, 'd': 4 };
	 *
	 * var values = _.memoize(_.values);
	 * values(object);
	 * // => [1, 2]
	 *
	 * values(other);
	 * // => [3, 4]
	 *
	 * object.a = 2;
	 * values(object);
	 * // => [1, 2]
	 *
	 * // Modify the result cache.
	 * values.cache.set(object, ['a', 'b']);
	 * values(object);
	 * // => ['a', 'b']
	 *
	 * // Replace `_.memoize.Cache`.
	 * _.memoize.Cache = WeakMap;
	 */function memoize(a,n){if(typeof a!="function"||n!=null&&typeof n!="function")throw new TypeError(t);var memoized=function(){var e=arguments,t=n?n.apply(this,e):e[0],i=memoized.cache;if(i.has(t))return i.get(t);var o=a.apply(this,e);memoized.cache=i.set(t,o)||i;return o};memoized.cache=new(memoize.Cache||e);return memoized}memoize.Cache=e;Gi=memoize;return Gi}var Ui;var Zi;function require_memoizeCapped(){if(Zi)return Ui;Zi=1;var e=requireMemoize();var t=500;
/**
	 * A specialized version of `_.memoize` which clears the memoized function's
	 * cache when it exceeds `MAX_MEMOIZE_SIZE`.
	 *
	 * @private
	 * @param {Function} func The function to have its output memoized.
	 * @returns {Function} Returns the new memoized function.
	 */function memoizeCapped(a){var n=e(a,(function(e){i.size===t&&i.clear();return e}));var i=n.cache;return n}Ui=memoizeCapped;return Ui}var $i;var Qi;function require_stringToPath(){if(Qi)return $i;Qi=1;var e=require_memoizeCapped();var t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var a=/\\(\\)?/g;
/**
	 * Converts `string` to a property path array.
	 *
	 * @private
	 * @param {string} string The string to convert.
	 * @returns {Array} Returns the property path array.
	 */var n=e((function(e){var n=[];e.charCodeAt(0)===46&&n.push("");e.replace(t,(function(e,t,i,o){n.push(i?o.replace(a,"$1"):t||e)}));return n}));$i=n;return $i}
/**
 * A specialized version of `_.map` for arrays without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the new mapped array.
 */var Ji;var eo;function require_arrayMap(){if(eo)return Ji;eo=1;function arrayMap(e,t){var a=-1,n=e==null?0:e.length,i=Array(n);while(++a<n)i[a]=t(e[a],a,e);return i}Ji=arrayMap;return Ji}var to;var ro;function require_baseToString(){if(ro)return to;ro=1;var e=require_Symbol(),t=require_arrayMap(),a=requireIsArray(),n=requireIsSymbol();var i=e?e.prototype:void 0,o=i?i.toString:void 0;
/**
	 * The base implementation of `_.toString` which doesn't convert nullish
	 * values to empty strings.
	 *
	 * @private
	 * @param {*} value The value to process.
	 * @returns {string} Returns the string.
	 */function baseToString(e){if(typeof e=="string")return e;if(a(e))return t(e,baseToString)+"";if(n(e))return o?o.call(e):"";var i=e+"";return i=="0"&&1/e==-Infinity?"-0":i}to=baseToString;return to}var ao;var no;function requireToString(){if(no)return ao;no=1;var e=require_baseToString();
/**
	 * Converts `value` to a string. An empty string is returned for `null`
	 * and `undefined` values. The sign of `-0` is preserved.
	 *
	 * @static
	 * @memberOf _
	 * @since 4.0.0
	 * @category Lang
	 * @param {*} value The value to convert.
	 * @returns {string} Returns the converted string.
	 * @example
	 *
	 * _.toString(null);
	 * // => ''
	 *
	 * _.toString(-0);
	 * // => '-0'
	 *
	 * _.toString([1, 2, 3]);
	 * // => '1,2,3'
	 */function toString(t){return t==null?"":e(t)}ao=toString;return ao}var io;var oo;function require_castPath(){if(oo)return io;oo=1;var e=requireIsArray(),t=require_isKey(),a=require_stringToPath(),n=requireToString();
/**
	 * Casts `value` to a path array if it's not one.
	 *
	 * @private
	 * @param {*} value The value to inspect.
	 * @param {Object} [object] The object to query keys on.
	 * @returns {Array} Returns the cast property path array.
	 */function castPath(i,o){return e(i)?i:t(i,o)?[i]:a(n(i))}io=castPath;return io}var so;var lo;function require_toKey(){if(lo)return so;lo=1;var e=requireIsSymbol();
/**
	 * Converts `value` to a string key if it's not a string or symbol.
	 *
	 * @private
	 * @param {*} value The value to inspect.
	 * @returns {string|symbol} Returns the key.
	 */function toKey(t){if(typeof t=="string"||e(t))return t;var a=t+"";return a=="0"&&1/t==-Infinity?"-0":a}so=toKey;return so}var uo;var vo;function require_baseGet(){if(vo)return uo;vo=1;var e=require_castPath(),t=require_toKey();
/**
	 * The base implementation of `_.get` without support for default values.
	 *
	 * @private
	 * @param {Object} object The object to query.
	 * @param {Array|string} path The path of the property to get.
	 * @returns {*} Returns the resolved value.
	 */function baseGet(a,n){n=e(n,a);var i=0,o=n.length;while(a!=null&&i<o)a=a[t(n[i++])];return i&&i==o?a:void 0}uo=baseGet;return uo}var co;var ho;function requireGet(){if(ho)return co;ho=1;var e=require_baseGet();
/**
	 * Gets the value at `path` of `object`. If the resolved value is
	 * `undefined`, the `defaultValue` is returned in its place.
	 *
	 * @static
	 * @memberOf _
	 * @since 3.7.0
	 * @category Object
	 * @param {Object} object The object to query.
	 * @param {Array|string} path The path of the property to get.
	 * @param {*} [defaultValue] The value returned for `undefined` resolved values.
	 * @returns {*} Returns the resolved value.
	 * @example
	 *
	 * var object = { 'a': [{ 'b': { 'c': 3 } }] };
	 *
	 * _.get(object, 'a[0].b.c');
	 * // => 3
	 *
	 * _.get(object, ['a', '0', 'b', 'c']);
	 * // => 3
	 *
	 * _.get(object, 'a.b.c', 'default');
	 * // => 'default'
	 */function get(t,a,n){var i=t==null?void 0:e(t,a);return i===void 0?n:i}co=get;return co}var fo=requireGet();var po=getDefaultExportFromCjs(fo);var go;var yo;function require_defineProperty(){if(yo)return go;yo=1;var e=require_getNative();var t=function(){try{var t=e(Object,"defineProperty");t({},"",{});return t}catch(e){}}();go=t;return go}var mo;var bo;function require_baseAssignValue(){if(bo)return mo;bo=1;var e=require_defineProperty();
/**
	 * The base implementation of `assignValue` and `assignMergeValue` without
	 * value checks.
	 *
	 * @private
	 * @param {Object} object The object to modify.
	 * @param {string} key The key of the property to assign.
	 * @param {*} value The value to assign.
	 */function baseAssignValue(t,a,n){a=="__proto__"&&e?e(t,a,{configurable:true,enumerable:true,value:n,writable:true}):t[a]=n}mo=baseAssignValue;return mo}var xo;var wo;function require_assignValue(){if(wo)return xo;wo=1;var e=require_baseAssignValue(),t=requireEq();var a=Object.prototype;var n=a.hasOwnProperty;
/**
	 * Assigns `value` to `key` of `object` if the existing value is not equivalent
	 * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
	 * for equality comparisons.
	 *
	 * @private
	 * @param {Object} object The object to modify.
	 * @param {string} key The key of the property to assign.
	 * @param {*} value The value to assign.
	 */function assignValue(a,i,o){var s=a[i];n.call(a,i)&&t(s,o)&&(o!==void 0||i in a)||e(a,i,o)}xo=assignValue;return xo}var Eo;var Co;function require_isIndex(){if(Co)return Eo;Co=1;var e=9007199254740991;var t=/^(?:0|[1-9]\d*)$/;
/**
	 * Checks if `value` is a valid array-like index.
	 *
	 * @private
	 * @param {*} value The value to check.
	 * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
	 * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
	 */function isIndex(a,n){var i=typeof a;n=n==null?e:n;return!!n&&(i=="number"||i!="symbol"&&t.test(a))&&a>-1&&a%1==0&&a<n}Eo=isIndex;return Eo}var To;var So;function require_baseSet(){if(So)return To;So=1;var e=require_assignValue(),t=require_castPath(),a=require_isIndex(),n=requireIsObject(),i=require_toKey();
/**
	 * The base implementation of `_.set`.
	 *
	 * @private
	 * @param {Object} object The object to modify.
	 * @param {Array|string} path The path of the property to set.
	 * @param {*} value The value to set.
	 * @param {Function} [customizer] The function to customize path creation.
	 * @returns {Object} Returns `object`.
	 */function baseSet(o,s,l,u){if(!n(o))return o;s=t(s,o);var v=-1,c=s.length,d=c-1,h=o;while(h!=null&&++v<c){var p=i(s[v]),g=l;if(p==="__proto__"||p==="constructor"||p==="prototype")return o;if(v!=d){var y=h[p];g=u?u(y,p,h):void 0;g===void 0&&(g=n(y)?y:a(s[v+1])?[]:{})}e(h,p,g);h=h[p]}return o}To=baseSet;return To}var ko;var Po;function requireSet(){if(Po)return ko;Po=1;var e=require_baseSet();
/**
	 * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,
	 * it's created. Arrays are created for missing index properties while objects
	 * are created for all other missing properties. Use `_.setWith` to customize
	 * `path` creation.
	 *
	 * **Note:** This method mutates `object`.
	 *
	 * @static
	 * @memberOf _
	 * @since 3.7.0
	 * @category Object
	 * @param {Object} object The object to modify.
	 * @param {Array|string} path The path of the property to set.
	 * @param {*} value The value to set.
	 * @returns {Object} Returns `object`.
	 * @example
	 *
	 * var object = { 'a': [{ 'b': { 'c': 3 } }] };
	 *
	 * _.set(object, 'a[0].b.c', 4);
	 * console.log(object.a[0].b.c);
	 * // => 4
	 *
	 * _.set(object, ['x', '0', 'y', 'z'], 5);
	 * console.log(object.x[0].y.z);
	 * // => 5
	 */function set(t,a,n){return t==null?t:e(t,a,n)}ko=set;return ko}var _o=requireSet();var Do=getDefaultExportFromCjs(_o);
/**
 * Copies the values of `source` to `array`.
 *
 * @private
 * @param {Array} source The array to copy values from.
 * @param {Array} [array=[]] The array to copy values to.
 * @returns {Array} Returns `array`.
 */var Ao;var Bo;function require_copyArray(){if(Bo)return Ao;Bo=1;function copyArray(e,t){var a=-1,n=e.length;t||(t=Array(n));while(++a<n)t[a]=e[a];return t}Ao=copyArray;return Ao}var Io;var Mo;function requireToPath(){if(Mo)return Io;Mo=1;var e=require_arrayMap(),t=require_copyArray(),a=requireIsArray(),n=requireIsSymbol(),i=require_stringToPath(),o=require_toKey(),s=requireToString();
/**
	 * Converts `value` to a property path array.
	 *
	 * @static
	 * @memberOf _
	 * @since 4.0.0
	 * @category Util
	 * @param {*} value The value to convert.
	 * @returns {Array} Returns the new property path array.
	 * @example
	 *
	 * _.toPath('a.b.c');
	 * // => ['a', 'b', 'c']
	 *
	 * _.toPath('a[0].b.c');
	 * // => ['a', '0', 'b', 'c']
	 */function toPath(l){return a(l)?e(l,o):n(l)?[l]:t(i(s(l)))}Io=toPath;return Io}var Ro=requireToPath();var Lo=getDefaultExportFromCjs(Ro);var No={data:function data(e){var t={field:"data",bindingEvent:"data",allowBinding:false,allowSetting:false,allowGetting:false,settingEvent:"data",settingTriggersEvent:false,triggerFnName:"trigger",immutableKeys:{},updateStyle:false,beforeGet:function beforeGet(e){},beforeSet:function beforeSet(e,t){},onSet:function onSet(e){},canSet:function canSet(e){return true}};e=Y({},t,e);return function dataImpl(t,a){var n=e;var i=this;var o=i.length!==void 0;var s=o?i:[i];var v=o?i[0]:i;if(l(t)){var d=t.indexOf(".")!==-1;var h=d&&Lo(t);if(n.allowGetting&&a===void 0){var p;if(v){n.beforeGet(v);p=h&&v._private[n.field][t]===void 0?po(v._private[n.field],h):v._private[n.field][t]}return p}if(n.allowSetting&&a!==void 0){var g=!n.immutableKeys[t];if(g){var y=_defineProperty$1({},t,a);n.beforeSet(i,y);for(var m=0,b=s.length;m<b;m++){var x=s[m];n.canSet(x)&&(h&&v._private[n.field][t]===void 0?Do(x._private[n.field],h,a):x._private[n.field][t]=a)}n.updateStyle&&i.updateStyle();n.onSet(i);n.settingTriggersEvent&&i[n.triggerFnName](n.settingEvent)}}}else if(n.allowSetting&&c(t)){var w=t;var E,T;var S=Object.keys(w);n.beforeSet(i,w);for(var k=0;k<S.length;k++){E=S[k];T=w[E];var P=!n.immutableKeys[E];if(P)for(var _=0;_<s.length;_++){var D=s[_];n.canSet(D)&&(D._private[n.field][E]=T)}}n.updateStyle&&i.updateStyle();n.onSet(i);n.settingTriggersEvent&&i[n.triggerFnName](n.settingEvent)}else if(n.allowBinding&&u(t)){var I=t;i.on(n.bindingEvent,I)}else if(n.allowGetting&&t===void 0){var M;if(v){n.beforeGet(v);M=v._private[n.field]}return M}return i}},removeData:function removeData(e){var t={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:false,immutableKeys:{}};e=Y({},t,e);return function removeDataImpl(t){var a=e;var n=this;var i=n.length!==void 0;var o=i?n:[n];if(l(t)){var s=t.split(/\s+/);var u=s.length;for(var v=0;v<u;v++){var c=s[v];if(!T(c)){var d=!a.immutableKeys[c];if(d)for(var h=0,p=o.length;h<p;h++)o[h]._private[a.field][c]=void 0}}a.triggerEvent&&n[a.triggerFnName](a.event)}else if(t===void 0){for(var g=0,y=o.length;g<y;g++){var m=o[g]._private[a.field];var b=Object.keys(m);for(var x=0;x<b.length;x++){var w=b[x];var E=!a.immutableKeys[w];E&&(m[w]=void 0)}}a.triggerEvent&&n[a.triggerFnName](a.event)}return n}}};var Oo={eventAliasesOn:function eventAliasesOn(e){var t=e;t.addListener=t.listen=t.bind=t.on;t.unlisten=t.unbind=t.off=t.removeListener;t.trigger=t.emit;t.pon=t.promiseOn=function(e,t){var a=this;var n=Array.prototype.slice.call(arguments,0);return new Bn((function(e,t){var i=function callback(t){a.off.apply(a,s);e(t)};var o=n.concat([i]);var s=o.concat([]);a.on.apply(a,o)}))}}};var Fo={};[Rn,No,Oo].forEach((function(e){Y(Fo,e)}));var zo={animate:Fo.animate(),animation:Fo.animation(),animated:Fo.animated(),clearQueue:Fo.clearQueue(),delay:Fo.delay(),delayAnimation:Fo.delayAnimation(),stop:Fo.stop()};var Vo={classes:function classes(e){var t=this;if(e===void 0){var a=[];t[0]._private.classes.forEach((function(e){return a.push(e)}));return a}v(e)||(e=(e||"").match(/\S+/g)||[]);var n=[];var i=new Tt(e);for(var o=0;o<t.length;o++){var s=t[o];var l=s._private;var u=l.classes;var c=false;for(var d=0;d<e.length;d++){var h=e[d];var p=u.has(h);if(!p){c=true;break}}c||(c=u.size!==e.length);if(c){l.classes=i;n.push(s)}}n.length>0&&this.spawn(n).updateStyle().emit("class");return t},addClass:function addClass(e){return this.toggleClass(e,true)},hasClass:function hasClass(e){var t=this[0];return t!=null&&t._private.classes.has(e)},toggleClass:function toggleClass(e,t){v(e)||(e=e.match(/\S+/g)||[]);var a=this;var n=t===void 0;var i=[];for(var o=0,s=a.length;o<s;o++){var l=a[o];var u=l._private.classes;var c=false;for(var d=0;d<e.length;d++){var h=e[d];var p=u.has(h);var g=false;if(t||n&&!p){u.add(h);g=true}else if(!t||n&&p){u.delete(h);g=true}if(!c&&g){i.push(l);c=true}}}i.length>0&&this.spawn(i).updateStyle().emit("class");return a},removeClass:function removeClass(e){return this.toggleClass(e,false)},flashClass:function flashClass(e,t){var a=this;if(t==null)t=250;else if(t===0)return a;a.addClass(e);setTimeout((function(){a.removeClass(e)}),t);return a}};Vo.className=Vo.classNames=Vo.classes;var qo={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:"\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'",number:N,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};qo.variable="(?:[\\w-.]|(?:\\\\"+qo.metaChar+"))+";qo.className="(?:[\\w-]|(?:\\\\"+qo.metaChar+"))+";qo.value=qo.string+"|"+qo.number;qo.id=qo.variable;(function(){var e,t,a;e=qo.comparatorOp.split("|");for(a=0;a<e.length;a++){t=e[a];qo.comparatorOp+="|@"+t}e=qo.comparatorOp.split("|");for(a=0;a<e.length;a++){t=e[a];t.indexOf("!")>=0||t!=="="&&(qo.comparatorOp+="|\\!"+t)}})();var jo=function newQuery(){return{checks:[]}};var Ho={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20};var Wo=[{selector:":selected",matches:function matches(e){return e.selected()}},{selector:":unselected",matches:function matches(e){return!e.selected()}},{selector:":selectable",matches:function matches(e){return e.selectable()}},{selector:":unselectable",matches:function matches(e){return!e.selectable()}},{selector:":locked",matches:function matches(e){return e.locked()}},{selector:":unlocked",matches:function matches(e){return!e.locked()}},{selector:":visible",matches:function matches(e){return e.visible()}},{selector:":hidden",matches:function matches(e){return!e.visible()}},{selector:":transparent",matches:function matches(e){return e.transparent()}},{selector:":grabbed",matches:function matches(e){return e.grabbed()}},{selector:":free",matches:function matches(e){return!e.grabbed()}},{selector:":removed",matches:function matches(e){return e.removed()}},{selector:":inside",matches:function matches(e){return!e.removed()}},{selector:":grabbable",matches:function matches(e){return e.grabbable()}},{selector:":ungrabbable",matches:function matches(e){return!e.grabbable()}},{selector:":animated",matches:function matches(e){return e.animated()}},{selector:":unanimated",matches:function matches(e){return!e.animated()}},{selector:":parent",matches:function matches(e){return e.isParent()}},{selector:":childless",matches:function matches(e){return e.isChildless()}},{selector:":child",matches:function matches(e){return e.isChild()}},{selector:":orphan",matches:function matches(e){return e.isOrphan()}},{selector:":nonorphan",matches:function matches(e){return e.isChild()}},{selector:":compound",matches:function matches(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function matches(e){return e.isLoop()}},{selector:":simple",matches:function matches(e){return e.isSimple()}},{selector:":active",matches:function matches(e){return e.active()}},{selector:":inactive",matches:function matches(e){return!e.active()}},{selector:":backgrounding",matches:function matches(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function matches(e){return!e.backgrounding()}}].sort((function(e,t){return X(e.selector,t.selector)}));var Xo=function(){var e={};var t;for(var a=0;a<Wo.length;a++){t=Wo[a];e[t.selector]=t.matches}return e}();var Yo=function stateSelectorMatches(e,t){return Xo[e](t)};var Go="("+Wo.map((function(e){return e.selector})).join("|")+")";var Ko=function cleanMetaChars(e){return e.replace(new RegExp("\\\\("+qo.metaChar+")","g"),(function(e,t){return t}))};var Uo=function replaceLastQuery(e,t,a){e[e.length-1]=a};var Zo=[{name:"group",query:true,regex:"("+qo.group+")",populate:function populate(e,t,a){var n=_slicedToArray(a,1),i=n[0];t.checks.push({type:Ho.GROUP,value:i==="*"?i:i+"s"})}},{name:"state",query:true,regex:Go,populate:function populate(e,t,a){var n=_slicedToArray(a,1),i=n[0];t.checks.push({type:Ho.STATE,value:i})}},{name:"id",query:true,regex:"\\#("+qo.id+")",populate:function populate(e,t,a){var n=_slicedToArray(a,1),i=n[0];t.checks.push({type:Ho.ID,value:Ko(i)})}},{name:"className",query:true,regex:"\\.("+qo.className+")",populate:function populate(e,t,a){var n=_slicedToArray(a,1),i=n[0];t.checks.push({type:Ho.CLASS,value:Ko(i)})}},{name:"dataExists",query:true,regex:"\\[\\s*("+qo.variable+")\\s*\\]",populate:function populate(e,t,a){var n=_slicedToArray(a,1),i=n[0];t.checks.push({type:Ho.DATA_EXIST,field:Ko(i)})}},{name:"dataCompare",query:true,regex:"\\[\\s*("+qo.variable+")\\s*("+qo.comparatorOp+")\\s*("+qo.value+")\\s*\\]",populate:function populate(e,t,a){var n=_slicedToArray(a,3),i=n[0],o=n[1],s=n[2];var l=new RegExp("^"+qo.string+"$").exec(s)!=null;s=l?s.substring(1,s.length-1):parseFloat(s);t.checks.push({type:Ho.DATA_COMPARE,field:Ko(i),operator:o,value:s})}},{name:"dataBool",query:true,regex:"\\[\\s*("+qo.boolOp+")\\s*("+qo.variable+")\\s*\\]",populate:function populate(e,t,a){var n=_slicedToArray(a,2),i=n[0],o=n[1];t.checks.push({type:Ho.DATA_BOOL,field:Ko(o),operator:i})}},{name:"metaCompare",query:true,regex:"\\[\\[\\s*("+qo.meta+")\\s*("+qo.comparatorOp+")\\s*("+qo.number+")\\s*\\]\\]",populate:function populate(e,t,a){var n=_slicedToArray(a,3),i=n[0],o=n[1],s=n[2];t.checks.push({type:Ho.META_COMPARE,field:Ko(i),operator:o,value:parseFloat(s)})}},{name:"nextQuery",separator:true,regex:qo.separator,populate:function populate(e,t){var a=e.currentSubject;var n=e.edgeCount;var i=e.compoundCount;var o=e[e.length-1];if(a!=null){o.subject=a;e.currentSubject=null}o.edgeCount=n;o.compoundCount=i;e.edgeCount=0;e.compoundCount=0;var s=e[e.length++]=jo();return s}},{name:"directedEdge",separator:true,regex:qo.directedEdge,populate:function populate(e,t){if(e.currentSubject==null){var a=jo();var n=t;var i=jo();a.checks.push({type:Ho.DIRECTED_EDGE,source:n,target:i});Uo(e,t,a);e.edgeCount++;return i}var o=jo();var s=t;var l=jo();o.checks.push({type:Ho.NODE_SOURCE,source:s,target:l});Uo(e,t,o);e.edgeCount++;return l}},{name:"undirectedEdge",separator:true,regex:qo.undirectedEdge,populate:function populate(e,t){if(e.currentSubject==null){var a=jo();var n=t;var i=jo();a.checks.push({type:Ho.UNDIRECTED_EDGE,nodes:[n,i]});Uo(e,t,a);e.edgeCount++;return i}var o=jo();var s=t;var l=jo();o.checks.push({type:Ho.NODE_NEIGHBOR,node:s,neighbor:l});Uo(e,t,o);return l}},{name:"child",separator:true,regex:qo.child,populate:function populate(e,t){if(e.currentSubject==null){var a=jo();var n=jo();var i=e[e.length-1];a.checks.push({type:Ho.CHILD,parent:i,child:n});Uo(e,t,a);e.compoundCount++;return n}if(e.currentSubject===t){var o=jo();var s=e[e.length-1];var l=jo();var u=jo();var v=jo();var c=jo();o.checks.push({type:Ho.COMPOUND_SPLIT,left:s,right:l,subject:u});u.checks=t.checks;t.checks=[{type:Ho.TRUE}];c.checks.push({type:Ho.TRUE});l.checks.push({type:Ho.PARENT,parent:c,child:v});Uo(e,s,o);e.currentSubject=u;e.compoundCount++;return v}var d=jo();var h=jo();var p=[{type:Ho.PARENT,parent:d,child:h}];d.checks=t.checks;t.checks=p;e.compoundCount++;return h}},{name:"descendant",separator:true,regex:qo.descendant,populate:function populate(e,t){if(e.currentSubject==null){var a=jo();var n=jo();var i=e[e.length-1];a.checks.push({type:Ho.DESCENDANT,ancestor:i,descendant:n});Uo(e,t,a);e.compoundCount++;return n}if(e.currentSubject===t){var o=jo();var s=e[e.length-1];var l=jo();var u=jo();var v=jo();var c=jo();o.checks.push({type:Ho.COMPOUND_SPLIT,left:s,right:l,subject:u});u.checks=t.checks;t.checks=[{type:Ho.TRUE}];c.checks.push({type:Ho.TRUE});l.checks.push({type:Ho.ANCESTOR,ancestor:c,descendant:v});Uo(e,s,o);e.currentSubject=u;e.compoundCount++;return v}var d=jo();var h=jo();var p=[{type:Ho.ANCESTOR,ancestor:d,descendant:h}];d.checks=t.checks;t.checks=p;e.compoundCount++;return h}},{name:"subject",modifier:true,regex:qo.subject,populate:function populate(e,t){if(e.currentSubject!=null&&e.currentSubject!==t){st("Redefinition of subject in selector `"+e.toString()+"`");return false}e.currentSubject=t;var a=e[e.length-1];var n=a.checks[0];var i=n==null?null:n.type;if(i===Ho.DIRECTED_EDGE)n.type=Ho.NODE_TARGET;else if(i===Ho.UNDIRECTED_EDGE){n.type=Ho.NODE_NEIGHBOR;n.node=n.nodes[1];n.neighbor=n.nodes[0];n.nodes=null}}}];Zo.forEach((function(e){return e.regexObj=new RegExp("^"+e.regex)}));
/**
 * Of all the expressions, find the first match in the remaining text.
 * @param {string} remaining The remaining text to parse
 * @returns The matched expression and the newly remaining text `{ expr, match, name, remaining }`
 */var $o=function consumeExpr(e){var t;var a;var n;for(var i=0;i<Zo.length;i++){var o=Zo[i];var s=o.name;var l=e.match(o.regexObj);if(l!=null){a=l;t=o;n=s;var u=l[0];e=e.substring(u.length);break}}return{expr:t,match:a,name:n,remaining:e}};
/**
 * Consume all the leading whitespace
 * @param {string} remaining The text to consume
 * @returns The text with the leading whitespace removed
 */var Qo=function consumeWhitespace(e){var t=e.match(/^\s+/);if(t){var a=t[0];e=e.substring(a.length)}return e};
/**
 * Parse the string and store the parsed representation in the Selector.
 * @param {string} selector The selector string
 * @returns `true` if the selector was successfully parsed, `false` otherwise
 */var Jo=function parse(e){var t=this;var a=t.inputText=e;var n=t[0]=jo();t.length=1;a=Qo(a);for(;;){var i=$o(a);if(i.expr==null){st("The selector `"+e+"`is invalid");return false}var o=i.match.slice(1);var s=i.expr.populate(t,n,o);if(s===false)return false;s!=null&&(n=s);a=i.remaining;if(a.match(/^\s*$/))break}var l=t[t.length-1];t.currentSubject!=null&&(l.subject=t.currentSubject);l.edgeCount=t.edgeCount;l.compoundCount=t.compoundCount;for(var u=0;u<t.length;u++){var v=t[u];if(v.compoundCount>0&&v.edgeCount>0){st("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector");return false}if(v.edgeCount>1){st("The selector `"+e+"` is invalid because it uses multiple edge selectors");return false}v.edgeCount===1&&st("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return true};
/**
 * Get the selector represented as a string.  This value uses default formatting,
 * so things like spacing may differ from the input text passed to the constructor.
 * @returns {string} The selector string
 */var es=function toString(){if(this.toStringCache!=null)return this.toStringCache;var e=function clean(e){return e==null?"":e};var t=function cleanVal(t){return l(t)?'"'+t+'"':e(t)};var a=function space(e){return" "+e+" "};var n=function checkToString(n,o){var s=n.type,l=n.value;switch(s){case Ho.GROUP:var u=e(l);return u.substring(0,u.length-1);case Ho.DATA_COMPARE:var v=n.field,c=n.operator;return"["+v+a(e(c))+t(l)+"]";case Ho.DATA_BOOL:var d=n.operator,h=n.field;return"["+e(d)+h+"]";case Ho.DATA_EXIST:var p=n.field;return"["+p+"]";case Ho.META_COMPARE:var g=n.operator,y=n.field;return"[["+y+a(e(g))+t(l)+"]]";case Ho.STATE:return l;case Ho.ID:return"#"+l;case Ho.CLASS:return"."+l;case Ho.PARENT:case Ho.CHILD:return i(n.parent,o)+a(">")+i(n.child,o);case Ho.ANCESTOR:case Ho.DESCENDANT:return i(n.ancestor,o)+" "+i(n.descendant,o);case Ho.COMPOUND_SPLIT:var m=i(n.left,o);var b=i(n.subject,o);var x=i(n.right,o);return m+(m.length>0?" ":"")+b+x;case Ho.TRUE:return""}};var i=function queryToString(e,t){return e.checks.reduce((function(a,i,o){return a+(t===e&&o===0?"$":"")+n(i,t)}),"")};var o="";for(var s=0;s<this.length;s++){var u=this[s];o+=i(u,u.subject);this.length>1&&s<this.length-1&&(o+=", ")}this.toStringCache=o;return o};var ts={parse:Jo,toString:es};var rs=function valCmp(e,t,a){var n;var i=l(e);var o=h(e);var s=l(a);var u,v;var c=false;var d=false;var p=false;if(t.indexOf("!")>=0){t=t.replace("!","");d=true}if(t.indexOf("@")>=0){t=t.replace("@","");c=true}if(i||s||c){u=i||o?""+e:"";v=""+a}if(c){e=u=u.toLowerCase();a=v=v.toLowerCase()}switch(t){case"*=":n=u.indexOf(v)>=0;break;case"$=":n=u.indexOf(v,u.length-v.length)>=0;break;case"^=":n=u.indexOf(v)===0;break;case"=":n=e===a;break;case">":p=true;n=e>a;break;case">=":p=true;n=e>=a;break;case"<":p=true;n=e<a;break;case"<=":p=true;n=e<=a;break;default:n=false;break}!d||e==null&&p||(n=!n);return n};var as=function boolCmp(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return e===void 0}};var ns=function existCmp(e){return e!==void 0};var os=function data(e,t){return e.data(t)};var ss=function meta(e,t){return e[t]()};var ls=[];
/**
 * Returns whether the query matches for the element
 * @param query The `{ type, value, ... }` query object
 * @param ele The element to compare against
*/var us=function matches(e,t){return e.checks.every((function(e){return ls[e.type](e,t)}))};ls[Ho.GROUP]=function(e,t){var a=e.value;return a==="*"||a===t.group()};ls[Ho.STATE]=function(e,t){var a=e.value;return Yo(a,t)};ls[Ho.ID]=function(e,t){var a=e.value;return t.id()===a};ls[Ho.CLASS]=function(e,t){var a=e.value;return t.hasClass(a)};ls[Ho.META_COMPARE]=function(e,t){var a=e.field,n=e.operator,i=e.value;return rs(ss(t,a),n,i)};ls[Ho.DATA_COMPARE]=function(e,t){var a=e.field,n=e.operator,i=e.value;return rs(os(t,a),n,i)};ls[Ho.DATA_BOOL]=function(e,t){var a=e.field,n=e.operator;return as(os(t,a),n)};ls[Ho.DATA_EXIST]=function(e,t){var a=e.field;e.operator;return ns(os(t,a))};ls[Ho.UNDIRECTED_EDGE]=function(e,t){var a=e.nodes[0];var n=e.nodes[1];var i=t.source();var o=t.target();return us(a,i)&&us(n,o)||us(n,i)&&us(a,o)};ls[Ho.NODE_NEIGHBOR]=function(e,t){return us(e.node,t)&&t.neighborhood().some((function(t){return t.isNode()&&us(e.neighbor,t)}))};ls[Ho.DIRECTED_EDGE]=function(e,t){return us(e.source,t.source())&&us(e.target,t.target())};ls[Ho.NODE_SOURCE]=function(e,t){return us(e.source,t)&&t.outgoers().some((function(t){return t.isNode()&&us(e.target,t)}))};ls[Ho.NODE_TARGET]=function(e,t){return us(e.target,t)&&t.incomers().some((function(t){return t.isNode()&&us(e.source,t)}))};ls[Ho.CHILD]=function(e,t){return us(e.child,t)&&us(e.parent,t.parent())};ls[Ho.PARENT]=function(e,t){return us(e.parent,t)&&t.children().some((function(t){return us(e.child,t)}))};ls[Ho.DESCENDANT]=function(e,t){return us(e.descendant,t)&&t.ancestors().some((function(t){return us(e.ancestor,t)}))};ls[Ho.ANCESTOR]=function(e,t){return us(e.ancestor,t)&&t.descendants().some((function(t){return us(e.descendant,t)}))};ls[Ho.COMPOUND_SPLIT]=function(e,t){return us(e.subject,t)&&us(e.left,t)&&us(e.right,t)};ls[Ho.TRUE]=function(){return true};ls[Ho.COLLECTION]=function(e,t){var a=e.value;return a.has(t)};ls[Ho.FILTER]=function(e,t){var a=e.value;return a(t)};var vs=function filter(e){var t=this;if(t.length===1&&t[0].checks.length===1&&t[0].checks[0].type===Ho.ID)return e.getElementById(t[0].checks[0].value).collection();var a=function selectorFunction(e){for(var a=0;a<t.length;a++){var n=t[a];if(us(n,e))return true}return false};t.text()==null&&(a=function selectorFunction(){return true});return e.filter(a)};var cs=function matches(e){var t=this;for(var a=0;a<t.length;a++){var n=t[a];if(us(n,e))return true}return false};var ds={matches:cs,filter:vs};var hs=function Selector(e){this.inputText=e;this.currentSubject=null;this.compoundCount=0;this.edgeCount=0;this.length=0;e==null||l(e)&&e.match(/^\s*$/)||(y(e)?this.addQuery({checks:[{type:Ho.COLLECTION,value:e.collection()}]}):u(e)?this.addQuery({checks:[{type:Ho.FILTER,value:e}]}):l(e)?this.parse(e)||(this.invalid=true):it("A selector must be created from a string; found "))};var fs=hs.prototype;[ts,ds].forEach((function(e){return Y(fs,e)}));fs.text=function(){return this.inputText};fs.size=function(){return this.length};fs.eq=function(e){return this[e]};fs.sameText=function(e){return!this.invalid&&!e.invalid&&this.text()===e.text()};fs.addQuery=function(e){this[this.length++]=e};fs.selector=fs.toString;var ps={allAre:function allAre(e){var t=new hs(e);return this.every((function(e){return t.matches(e)}))},is:function is(e){var t=new hs(e);return this.some((function(e){return t.matches(e)}))},some:function some(e,t){for(var a=0;a<this.length;a++){var n=t?e.apply(t,[this[a],a,this]):e(this[a],a,this);if(n)return true}return false},every:function every(e,t){for(var a=0;a<this.length;a++){var n=t?e.apply(t,[this[a],a,this]):e(this[a],a,this);if(!n)return false}return true},same:function same(e){if(this===e)return true;e=this.cy().collection(e);var t=this.length;var a=e.length;return t===a&&(t===1?this[0]===e[0]:this.every((function(t){return e.hasElementWithId(t.id())})))},anySame:function anySame(e){e=this.cy().collection(e);return this.some((function(t){return e.hasElementWithId(t.id())}))},allAreNeighbors:function allAreNeighbors(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every((function(e){return t.hasElementWithId(e.id())}))},contains:function contains(e){e=this.cy().collection(e);var t=this;return e.every((function(e){return t.hasElementWithId(e.id())}))}};ps.allAreNeighbours=ps.allAreNeighbors;ps.has=ps.contains;ps.equal=ps.equals=ps.same;var gs=function cache(e,t){return function traversalCache(a,n,i,o){var s=a;var l=this;var u;s==null?u="":y(s)&&s.length===1&&(u=s.id());if(l.length===1&&u){var v=l[0]._private;var c=v.traversalCache=v.traversalCache||{};var d=c[t]=c[t]||[];var h=Ke(u);var p=d[h];return p||(d[h]=e.call(l,a,n,i,o))}return e.call(l,a,n,i,o)}};var ys={parent:function parent(e){var t=[];if(this.length===1){var parent=this[0]._private.parent;if(parent)return parent}for(var a=0;a<this.length;a++){var n=this[a];var i=n._private.parent;i&&t.push(i)}return this.spawn(t,true).filter(e)},parents:function parents(e){var parents=[];var t=this.parent();while(t.nonempty()){for(var a=0;a<t.length;a++){var n=t[a];parents.push(n)}t=t.parent()}return this.spawn(parents,true).filter(e)},commonAncestors:function commonAncestors(e){var t;for(var a=0;a<this.length;a++){var n=this[a];var i=n.parents();t=t||i;t=t.intersect(i)}return t.filter(e)},orphans:function orphans(e){return this.stdFilter((function(e){return e.isOrphan()})).filter(e)},nonorphans:function nonorphans(e){return this.stdFilter((function(e){return e.isChild()})).filter(e)},children:gs((function(e){var t=[];for(var a=0;a<this.length;a++){var n=this[a];var i=n._private.children;for(var o=0;o<i.length;o++)t.push(i[o])}return this.spawn(t,true).filter(e)}),"children"),siblings:function siblings(e){return this.parent().children().not(this).filter(e)},isParent:function isParent(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function isChildless(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function isChild(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function isOrphan(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function descendants(e){var t=[];function add(e){for(var a=0;a<e.length;a++){var n=e[a];t.push(n);n.children().nonempty()&&add(n.children())}}add(this.children());return this.spawn(t,true).filter(e)}};function forEachCompound(e,t,a,n){var i=[];var o=new Tt;var s=e.cy();var l=s.hasCompoundNodes();for(var u=0;u<e.length;u++){var v=e[u];a?i.push(v):l&&n(i,o,v)}while(i.length>0){var c=i.shift();t(c);o.add(c.id());l&&n(i,o,c)}return e}function addChildren(e,t,a){if(a.isParent()){var n=a._private.children;for(var i=0;i<n.length;i++){var o=n[i];t.has(o.id())||e.push(o)}}}ys.forEachDown=function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return forEachCompound(this,e,t,addChildren)};function addParent(e,t,a){if(a.isChild()){var n=a._private.parent;t.has(n.id())||e.push(n)}}ys.forEachUp=function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return forEachCompound(this,e,t,addParent)};function addParentAndChildren(e,t,a){addParent(e,t,a);addChildren(e,t,a)}ys.forEachUpAndDown=function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return forEachCompound(this,e,t,addParentAndChildren)};ys.ancestors=ys.parents;var bs,xs;bs=xs={data:Fo.data({field:"data",bindingEvent:"data",allowBinding:true,allowSetting:true,settingEvent:"data",settingTriggersEvent:true,triggerFnName:"trigger",allowGetting:true,immutableKeys:{id:true,source:true,target:true,parent:true},updateStyle:true}),removeData:Fo.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:true,immutableKeys:{id:true,source:true,target:true,parent:true},updateStyle:true}),scratch:Fo.data({field:"scratch",bindingEvent:"scratch",allowBinding:true,allowSetting:true,settingEvent:"scratch",settingTriggersEvent:true,triggerFnName:"trigger",allowGetting:true,updateStyle:true}),removeScratch:Fo.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:true,updateStyle:true}),rscratch:Fo.data({field:"rscratch",allowBinding:false,allowSetting:true,settingTriggersEvent:false,allowGetting:true}),removeRscratch:Fo.removeData({field:"rscratch",triggerEvent:false}),id:function id(){var e=this[0];if(e)return e._private.data.id}};bs.attr=bs.data;bs.removeAttr=bs.removeData;var ws=xs;var Es={};function defineDegreeFunction(e){return function(t){var a=this;t===void 0&&(t=true);if(a.length!==0&&a.isNode()&&!a.removed()){var n=0;var i=a[0];var o=i._private.edges;for(var s=0;s<o.length;s++){var l=o[s];!t&&l.isLoop()||(n+=e(i,l))}return n}}}Y(Es,{degree:defineDegreeFunction((function(e,t){return t.source().same(t.target())?2:1})),indegree:defineDegreeFunction((function(e,t){return t.target().same(e)?1:0})),outdegree:defineDegreeFunction((function(e,t){return t.source().same(e)?1:0}))});function defineDegreeBoundsFunction(e,t){return function(a){var n;var i=this.nodes();for(var o=0;o<i.length;o++){var s=i[o];var l=s[e](a);l===void 0||n!==void 0&&!t(l,n)||(n=l)}return n}}Y(Es,{minDegree:defineDegreeBoundsFunction("degree",(function(e,t){return e<t})),maxDegree:defineDegreeBoundsFunction("degree",(function(e,t){return e>t})),minIndegree:defineDegreeBoundsFunction("indegree",(function(e,t){return e<t})),maxIndegree:defineDegreeBoundsFunction("indegree",(function(e,t){return e>t})),minOutdegree:defineDegreeBoundsFunction("outdegree",(function(e,t){return e<t})),maxOutdegree:defineDegreeBoundsFunction("outdegree",(function(e,t){return e>t}))});Y(Es,{totalDegree:function totalDegree(e){var t=0;var a=this.nodes();for(var n=0;n<a.length;n++)t+=a[n].degree(e);return t}});var Cs,Ts;var Ss=function beforePositionSet(e,t,a){for(var n=0;n<e.length;n++){var i=e[n];if(!i.locked()){var o=i._private.position;var s={x:t.x!=null?t.x-o.x:0,y:t.y!=null?t.y-o.y:0};!i.isParent()||s.x===0&&s.y===0||i.children().shift(s,a);i.dirtyBoundingBoxCache()}}};var ks={field:"position",bindingEvent:"position",allowBinding:true,allowSetting:true,settingEvent:"position",settingTriggersEvent:true,triggerFnName:"emitAndNotify",allowGetting:true,validKeys:["x","y"],beforeGet:function beforeGet(e){e.updateCompoundBounds()},beforeSet:function beforeSet(e,t){Ss(e,t,false)},onSet:function onSet(e){e.dirtyCompoundBoundsCache()},canSet:function canSet(e){return!e.locked()}};Cs=Ts={position:Fo.data(ks),silentPosition:Fo.data(Y({},ks,{allowBinding:false,allowSetting:true,settingTriggersEvent:false,allowGetting:false,beforeSet:function beforeSet(e,t){Ss(e,t,true)},onSet:function onSet(e){e.dirtyCompoundBoundsCache()}})),positions:function positions(e,t){if(c(e))t?this.silentPosition(e):this.position(e);else if(u(e)){var a=e;var n=this.cy();n.startBatch();for(var i=0;i<this.length;i++){var o=this[i];var s=void 0;(s=a(o,i))&&(t?o.silentPosition(s):o.position(s))}n.endBatch()}return this},silentPositions:function silentPositions(e){return this.positions(e,true)},shift:function shift(e,t,a){var n;if(c(e)){n={x:h(e.x)?e.x:0,y:h(e.y)?e.y:0};a=t}else if(l(e)&&h(t)){n={x:0,y:0};n[e]=t}if(n!=null){var i=this.cy();i.startBatch();for(var o=0;o<this.length;o++){var s=this[o];if(!(i.hasCompoundNodes()&&s.isChild()&&s.ancestors().anySame(this))){var u=s.position();var v={x:u.x+n.x,y:u.y+n.y};a?s.silentPosition(v):s.position(v)}}i.endBatch()}return this},silentShift:function silentShift(e,t){c(e)?this.shift(e,true):l(e)&&h(t)&&this.shift(e,t,true);return this},renderedPosition:function renderedPosition(e,t){var a=this[0];var n=this.cy();var i=n.zoom();var o=n.pan();var s=c(e)?e:void 0;var u=s!==void 0||t!==void 0&&l(e);if(a&&a.isNode()){if(!u){var v=a.position();s=Ut(v,i,o);return e===void 0?s:s[e]}for(var d=0;d<this.length;d++){var h=this[d];t!==void 0?h.position(e,(t-o[e])/i):s!==void 0&&h.position(Zt(s,i,o))}}else if(!u)return;return this},relativePosition:function relativePosition(e,t){var a=this[0];var n=this.cy();var i=c(e)?e:void 0;var o=i!==void 0||t!==void 0&&l(e);var s=n.hasCompoundNodes();if(a&&a.isNode()){if(!o){var u=a.position();var v=s?a.parent():null;var d=v&&v.length>0;var h=d;d&&(v=v[0]);var p=h?v.position():{x:0,y:0};i={x:u.x-p.x,y:u.y-p.y};return e===void 0?i:i[e]}for(var g=0;g<this.length;g++){var y=this[g];var m=s?y.parent():null;var b=m&&m.length>0;var x=b;b&&(m=m[0]);var w=x?m.position():{x:0,y:0};t!==void 0?y.position(e,t+w[e]):i!==void 0&&y.position({x:i.x+w.x,y:i.y+w.y})}}else if(!o)return;return this}};Cs.modelPosition=Cs.point=Cs.position;Cs.modelPositions=Cs.points=Cs.positions;Cs.renderedPoint=Cs.renderedPosition;Cs.relativePoint=Cs.relativePosition;var Ps=Ts;var _s,Ds;_s=Ds={};Ds.renderedBoundingBox=function(e){var t=this.boundingBox(e);var a=this.cy();var n=a.zoom();var i=a.pan();var o=t.x1*n+i.x;var s=t.x2*n+i.x;var l=t.y1*n+i.y;var u=t.y2*n+i.y;return{x1:o,x2:s,y1:l,y2:u,w:s-o,h:u-l}};Ds.dirtyCompoundBoundsCache=function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];var t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;this.forEachUp((function(t){if(t.isParent()){var a=t._private;a.compoundBoundsClean=false;a.bbCache=null;e||t.emitAndNotify("bounds")}}));return this};Ds.updateCompoundBounds=function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];var t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;if(!e&&t.batching())return this;function update(e){if(e.isParent()){var t=e._private;var a=e.children();var n=e.pstyle("compound-sizing-wrt-labels").value==="include";var i={width:{val:e.pstyle("min-width").pfValue,left:e.pstyle("min-width-bias-left"),right:e.pstyle("min-width-bias-right")},height:{val:e.pstyle("min-height").pfValue,top:e.pstyle("min-height-bias-top"),bottom:e.pstyle("min-height-bias-bottom")}};var o=a.boundingBox({includeLabels:n,includeOverlays:false,useCache:false});var s=t.position;if(o.w===0||o.h===0){o={w:e.pstyle("width").pfValue,h:e.pstyle("height").pfValue};o.x1=s.x-o.w/2;o.x2=s.x+o.w/2;o.y1=s.y-o.h/2;o.y2=s.y+o.h/2}var l=i.width.left.value;i.width.left.units==="px"&&i.width.val>0&&(l=l*100/i.width.val);var u=i.width.right.value;i.width.right.units==="px"&&i.width.val>0&&(u=u*100/i.width.val);var v=i.height.top.value;i.height.top.units==="px"&&i.height.val>0&&(v=v*100/i.height.val);var c=i.height.bottom.value;i.height.bottom.units==="px"&&i.height.val>0&&(c=c*100/i.height.val);var d=computeBiasValues(i.width.val-o.w,l,u);var h=d.biasDiff;var p=d.biasComplementDiff;var g=computeBiasValues(i.height.val-o.h,v,c);var y=g.biasDiff;var m=g.biasComplementDiff;t.autoPadding=computePaddingValues(o.w,o.h,e.pstyle("padding"),e.pstyle("padding-relative-to").value);t.autoWidth=Math.max(o.w,i.width.val);s.x=(-h+o.x1+o.x2+p)/2;t.autoHeight=Math.max(o.h,i.height.val);s.y=(-y+o.y1+o.y2+m)/2}function computeBiasValues(e,t,a){var n=0;var i=0;var o=t+a;if(e>0&&o>0){n=t/o*e;i=a/o*e}return{biasDiff:n,biasComplementDiff:i}}function computePaddingValues(e,t,a,n){if(a.units!=="%")return a.units==="px"?a.pfValue:0;switch(n){case"width":return e>0?a.pfValue*e:0;case"height":return t>0?a.pfValue*t:0;case"average":return e>0&&t>0?a.pfValue*(e+t)/2:0;case"min":return e>0&&t>0?e>t?a.pfValue*t:a.pfValue*e:0;case"max":return e>0&&t>0?e>t?a.pfValue*e:a.pfValue*t:0;default:return 0}}}for(var a=0;a<this.length;a++){var n=this[a];var i=n._private;if(!i.compoundBoundsClean||e){update(n);t.batching()||(i.compoundBoundsClean=true)}}return this};var As=function noninf(e){return e===Infinity||e===-Infinity?0:e};var Bs=function updateBounds(e,t,a,n,i){if(n-t!==0&&i-a!==0&&t!=null&&a!=null&&n!=null&&i!=null){e.x1=t<e.x1?t:e.x1;e.x2=n>e.x2?n:e.x2;e.y1=a<e.y1?a:e.y1;e.y2=i>e.y2?i:e.y2;e.w=e.x2-e.x1;e.h=e.y2-e.y1}};var Is=function updateBoundsFromBox(e,t){return t==null?e:Bs(e,t.x1,t.y1,t.x2,t.y2)};var Ms=function prefixedProperty(e,t,a){return mt(e,t,a)};var Rs=function updateBoundsFromArrow(e,t,a){if(!t.cy().headless()){var n=t._private;var i=n.rstyle;var o=i.arrowWidth/2;var s=t.pstyle(a+"-arrow-shape").value;var l;var u;if(s!=="none"){if(a==="source"){l=i.srcX;u=i.srcY}else if(a==="target"){l=i.tgtX;u=i.tgtY}else{l=i.midX;u=i.midY}var v=n.arrowBounds=n.arrowBounds||{};var c=v[a]=v[a]||{};c.x1=l-o;c.y1=u-o;c.x2=l+o;c.y2=u+o;c.w=c.x2-c.x1;c.h=c.y2-c.y1;br(c,1);Bs(e,c.x1,c.y1,c.x2,c.y2)}}};var Ls=function updateBoundsFromLabel(e,t,a){if(!t.cy().headless()){var n;n=a?a+"-":"";var i=t._private;var o=i.rstyle;var s=t.pstyle(n+"label").strValue;if(s){var l=t.pstyle("text-halign");var u=t.pstyle("text-valign");var v=Ms(o,"labelWidth",a);var c=Ms(o,"labelHeight",a);var d=Ms(o,"labelX",a);var h=Ms(o,"labelY",a);var p=t.pstyle(n+"text-margin-x").pfValue;var g=t.pstyle(n+"text-margin-y").pfValue;var y=t.isEdge();var m=t.pstyle(n+"text-rotation");var b=t.pstyle("text-outline-width").pfValue;var x=t.pstyle("text-border-width").pfValue;var w=x/2;var E=t.pstyle("text-background-padding").pfValue;var T=2;var S=c;var k=v;var P=k/2;var _=S/2;var D,I,M,R;if(y){D=d-P;I=d+P;M=h-_;R=h+_}else{switch(l.value){case"left":D=d-k;I=d;break;case"center":D=d-P;I=d+P;break;case"right":D=d;I=d+k;break}switch(u.value){case"top":M=h-S;R=h;break;case"center":M=h-_;R=h+_;break;case"bottom":M=h;R=h+S;break}}var L=p-Math.max(b,w)-E-T;var N=p+Math.max(b,w)+E+T;var O=g-Math.max(b,w)-E-T;var z=g+Math.max(b,w)+E+T;D+=L;I+=N;M+=O;R+=z;var V=a||"main";var q=i.labelBounds;var j=q[V]=q[V]||{};j.x1=D;j.y1=M;j.x2=I;j.y2=R;j.w=I-D;j.h=R-M;j.leftPad=L;j.rightPad=N;j.topPad=O;j.botPad=z;var H=y&&m.strValue==="autorotate";var W=m.pfValue!=null&&m.pfValue!==0;if(H||W){var X=H?Ms(i.rstyle,"labelAngle",a):m.pfValue;var Y=Math.cos(X);var G=Math.sin(X);var K=(D+I)/2;var U=(M+R)/2;if(!y){switch(l.value){case"left":K=I;break;case"right":K=D;break}switch(u.value){case"top":U=R;break;case"bottom":U=M;break}}var Z=function rotate(e,t){e-=K;t-=U;return{x:e*Y-t*G+K,y:e*G+t*Y+U}};var Q=Z(D,M);var J=Z(D,R);var ee=Z(I,M);var te=Z(I,R);D=Math.min(Q.x,J.x,ee.x,te.x);I=Math.max(Q.x,J.x,ee.x,te.x);M=Math.min(Q.y,J.y,ee.y,te.y);R=Math.max(Q.y,J.y,ee.y,te.y)}var re=V+"Rot";var ae=q[re]=q[re]||{};ae.x1=D;ae.y1=M;ae.x2=I;ae.y2=R;ae.w=I-D;ae.h=R-M;Bs(e,D,M,I,R);Bs(i.labelBounds.all,D,M,I,R)}return e}};var Ns=function updateBoundsFromOutline(e,t){if(!t.cy().headless()){var a=t.pstyle("outline-opacity").value;var n=t.pstyle("outline-width").value;if(a>0&&n>0){var i=t.pstyle("outline-offset").value;var o=t.pstyle("shape").value;var s=n+i;var l=(e.w+s*2)/e.w;var u=(e.h+s*2)/e.h;var v=0;var c=0;if(["diamond","pentagon","round-triangle"].includes(o)){l=(e.w+s*2.4)/e.w;c=-s/3.6}else if(["concave-hexagon","rhomboid","right-rhomboid"].includes(o))l=(e.w+s*2.4)/e.w;else if(o==="star"){l=(e.w+s*2.8)/e.w;u=(e.h+s*2.6)/e.h;c=-s/3.8}else if(o==="triangle"){l=(e.w+s*2.8)/e.w;u=(e.h+s*2.4)/e.h;c=-s/1.4}else if(o==="vee"){l=(e.w+s*4.4)/e.w;u=(e.h+s*3.8)/e.h;c=.5*-s}var d=e.h*u-e.h;var h=e.w*l-e.w;xr(e,[Math.ceil(d/2),Math.ceil(h/2)]);if(v!=0||c!==0){var p=gr(e,v,c);yr(e,p)}}}};var Os=function boundingBoxImpl(e,t){var a=e._private.cy;var n=a.styleEnabled();var i=a.headless();var o=hr();var s=e._private;var l=e.isNode();var u=e.isEdge();var v,c,d,h;var p,g;var y=s.rstyle;var m=l&&n?e.pstyle("bounds-expansion").pfValue:[0];var b=function isDisplayed(e){return e.pstyle("display").value!=="none"};var x=!n||b(e)&&(!u||b(e.source())&&b(e.target()));if(x){var w=0;var E=0;if(n&&t.includeOverlays){w=e.pstyle("overlay-opacity").value;w!==0&&(E=e.pstyle("overlay-padding").value)}var T=0;var S=0;if(n&&t.includeUnderlays){T=e.pstyle("underlay-opacity").value;T!==0&&(S=e.pstyle("underlay-padding").value)}var k=Math.max(E,S);var P=0;var _=0;if(n){P=e.pstyle("width").pfValue;_=P/2}if(l&&t.includeNodes){var D=e.position();p=D.x;g=D.y;var I=e.outerWidth();var M=I/2;var R=e.outerHeight();var L=R/2;v=p-M;c=p+M;d=g-L;h=g+L;Bs(o,v,d,c,h);n&&t.includeOutlines&&Ns(o,e)}else if(u&&t.includeEdges)if(n&&!i){var N=e.pstyle("curve-style").strValue;v=Math.min(y.srcX,y.midX,y.tgtX);c=Math.max(y.srcX,y.midX,y.tgtX);d=Math.min(y.srcY,y.midY,y.tgtY);h=Math.max(y.srcY,y.midY,y.tgtY);v-=_;c+=_;d-=_;h+=_;Bs(o,v,d,c,h);if(N==="haystack"){var O=y.haystackPts;if(O&&O.length===2){v=O[0].x;d=O[0].y;c=O[1].x;h=O[1].y;if(v>c){var z=v;v=c;c=z}if(d>h){var V=d;d=h;h=V}Bs(o,v-_,d-_,c+_,h+_)}}else if(N==="bezier"||N==="unbundled-bezier"||N.endsWith("segments")||N.endsWith("taxi")){var q;switch(N){case"bezier":case"unbundled-bezier":q=y.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":q=y.linePts;break}if(q!=null)for(var j=0;j<q.length;j++){var H=q[j];v=H.x-_;c=H.x+_;d=H.y-_;h=H.y+_;Bs(o,v,d,c,h)}}}else{var W=e.source();var X=W.position();var Y=e.target();var G=Y.position();v=X.x;c=G.x;d=X.y;h=G.y;if(v>c){var K=v;v=c;c=K}if(d>h){var U=d;d=h;h=U}v-=_;c+=_;d-=_;h+=_;Bs(o,v,d,c,h)}if(n&&t.includeEdges&&u){Rs(o,e,"mid-source");Rs(o,e,"mid-target");Rs(o,e,"source");Rs(o,e,"target")}if(n){var Z=e.pstyle("ghost").value==="yes";if(Z){var Q=e.pstyle("ghost-offset-x").pfValue;var J=e.pstyle("ghost-offset-y").pfValue;Bs(o,o.x1+Q,o.y1+J,o.x2+Q,o.y2+J)}}var ee=s.bodyBounds=s.bodyBounds||{};wr(ee,o);xr(ee,m);br(ee,1);if(n){v=o.x1;c=o.x2;d=o.y1;h=o.y2;Bs(o,v-k,d-k,c+k,h+k)}var te=s.overlayBounds=s.overlayBounds||{};wr(te,o);xr(te,m);br(te,1);var re=s.labelBounds=s.labelBounds||{};re.all!=null?pr(re.all):re.all=hr();if(n&&t.includeLabels){t.includeMainLabels&&Ls(o,e,null);if(u){t.includeSourceLabels&&Ls(o,e,"source");t.includeTargetLabels&&Ls(o,e,"target")}}}o.x1=As(o.x1);o.y1=As(o.y1);o.x2=As(o.x2);o.y2=As(o.y2);o.w=As(o.x2-o.x1);o.h=As(o.y2-o.y1);if(o.w>0&&o.h>0&&x){xr(o,m);br(o,1)}return o};var Fs=function getKey(e){var t=0;var a=function tf(e){return(e?1:0)<<t++};var n=0;n+=a(e.incudeNodes);n+=a(e.includeEdges);n+=a(e.includeLabels);n+=a(e.includeMainLabels);n+=a(e.includeSourceLabels);n+=a(e.includeTargetLabels);n+=a(e.includeOverlays);n+=a(e.includeOutlines);return n};var zs=function getBoundingBoxPosKey(e){var t=function r(e){return Math.round(e)};if(e.isEdge()){var a=e.source().position();var n=e.target().position();return Ge([t(a.x),t(a.y),t(n.x),t(n.y)])}var i=e.position();return Ge([t(i.x),t(i.y)])};var Vs=function cachedBoundingBoxImpl(e,t){var a=e._private;var n;var i=e.isEdge();var o=t==null?js:Fs(t);var s=o===js;if(a.bbCache==null){n=Os(e,qs);a.bbCache=n;a.bbCachePosKey=zs(e)}else n=a.bbCache;if(!s){var l=e.isNode();n=hr();(t.includeNodes&&l||t.includeEdges&&!l)&&(t.includeOverlays?Is(n,a.overlayBounds):Is(n,a.bodyBounds));if(t.includeLabels)if(t.includeMainLabels&&(!i||t.includeSourceLabels&&t.includeTargetLabels))Is(n,a.labelBounds.all);else{t.includeMainLabels&&Is(n,a.labelBounds.mainRot);t.includeSourceLabels&&Is(n,a.labelBounds.sourceRot);t.includeTargetLabels&&Is(n,a.labelBounds.targetRot)}n.w=n.x2-n.x1;n.h=n.y2-n.y1}return n};var qs={includeNodes:true,includeEdges:true,includeLabels:true,includeMainLabels:true,includeSourceLabels:true,includeTargetLabels:true,includeOverlays:true,includeUnderlays:true,includeOutlines:true,useCache:true};var js=Fs(qs);var Hs=ft(qs);Ds.boundingBox=function(e){var t;var a=e===void 0||e.useCache===void 0||e.useCache===true;var n=D((function(e){var t=e._private;return t.bbCache==null||t.styleDirty||t.bbCachePosKey!==zs(e)}),(function(e){return e.id()}));if(a&&this.length===1&&!n(this[0])){e=e===void 0?qs:Hs(e);t=Vs(this[0],e)}else{t=hr();e=e||qs;var i=Hs(e);var o=this;var s=o.cy();var l=s.styleEnabled();this.edges().forEach(n);this.nodes().forEach(n);l&&this.recalculateRenderedStyle(a);this.updateCompoundBounds(!a);for(var u=0;u<o.length;u++){var v=o[u];n(v)&&v.dirtyBoundingBoxCache();Is(t,Vs(v,i))}}t.x1=As(t.x1);t.y1=As(t.y1);t.x2=As(t.x2);t.y2=As(t.y2);t.w=As(t.x2-t.x1);t.h=As(t.y2-t.y1);return t};Ds.dirtyBoundingBoxCache=function(){for(var e=0;e<this.length;e++){var t=this[e]._private;t.bbCache=null;t.bbCachePosKey=null;t.bodyBounds=null;t.overlayBounds=null;t.labelBounds.all=null;t.labelBounds.source=null;t.labelBounds.target=null;t.labelBounds.main=null;t.labelBounds.sourceRot=null;t.labelBounds.targetRot=null;t.labelBounds.mainRot=null;t.arrowBounds.source=null;t.arrowBounds.target=null;t.arrowBounds["mid-source"]=null;t.arrowBounds["mid-target"]=null}this.emitAndNotify("bounds");return this};Ds.boundingBoxAt=function(e){var t=this.nodes();var a=this.cy();var n=a.hasCompoundNodes();var i=a.collection();if(n){i=t.filter((function(e){return e.isParent()}));t=t.not(i)}if(c(e)){var o=e;e=function fn(){return o}}var s=function storeOldPos(t,a){return t._private.bbAtOldPos=e(t,a)};var l=function getOldPos(e){return e._private.bbAtOldPos};a.startBatch();t.forEach(s).silentPositions(e);if(n){i.dirtyCompoundBoundsCache();i.dirtyBoundingBoxCache();i.updateCompoundBounds(true)}var u=fr(this.boundingBox({useCache:false}));t.silentPositions(l);if(n){i.dirtyCompoundBoundsCache();i.dirtyBoundingBoxCache();i.updateCompoundBounds(true)}a.endBatch();return u};_s.boundingbox=_s.bb=_s.boundingBox;_s.renderedBoundingbox=_s.renderedBoundingBox;var Ws=Ds;var Xs,Ys;Xs=Ys={};var Gs=function defineDimFns(e){e.uppercaseName=L(e.name);e.autoName="auto"+e.uppercaseName;e.labelName="label"+e.uppercaseName;e.outerName="outer"+e.uppercaseName;e.uppercaseOuterName=L(e.outerName);Xs[e.name]=function dimImpl(){var t=this[0];var a=t._private;var n=a.cy;var i=n._private.styleEnabled;if(t){if(!i)return 1;if(t.isParent()){t.updateCompoundBounds();return a[e.autoName]||0}var o=t.pstyle(e.name);switch(o.strValue){case"label":t.recalculateRenderedStyle();return a.rstyle[e.labelName]||0;default:return o.pfValue}}};Xs["outer"+e.uppercaseName]=function outerDimImpl(){var t=this[0];var a=t._private;var n=a.cy;var i=n._private.styleEnabled;if(t){if(i){var o=t[e.name]();var s=t.pstyle("border-width").pfValue;var l=2*t.padding();return o+s+l}return 1}};Xs["rendered"+e.uppercaseName]=function renderedDimImpl(){var t=this[0];if(t){var a=t[e.name]();return a*this.cy().zoom()}};Xs["rendered"+e.uppercaseOuterName]=function renderedOuterDimImpl(){var t=this[0];if(t){var a=t[e.outerName]();return a*this.cy().zoom()}}};Gs({name:"width"});Gs({name:"height"});Ys.padding=function(){var e=this[0];var t=e._private;if(e.isParent()){e.updateCompoundBounds();return t.autoPadding!==void 0?t.autoPadding:e.pstyle("padding").pfValue}return e.pstyle("padding").pfValue};Ys.paddedHeight=function(){var e=this[0];return e.height()+2*e.padding()};Ys.paddedWidth=function(){var e=this[0];return e.width()+2*e.padding()};var Ks=Ys;var Us=function ifEdge(e,t){if(e.isEdge()&&e.takesUpSpace())return t(e)};var Zs=function ifEdgeRenderedPosition(e,t){if(e.isEdge()&&e.takesUpSpace()){var a=e.cy();return Ut(t(e),a.zoom(),a.pan())}};var $s=function ifEdgeRenderedPositions(e,t){if(e.isEdge()&&e.takesUpSpace()){var a=e.cy();var n=a.pan();var i=a.zoom();return t(e).map((function(e){return Ut(e,i,n)}))}};var Qs=function controlPoints(e){return e.renderer().getControlPoints(e)};var Js=function segmentPoints(e){return e.renderer().getSegmentPoints(e)};var el=function sourceEndpoint(e){return e.renderer().getSourceEndpoint(e)};var tl=function targetEndpoint(e){return e.renderer().getTargetEndpoint(e)};var rl=function midpoint(e){return e.renderer().getEdgeMidpoint(e)};var al={controlPoints:{get:Qs,mult:true},segmentPoints:{get:Js,mult:true},sourceEndpoint:{get:el},targetEndpoint:{get:tl},midpoint:{get:rl}};var nl=function renderedName(e){return"rendered"+e[0].toUpperCase()+e.substr(1)};var il=Object.keys(al).reduce((function(e,t){var a=al[t];var n=nl(t);e[t]=function(){return Us(this,a.get)};a.mult?e[n]=function(){return $s(this,a.get)}:e[n]=function(){return Zs(this,a.get)};return e}),{});var ol=Y({},Ps,Ws,Ks,il);var sl=function Event(e,t){this.recycle(e,t)};function returnFalse(){return false}function returnTrue(){return true}sl.prototype={instanceString:function instanceString(){return"event"},recycle:function recycle(e,t){this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=returnFalse;if(e!=null&&e.preventDefault){this.type=e.type;this.isDefaultPrevented=e.defaultPrevented?returnTrue:returnFalse}else e!=null&&e.type?t=e:this.type=e;if(t!=null){this.originalEvent=t.originalEvent;this.type=t.type!=null?t.type:this.type;this.cy=t.cy;this.target=t.target;this.position=t.position;this.renderedPosition=t.renderedPosition;this.namespace=t.namespace;this.layout=t.layout}if(this.cy!=null&&this.position!=null&&this.renderedPosition==null){var a=this.position;var n=this.cy.zoom();var i=this.cy.pan();this.renderedPosition={x:a.x*n+i.x,y:a.y*n+i.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function preventDefault(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function stopPropagation(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function stopImmediatePropagation(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var ll=/^([^.]+)(\.(?:[^.]+))?$/;var ul=".*";var vl={qualifierCompare:function qualifierCompare(e,t){return e===t},eventMatches:function eventMatches(){return true},addEventFields:function addEventFields(){},callbackContext:function callbackContext(e){return e},beforeEmit:function beforeEmit(){},afterEmit:function afterEmit(){},bubble:function bubble(){return false},parent:function parent(){return null},context:null};var cl=Object.keys(vl);var dl={};function Emitter(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dl;var t=arguments.length>1?arguments[1]:void 0;for(var a=0;a<cl.length;a++){var n=cl[a];this[n]=e[n]||vl[n]}this.context=t||this.context;this.listeners=[];this.emitting=0}var hl=Emitter.prototype;var fl=function forEachEvent(e,t,a,n,i,o,s){if(u(n)){i=n;n=null}s&&(o=o==null?s:Y({},o,s));var l=v(a)?a:a.split(/\s+/);for(var c=0;c<l.length;c++){var d=l[c];if(!T(d)){var h=d.match(ll);if(h){var p=h[1];var g=h[2]?h[2]:null;var y=t(e,d,p,g,n,i,o);if(y===false)break}}}};var pl=function makeEventObj(e,t){e.addEventFields(e.context,t);return new sl(t.type,t)};var gl=function forEachEventObj(e,t,a){if(E(a))t(e,a);else if(c(a))t(e,pl(e,a));else{var n=v(a)?a:a.split(/\s+/);for(var i=0;i<n.length;i++){var o=n[i];if(!T(o)){var s=o.match(ll);if(s){var l=s[1];var u=s[2]?s[2]:null;var d=pl(e,{type:l,namespace:u,target:e.context});t(e,d)}}}}};hl.on=hl.addListener=function(e,t,a,n,i){fl(this,(function(e,t,a,n,i,o,s){u(o)&&e.listeners.push({event:t,callback:o,type:a,namespace:n,qualifier:i,conf:s})}),e,t,a,n,i);return this};hl.one=function(e,t,a,n){return this.on(e,t,a,n,{one:true})};hl.removeListener=hl.off=function(e,t,a,n){var i=this;this.emitting!==0&&(this.listeners=vt(this.listeners));var o=this.listeners;var s=function _loop(s){var l=o[s];fl(i,(function(t,a,n,i,u,v){if((l.type===n||e==="*")&&(!i&&l.namespace!==".*"||l.namespace===i)&&(!u||t.qualifierCompare(l.qualifier,u))&&(!v||l.callback===v)){o.splice(s,1);return false}}),e,t,a,n)};for(var l=o.length-1;l>=0;l--)s(l);return this};hl.removeAllListeners=function(){return this.removeListener("*")};hl.emit=hl.trigger=function(e,t,a){var n=this.listeners;var i=n.length;this.emitting++;v(t)||(t=[t]);gl(this,(function(e,o){if(a!=null){n=[{event:o.event,type:o.type,namespace:o.namespace,callback:a}];i=n.length}var s=function _loop2(){var a=n[l];if(a.type===o.type&&(!a.namespace||a.namespace===o.namespace||a.namespace===ul)&&e.eventMatches(e.context,a,o)){var i=[o];t!=null&&yt(i,t);e.beforeEmit(e.context,a,o);a.conf&&a.conf.one&&(e.listeners=e.listeners.filter((function(e){return e!==a})));var s=e.callbackContext(e.context,a,o);var u=a.callback.apply(s,i);e.afterEmit(e.context,a,o);if(u===false){o.stopPropagation();o.preventDefault()}}};for(var l=0;l<i;l++)s();e.bubble(e.context)&&!o.isPropagationStopped()&&e.parent(e.context).emit(o,t)}),e);this.emitting--;return this};var yl={qualifierCompare:function qualifierCompare(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function eventMatches(e,t,a){var n=t.qualifier;return n==null||e!==a.target&&m(a.target)&&n.matches(a.target)},addEventFields:function addEventFields(e,t){t.cy=e.cy();t.target=e},callbackContext:function callbackContext(e,t,a){return t.qualifier!=null?a.target:e},beforeEmit:function beforeEmit(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function bubble(){return true},parent:function parent(e){return e.isChild()?e.parent():e.cy()}};var ml=function argSelector(e){return l(e)?new hs(e):e};var bl={createEmitter:function createEmitter(){for(var e=0;e<this.length;e++){var t=this[e];var a=t._private;a.emitter||(a.emitter=new Emitter(yl,t))}return this},emitter:function emitter(){return this._private.emitter},on:function on(e,t,a){var n=ml(t);for(var i=0;i<this.length;i++){var o=this[i];o.emitter().on(e,n,a)}return this},removeListener:function removeListener(e,t,a){var n=ml(t);for(var i=0;i<this.length;i++){var o=this[i];o.emitter().removeListener(e,n,a)}return this},removeAllListeners:function removeAllListeners(){for(var e=0;e<this.length;e++){var t=this[e];t.emitter().removeAllListeners()}return this},one:function one(e,t,a){var n=ml(t);for(var i=0;i<this.length;i++){var o=this[i];o.emitter().one(e,n,a)}return this},once:function once(e,t,a){var n=ml(t);for(var i=0;i<this.length;i++){var o=this[i];o.emitter().on(e,n,a,{once:true,onceCollection:this})}},emit:function emit(e,t){for(var a=0;a<this.length;a++){var n=this[a];n.emitter().emit(e,t)}return this},emitAndNotify:function emitAndNotify(e,t){if(this.length!==0){this.cy().notify(e,this);this.emit(e,t);return this}}};Fo.eventAliasesOn(bl);var xl={nodes:function nodes(e){return this.filter((function(e){return e.isNode()})).filter(e)},edges:function edges(e){return this.filter((function(e){return e.isEdge()})).filter(e)},byGroup:function byGroup(){var e=this.spawn();var t=this.spawn();for(var a=0;a<this.length;a++){var n=this[a];n.isNode()?e.push(n):t.push(n)}return{nodes:e,edges:t}},filter:function filter(e,t){if(e===void 0)return this;if(l(e)||y(e))return new hs(e).filter(this);if(u(e)){var a=this.spawn();var n=this;for(var i=0;i<n.length;i++){var o=n[i];var s=t?e.apply(t,[o,i,n]):e(o,i,n);s&&a.push(o)}return a}return this.spawn()},not:function not(e){if(e){l(e)&&(e=this.filter(e));var t=this.spawn();for(var a=0;a<this.length;a++){var n=this[a];var i=e.has(n);i||t.push(n)}return t}return this},absoluteComplement:function absoluteComplement(){var e=this.cy();return e.mutableElements().not(this)},intersect:function intersect(e){if(l(e)){var t=e;return this.filter(t)}var a=this.spawn();var n=this;var i=e;var o=this.length<e.length;var s=o?n:i;var u=o?i:n;for(var v=0;v<s.length;v++){var c=s[v];u.has(c)&&a.push(c)}return a},xor:function xor(e){var t=this._private.cy;l(e)&&(e=t.$(e));var a=this.spawn();var n=this;var i=e;var o=function add(e,t){for(var n=0;n<e.length;n++){var i=e[n];var o=i._private.data.id;var s=t.hasElementWithId(o);s||a.push(i)}};o(n,i);o(i,n);return a},diff:function diff(e){var t=this._private.cy;l(e)&&(e=t.$(e));var a=this.spawn();var n=this.spawn();var i=this.spawn();var o=this;var s=e;var u=function add(e,t,a){for(var n=0;n<e.length;n++){var o=e[n];var s=o._private.data.id;var l=t.hasElementWithId(s);l?i.merge(o):a.push(o)}};u(o,s,a);u(s,o,n);return{left:a,right:n,both:i}},add:function add(e){var t=this._private.cy;if(!e)return this;if(l(e)){var a=e;e=t.mutableElements().filter(a)}var n=this.spawnSelf();for(var i=0;i<e.length;i++){var o=e[i];var add=!this.has(o);add&&n.push(o)}return n},merge:function merge(e){var t=this._private;var a=t.cy;if(!e)return this;if(e&&l(e)){var n=e;e=a.mutableElements().filter(n)}var i=t.map;for(var o=0;o<e.length;o++){var s=e[o];var u=s._private.data.id;var v=!i.has(u);if(v){var c=this.length++;this[c]=s;i.set(u,{ele:s,index:c})}}return this},unmergeAt:function unmergeAt(e){var t=this[e];var a=t.id();var n=this._private;var i=n.map;this[e]=void 0;i.delete(a);var o=e===this.length-1;if(this.length>1&&!o){var s=this.length-1;var l=this[s];var u=l._private.data.id;this[s]=void 0;this[e]=l;i.set(u,{ele:l,index:e})}this.length--;return this},unmergeOne:function unmergeOne(e){e=e[0];var t=this._private;var a=e._private.data.id;var n=t.map;var i=n.get(a);if(!i)return this;var o=i.index;this.unmergeAt(o);return this},unmerge:function unmerge(e){var t=this._private.cy;if(!e)return this;if(e&&l(e)){var a=e;e=t.mutableElements().filter(a)}for(var n=0;n<e.length;n++)this.unmergeOne(e[n]);return this},unmergeBy:function unmergeBy(e){for(var t=this.length-1;t>=0;t--){var a=this[t];e(a)&&this.unmergeAt(t)}return this},map:function map(e,t){var a=[];var n=this;for(var i=0;i<n.length;i++){var o=n[i];var s=t?e.apply(t,[o,i,n]):e(o,i,n);a.push(s)}return a},reduce:function reduce(e,t){var a=t;var n=this;for(var i=0;i<n.length;i++)a=e(a,n[i],i,n);return a},max:function max(e,t){var max=-Infinity;var a;var n=this;for(var i=0;i<n.length;i++){var o=n[i];var s=t?e.apply(t,[o,i,n]):e(o,i,n);if(s>max){max=s;a=o}}return{value:max,ele:a}},min:function min(e,t){var min=Infinity;var a;var n=this;for(var i=0;i<n.length;i++){var o=n[i];var s=t?e.apply(t,[o,i,n]):e(o,i,n);if(s<min){min=s;a=o}}return{value:min,ele:a}}};var wl=xl;wl.u=wl["|"]=wl["+"]=wl.union=wl.or=wl.add;wl["\\"]=wl["!"]=wl["-"]=wl.difference=wl.relativeComplement=wl.subtract=wl.not;wl.n=wl["&"]=wl["."]=wl.and=wl.intersection=wl.intersect;wl["^"]=wl["(+)"]=wl["(-)"]=wl.symmetricDifference=wl.symdiff=wl.xor;wl.fnFilter=wl.filterFn=wl.stdFilter=wl.filter;wl.complement=wl.abscomp=wl.absoluteComplement;var El={isNode:function isNode(){return this.group()==="nodes"},isEdge:function isEdge(){return this.group()==="edges"},isLoop:function isLoop(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function isSimple(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function group(){var e=this[0];if(e)return e._private.group}};var Cl=function zIndexSort(e,t){var a=e.cy();var n=a.hasCompoundNodes();function getDepth(e){var t=e.pstyle("z-compound-depth");return t.value==="auto"?n?e.zDepth():0:t.value==="bottom"?-1:t.value==="top"?et:0}var i=getDepth(e)-getDepth(t);if(i!==0)return i;function getEleDepth(e){var t=e.pstyle("z-index-compare");return t.value==="auto"&&e.isNode()?1:0}var o=getEleDepth(e)-getEleDepth(t);if(o!==0)return o;var s=e.pstyle("z-index").value-t.pstyle("z-index").value;return s!==0?s:e.poolIndex()-t.poolIndex()};var Tl={forEach:function forEach(e,t){if(u(e)){var a=this.length;for(var n=0;n<a;n++){var i=this[n];var o=t?e.apply(t,[i,n,this]):e(i,n,this);if(o===false)break}}return this},toArray:function toArray(){var e=[];for(var t=0;t<this.length;t++)e.push(this[t]);return e},slice:function slice(e,t){var a=[];var n=this.length;t==null&&(t=n);e==null&&(e=0);e<0&&(e=n+e);t<0&&(t=n+t);for(var i=e;i>=0&&i<t&&i<n;i++)a.push(this[i]);return this.spawn(a)},size:function size(){return this.length},eq:function eq(e){return this[e]||this.spawn()},first:function first(){return this[0]||this.spawn()},last:function last(){return this[this.length-1]||this.spawn()},empty:function empty(){return this.length===0},nonempty:function nonempty(){return!this.empty()},sort:function sort(e){if(!u(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function sortByZIndex(){return this.sort(Cl)},zDepth:function zDepth(){var e=this[0];if(e){var t=e._private;var a=t.group;if(a==="nodes"){var n=t.data.parent?e.parents().size():0;return e.isParent()?n:et-1}var i=t.source;var o=t.target;var s=i.zDepth();var l=o.zDepth();return Math.max(s,l,0)}}};Tl.each=Tl.forEach;var Sl=function defineSymbolIterator(){var e="undefined";var t=(typeof Symbol==="undefined"?"undefined":_typeof(Symbol))!=e&&_typeof(Symbol.iterator)!=e;t&&(Tl[Symbol.iterator]=function(){var e=this;var t={value:void 0,done:false};var a=0;var n=this.length;return _defineProperty$1({next:function next(){if(a<n)t.value=e[a++];else{t.value=void 0;t.done=true}return t}},Symbol.iterator,(function(){return this}))})};Sl();var kl=ft({nodeDimensionsIncludeLabels:false});var Pl={layoutDimensions:function layoutDimensions(e){e=kl(e);var t;if(this.takesUpSpace())if(e.nodeDimensionsIncludeLabels){var a=this.boundingBox();t={w:a.w,h:a.h}}else t={w:this.outerWidth(),h:this.outerHeight()};else t={w:0,h:0};t.w!==0&&t.h!==0||(t.w=t.h=1);return t},layoutPositions:function layoutPositions(e,t,a){var n=this.nodes().filter((function(e){return!e.isParent()}));var i=this.cy();var o=t.eles;var s=function getMemoizeKey(e){return e.id()};var l=D(a,s);e.emit({type:"layoutstart",layout:e});e.animations=[];var u=function calculateSpacing(e,t,a){var n={x:t.x1+t.w/2,y:t.y1+t.h/2};var i={x:(a.x-n.x)*e,y:(a.y-n.y)*e};return{x:n.x+i.x,y:n.y+i.y}};var v=t.spacingFactor&&t.spacingFactor!==1;var c=function spacingBb(){if(!v)return null;var e=hr();for(var t=0;t<n.length;t++){var a=n[t];var i=l(a,t);mr(e,i.x,i.y)}return e};var d=c();var h=D((function(e,a){var n=l(e,a);if(v){var i=Math.abs(t.spacingFactor);n=u(i,d,n)}t.transform!=null&&(n=t.transform(e,n));return n}),s);if(t.animate){for(var p=0;p<n.length;p++){var g=n[p];var y=h(g,p);var m=t.animateFilter==null||t.animateFilter(g,p);if(m){var b=g.animation({position:y,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(b)}else g.position(y)}if(t.fit){var x=i.animation({fit:{boundingBox:o.boundingBoxAt(h),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(x)}else if(t.zoom!==void 0&&t.pan!==void 0){var w=i.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(w)}e.animations.forEach((function(e){return e.play()}));e.one("layoutready",t.ready);e.emit({type:"layoutready",layout:e});Bn.all(e.animations.map((function(e){return e.promise()}))).then((function(){e.one("layoutstop",t.stop);e.emit({type:"layoutstop",layout:e})}))}else{n.positions(h);t.fit&&i.fit(t.eles,t.padding);t.zoom!=null&&i.zoom(t.zoom);t.pan&&i.pan(t.pan);e.one("layoutready",t.ready);e.emit({type:"layoutready",layout:e});e.one("layoutstop",t.stop);e.emit({type:"layoutstop",layout:e})}return this},layout:function layout(e){var t=this.cy();return t.makeLayout(Y({},e,{eles:this}))}};Pl.createLayout=Pl.makeLayout=Pl.layout;function styleCache(e,t,a){var n=a._private;var i=n.styleCache=n.styleCache||[];var o;if((o=i[e])!=null)return o;o=i[e]=t(a);return o}function cacheStyleFunction(e,t){e=Ke(e);return function cachedStyleFunction(a){return styleCache(e,t,a)}}function cachePrototypeStyleFunction(e,t){e=Ke(e);var a=function selfFn(e){return t.call(e)};return function cachedPrototypeStyleFunction(){var t=this[0];if(t)return styleCache(e,a,t)}}var _l={recalculateRenderedStyle:function recalculateRenderedStyle(e){var t=this.cy();var a=t.renderer();var n=t.styleEnabled();a&&n&&a.recalculateRenderedStyle(this,e);return this},dirtyStyleCache:function dirtyStyleCache(){var e=this.cy();var t=function dirty(e){return e._private.styleCache=null};if(e.hasCompoundNodes()){var a;a=this.spawnSelf().merge(this.descendants()).merge(this.parents());a.merge(a.connectedEdges());a.forEach(t)}else this.forEach((function(e){t(e);e.connectedEdges().forEach(t)}));return this},updateStyle:function updateStyle(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching()){var a=t._private.batchStyleEles;a.merge(this);return this}var n=t.hasCompoundNodes();var i=this;e=!(!e&&e!==void 0);n&&(i=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=i;e?o.emitAndNotify("style"):o.emit("style");i.forEach((function(e){return e._private.styleDirty=true}));return this},cleanStyle:function cleanStyle(){var e=this.cy();if(e.styleEnabled())for(var t=0;t<this.length;t++){var a=this[t];if(a._private.styleDirty){a._private.styleDirty=false;e.style().apply(a)}}},parsedStyle:function parsedStyle(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var a=this[0];var n=a.cy();if(n.styleEnabled()&&a){if(a._private.styleDirty){a._private.styleDirty=false;n.style().apply(a)}var i=a._private.style[e];return i!=null?i:t?n.style().getDefaultProperty(e):null}},numericStyle:function numericStyle(e){var t=this[0];if(t.cy().styleEnabled()&&t){var a=t.pstyle(e);return a.pfValue!==void 0?a.pfValue:a.value}},numericStyleUnits:function numericStyleUnits(e){var t=this[0];if(t.cy().styleEnabled())return t?t.pstyle(e).units:void 0},renderedStyle:function renderedStyle(e){var t=this.cy();if(!t.styleEnabled())return this;var a=this[0];return a?t.style().getRenderedStyle(a,e):void 0},style:function style(e,t){var a=this.cy();if(!a.styleEnabled())return this;var n=false;var style=a.style();if(c(e)){var i=e;style.applyBypass(this,i,n);this.emitAndNotify("style")}else if(l(e)){if(t===void 0){var o=this[0];return o?style.getStylePropertyValue(o,e):void 0}style.applyBypass(this,e,t,n);this.emitAndNotify("style")}else if(e===void 0){var s=this[0];return s?style.getRawStyle(s):void 0}return this},removeStyle:function removeStyle(e){var t=this.cy();if(!t.styleEnabled())return this;var a=false;var n=t.style();var i=this;if(e===void 0)for(var o=0;o<i.length;o++){var s=i[o];n.removeAllBypasses(s,a)}else{e=e.split(/\s+/);for(var l=0;l<i.length;l++){var u=i[l];n.removeBypasses(u,e,a)}}this.emitAndNotify("style");return this},show:function show(){this.css("display","element");return this},hide:function hide(){this.css("display","none");return this},effectiveOpacity:function effectiveOpacity(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes();var a=this[0];if(a){var n=a._private;var i=a.pstyle("opacity").value;if(!t)return i;var o=n.data.parent?a.parents():null;if(o)for(var s=0;s<o.length;s++){var l=o[s];var u=l.pstyle("opacity").value;i*=u}return i}},transparent:function transparent(){var e=this.cy();if(!e.styleEnabled())return false;var t=this[0];var a=t.cy().hasCompoundNodes();return t?a?t.effectiveOpacity()===0:t.pstyle("opacity").value===0:void 0},backgrounding:function backgrounding(){var e=this.cy();if(!e.styleEnabled())return false;var t=this[0];return!!t._private.backgrounding}};function checkCompound(e,t){var a=e._private;var n=a.data.parent?e.parents():null;if(n)for(var i=0;i<n.length;i++){var o=n[i];if(!t(o))return false}return true}function defineDerivedStateFunction(e){var t=e.ok;var a=e.edgeOkViaNode||e.ok;var n=e.parentOk||e.ok;return function(){var e=this.cy();if(!e.styleEnabled())return true;var i=this[0];var o=e.hasCompoundNodes();if(i){var s=i._private;if(!t(i))return false;if(i.isNode())return!o||checkCompound(i,n);var l=s.source;var u=s.target;return a(l)&&(!o||checkCompound(l,a))&&(l===u||a(u)&&(!o||checkCompound(u,a)))}}}var Dl=cacheStyleFunction("eleTakesUpSpace",(function(e){return e.pstyle("display").value==="element"&&e.width()!==0&&(!e.isNode()||e.height()!==0)}));_l.takesUpSpace=cachePrototypeStyleFunction("takesUpSpace",defineDerivedStateFunction({ok:Dl}));var Al=cacheStyleFunction("eleInteractive",(function(e){return e.pstyle("events").value==="yes"&&e.pstyle("visibility").value==="visible"&&Dl(e)}));var Bl=cacheStyleFunction("parentInteractive",(function(e){return e.pstyle("visibility").value==="visible"&&Dl(e)}));_l.interactive=cachePrototypeStyleFunction("interactive",defineDerivedStateFunction({ok:Al,parentOk:Bl,edgeOkViaNode:Dl}));_l.noninteractive=function(){var e=this[0];if(e)return!e.interactive()};var Il=cacheStyleFunction("eleVisible",(function(e){return e.pstyle("visibility").value==="visible"&&e.pstyle("opacity").pfValue!==0&&Dl(e)}));var Ml=Dl;_l.visible=cachePrototypeStyleFunction("visible",defineDerivedStateFunction({ok:Il,edgeOkViaNode:Ml}));_l.hidden=function(){var e=this[0];if(e)return!e.visible()};_l.isBundledBezier=cachePrototypeStyleFunction("isBundledBezier",(function(){return!!this.cy().styleEnabled()&&(!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace())}));_l.bypass=_l.css=_l.style;_l.renderedCss=_l.renderedStyle;_l.removeBypass=_l.removeCss=_l.removeStyle;_l.pstyle=_l.parsedStyle;var Rl={};function defineSwitchFunction(e){return function(){var t=arguments;var a=[];if(t.length===2){var n=t[0];var i=t[1];this.on(e.event,n,i)}else if(t.length===1&&u(t[0])){var o=t[0];this.on(e.event,o)}else if(t.length===0||t.length===1&&v(t[0])){var s=t.length===1?t[0]:null;for(var l=0;l<this.length;l++){var c=this[l];var d=!e.ableField||c._private[e.ableField];var h=c._private[e.field]!=e.value;if(e.overrideAble){var p=e.overrideAble(c);if(p!==void 0){d=p;if(!p)return this}}if(d){c._private[e.field]=e.value;h&&a.push(c)}}var g=this.spawn(a);g.updateStyle();g.emit(e.event);s&&g.emit(s)}return this}}function defineSwitchSet(e){Rl[e.field]=function(){var t=this[0];if(t){if(e.overrideField){var a=e.overrideField(t);if(a!==void 0)return a}return t._private[e.field]}};Rl[e.on]=defineSwitchFunction({event:e.on,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:true});Rl[e.off]=defineSwitchFunction({event:e.off,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:false})}defineSwitchSet({field:"locked",overrideField:function overrideField(e){return!!e.cy().autolock()||void 0},on:"lock",off:"unlock"});defineSwitchSet({field:"grabbable",overrideField:function overrideField(e){return!e.cy().autoungrabify()&&!e.pannable()&&void 0},on:"grabify",off:"ungrabify"});defineSwitchSet({field:"selected",ableField:"selectable",overrideAble:function overrideAble(e){return!e.cy().autounselectify()&&void 0},on:"select",off:"unselect"});defineSwitchSet({field:"selectable",overrideField:function overrideField(e){return!e.cy().autounselectify()&&void 0},on:"selectify",off:"unselectify"});Rl.deselect=Rl.unselect;Rl.grabbed=function(){var e=this[0];if(e)return e._private.grabbed};defineSwitchSet({field:"active",on:"activate",off:"unactivate"});defineSwitchSet({field:"pannable",on:"panify",off:"unpanify"});Rl.inactive=function(){var e=this[0];if(e)return!e._private.active};var Ll={};var Nl=function defineDagExtremity(e){return function dagExtremityImpl(t){var a=this;var n=[];for(var i=0;i<a.length;i++){var o=a[i];if(o.isNode()){var s=false;var l=o.connectedEdges();for(var u=0;u<l.length;u++){var v=l[u];var c=v.source();var d=v.target();if(e.noIncomingEdges&&d===o&&c!==o||e.noOutgoingEdges&&c===o&&d!==o){s=true;break}}s||n.push(o)}}return this.spawn(n,true).filter(t)}};var Ol=function defineDagOneHop(e){return function(t){var a=this;var n=[];for(var i=0;i<a.length;i++){var o=a[i];if(o.isNode()){var s=o.connectedEdges();for(var l=0;l<s.length;l++){var u=s[l];var v=u.source();var c=u.target();if(e.outgoing&&v===o){n.push(u);n.push(c)}else if(e.incoming&&c===o){n.push(u);n.push(v)}}}}return this.spawn(n,true).filter(t)}};var Fl=function defineDagAllHops(e){return function(t){var a=this;var n=[];var i={};for(;;){var o=e.outgoing?a.outgoers():a.incomers();if(o.length===0)break;var s=false;for(var l=0;l<o.length;l++){var u=o[l];var v=u.id();if(!i[v]){i[v]=true;n.push(u);s=true}}if(!s)break;a=o}return this.spawn(n,true).filter(t)}};Ll.clearTraversalCache=function(){for(var e=0;e<this.length;e++)this[e]._private.traversalCache=null};Y(Ll,{roots:Nl({noIncomingEdges:true}),leaves:Nl({noOutgoingEdges:true}),outgoers:gs(Ol({outgoing:true}),"outgoers"),successors:Fl({outgoing:true}),incomers:gs(Ol({incoming:true}),"incomers"),predecessors:Fl({})});Y(Ll,{neighborhood:gs((function(e){var t=[];var a=this.nodes();for(var n=0;n<a.length;n++){var i=a[n];var o=i.connectedEdges();for(var s=0;s<o.length;s++){var l=o[s];var u=l.source();var v=l.target();var c=i===u?v:u;c.length>0&&t.push(c[0]);t.push(l[0])}}return this.spawn(t,true).filter(e)}),"neighborhood"),closedNeighborhood:function closedNeighborhood(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function openNeighborhood(e){return this.neighborhood(e)}});Ll.neighbourhood=Ll.neighborhood;Ll.closedNeighbourhood=Ll.closedNeighborhood;Ll.openNeighbourhood=Ll.openNeighborhood;Y(Ll,{source:gs((function sourceImpl(e){var t=this[0];var a;t&&(a=t._private.source||t.cy().collection());return a&&e?a.filter(e):a}),"source"),target:gs((function targetImpl(e){var t=this[0];var a;t&&(a=t._private.target||t.cy().collection());return a&&e?a.filter(e):a}),"target"),sources:defineSourceFunction({attr:"source"}),targets:defineSourceFunction({attr:"target"})});function defineSourceFunction(e){return function sourceImpl(t){var a=[];for(var n=0;n<this.length;n++){var i=this[n];var o=i._private[e.attr];o&&a.push(o)}return this.spawn(a,true).filter(t)}}Y(Ll,{edgesWith:gs(defineEdgesWithFunction(),"edgesWith"),edgesTo:gs(defineEdgesWithFunction({thisIsSrc:true}),"edgesTo")});function defineEdgesWithFunction(e){return function edgesWithImpl(t){var a=[];var n=this._private.cy;var i=e||{};l(t)&&(t=n.$(t));for(var o=0;o<t.length;o++){var s=t[o]._private.edges;for(var u=0;u<s.length;u++){var v=s[u];var c=v._private.data;var d=this.hasElementWithId(c.source)&&t.hasElementWithId(c.target);var h=t.hasElementWithId(c.source)&&this.hasElementWithId(c.target);var p=d||h;if(p){if(i.thisIsSrc||i.thisIsTgt){if(i.thisIsSrc&&!d)continue;if(i.thisIsTgt&&!h)continue}a.push(v)}}}return this.spawn(a,true)}}Y(Ll,{connectedEdges:gs((function(e){var t=[];var a=this;for(var n=0;n<a.length;n++){var i=a[n];if(i.isNode()){var o=i._private.edges;for(var s=0;s<o.length;s++){var l=o[s];t.push(l)}}}return this.spawn(t,true).filter(e)}),"connectedEdges"),connectedNodes:gs((function(e){var t=[];var a=this;for(var n=0;n<a.length;n++){var i=a[n];if(i.isEdge()){t.push(i.source()[0]);t.push(i.target()[0])}}return this.spawn(t,true).filter(e)}),"connectedNodes"),parallelEdges:gs(defineParallelEdgesFunction(),"parallelEdges"),codirectedEdges:gs(defineParallelEdgesFunction({codirected:true}),"codirectedEdges")});function defineParallelEdgesFunction(e){var t={codirected:false};e=Y({},t,e);return function parallelEdgesImpl(t){var a=[];var n=this.edges();var i=e;for(var o=0;o<n.length;o++){var s=n[o];var l=s._private;var u=l.source;var v=u._private.data.id;var c=l.data.target;var d=u._private.edges;for(var h=0;h<d.length;h++){var p=d[h];var g=p._private.data;var y=g.target;var m=g.source;var b=y===c&&m===v;var x=v===y&&c===m;(i.codirected&&b||!i.codirected&&(b||x))&&a.push(p)}}return this.spawn(a,true).filter(t)}}Y(Ll,{components:function components(e){var t=this;var a=t.cy();var n=a.collection();var i=e==null?t.nodes():e.nodes();var components=[];e!=null&&i.empty()&&(i=e.sources());var o=function visitInComponent(e,t){n.merge(e);i.unmerge(e);t.merge(e)};if(i.empty())return t.spawn();var s=function _loop(){var e=a.collection();components.push(e);var n=i[0];o(n,e);t.bfs({directed:false,roots:n,visit:function visit(t){return o(t,e)}});e.forEach((function(a){a.connectedEdges().forEach((function(a){t.has(a)&&e.has(a.source())&&e.has(a.target())&&e.merge(a)}))}))};do{s()}while(i.length>0);return components},component:function component(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});Ll.componentsOf=Ll.components;var zl=function Collection(e,t){var a=arguments.length>2&&arguments[2]!==void 0&&arguments[2];var n=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e!==void 0){var i=new wt;var o=false;if(t){if(t.length>0&&c(t[0])&&!m(t[0])){o=true;var s=[];var l=new Tt;for(var u=0,v=t.length;u<v;u++){var d=t[u];d.data==null&&(d.data={});var h=d.data;if(h.id==null)h.id=ct();else if(e.hasElementWithId(h.id)||l.has(h.id))continue;var p=new St(e,d,false);s.push(p);l.add(h.id)}t=s}}else t=[];this.length=0;for(var g=0,y=t.length;g<y;g++){var b=t[g][0];if(b!=null){var x=b._private.data.id;if(!a||!i.has(x)){a&&i.set(x,{index:this.length,ele:b});this[this.length]=b;this.length++}}}this._private={eles:this,cy:e,get map(){this.lazyMap==null&&this.rebuildMap();return this.lazyMap},set map(e){this.lazyMap=e},rebuildMap:function rebuildMap(){var e=this.lazyMap=new wt;var t=this.eles;for(var a=0;a<t.length;a++){var n=t[a];e.set(n.id(),{index:a,ele:n})}}};a&&(this._private.map=i);o&&!n&&this.restore()}else it("A collection must have a reference to the core")};var Vl=St.prototype=zl.prototype=Object.create(Array.prototype);Vl.instanceString=function(){return"collection"};Vl.spawn=function(e,t){return new zl(this.cy(),e,t)};Vl.spawnSelf=function(){return this.spawn(this)};Vl.cy=function(){return this._private.cy};Vl.renderer=function(){return this._private.cy.renderer()};Vl.element=function(){return this[0]};Vl.collection=function(){return b(this)?this:new zl(this._private.cy,[this])};Vl.unique=function(){return new zl(this._private.cy,this,true)};Vl.hasElementWithId=function(e){e=""+e;return this._private.map.has(e)};Vl.getElementById=function(e){e=""+e;var t=this._private.cy;var a=this._private.map.get(e);return a?a.ele:new zl(t)};Vl.$id=Vl.getElementById;Vl.poolIndex=function(){var e=this._private.cy;var t=e._private.elements;var a=this[0]._private.data.id;return t._private.map.get(a).index};Vl.indexOf=function(e){var t=e[0]._private.data.id;return this._private.map.get(t).index};Vl.indexOfId=function(e){e=""+e;return this._private.map.get(e).index};Vl.json=function(e){var t=this.element();var a=this.cy();if(t==null&&e)return this;if(t!=null){var n=t._private;if(c(e)){a.startBatch();if(e.data){t.data(e.data);var i=n.data;if(t.isEdge()){var o=false;var s={};var l=e.data.source;var u=e.data.target;if(l!=null&&l!=i.source){s.source=""+l;o=true}if(u!=null&&u!=i.target){s.target=""+u;o=true}o&&(t=t.move(s))}else{var v="parent"in e.data;var d=e.data.parent;if(v&&(d!=null||i.parent!=null)&&d!=i.parent){d===void 0&&(d=null);d!=null&&(d=""+d);t=t.move({parent:d})}}}e.position&&t.position(e.position);var h=function checkSwitch(a,i,o){var s=e[a];s!=null&&s!==n[a]&&(s?t[i]():t[o]())};h("removed","remove","restore");h("selected","select","unselect");h("selectable","selectify","unselectify");h("locked","lock","unlock");h("grabbable","grabify","ungrabify");h("pannable","panify","unpanify");e.classes!=null&&t.classes(e.classes);a.endBatch();return this}if(e===void 0){var p={data:ut(n.data),position:ut(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};p.classes="";var g=0;n.classes.forEach((function(e){return p.classes+=g++===0?e:" "+e}));return p}}};Vl.jsons=function(){var e=[];for(var t=0;t<this.length;t++){var a=this[t];var n=a.json();e.push(n)}return e};Vl.clone=function(){var e=this.cy();var t=[];for(var a=0;a<this.length;a++){var n=this[a];var i=n.json();var o=new St(e,i,false);t.push(o)}return new zl(e,t)};Vl.copy=Vl.clone;Vl.restore=function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var a=this;var n=a.cy();var i=n._private;var o=[];var s=[];var u;for(var v=0,c=a.length;v<c;v++){var d=a[v];t&&!d.removed()||(d.isNode()?o.push(d):s.push(d))}u=o.concat(s);var p;var g=function removeFromElements(){u.splice(p,1);p--};for(p=0;p<u.length;p++){var y=u[p];var m=y._private;var b=m.data;y.clearTraversalCache();if(t||m.removed)if(b.id===void 0)b.id=ct();else if(h(b.id))b.id=""+b.id;else{if(T(b.id)||!l(b.id)){it("Can not create element with invalid string ID `"+b.id+"`");g();continue}if(n.hasElementWithId(b.id)){it("Can not create second element with ID `"+b.id+"`");g();continue}}else;var x=b.id;if(y.isNode()){var w=m.position;w.x==null&&(w.x=0);w.y==null&&(w.y=0)}if(y.isEdge()){var E=y;var S=["source","target"];var k=S.length;var P=false;for(var _=0;_<k;_++){var D=S[_];var I=b[D];h(I)&&(I=b[D]=""+b[D]);if(I==null||I===""){it("Can not create edge `"+x+"` with unspecified "+D);P=true}else if(!n.hasElementWithId(I)){it("Can not create edge `"+x+"` with nonexistant "+D+" `"+I+"`");P=true}}if(P){g();continue}var M=n.getElementById(b.source);var R=n.getElementById(b.target);if(M.same(R))M._private.edges.push(E);else{M._private.edges.push(E);R._private.edges.push(E)}E._private.source=M;E._private.target=R}m.map=new wt;m.map.set(x,{ele:y,index:0});m.removed=false;t&&n.addToPool(y)}for(var L=0;L<o.length;L++){var N=o[L];var O=N._private.data;h(O.parent)&&(O.parent=""+O.parent);var z=O.parent;var V=z!=null;if(V||N._private.parent){var q=N._private.parent?n.collection().merge(N._private.parent):n.getElementById(z);if(q.empty())O.parent=void 0;else if(q[0].removed()){st("Node added with missing parent, reference to parent removed");O.parent=void 0;N._private.parent=null}else{var j=false;var H=q;while(!H.empty()){if(N.same(H)){j=true;O.parent=void 0;break}H=H.parent()}if(!j){q[0]._private.children.push(N);N._private.parent=q[0];i.hasCompoundNodes=true}}}}if(u.length>0){var W=u.length===a.length?a:new zl(n,u);for(var X=0;X<W.length;X++){var Y=W[X];if(!Y.isNode()){Y.parallelEdges().clearTraversalCache();Y.source().clearTraversalCache();Y.target().clearTraversalCache()}}var G;G=i.hasCompoundNodes?n.collection().merge(W).merge(W.connectedNodes()).merge(W.parent()):W;G.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(e);e?W.emitAndNotify("add"):t&&W.emit("add")}return a};Vl.removed=function(){var e=this[0];return e&&e._private.removed};Vl.inside=function(){var e=this[0];return e&&!e._private.removed};Vl.remove=function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var a=this;var n=[];var i={};var o=a._private.cy;function addConnectedEdges(e){var t=e._private.edges;for(var a=0;a<t.length;a++)add(t[a])}function addChildren(e){var t=e._private.children;for(var a=0;a<t.length;a++)add(t[a])}function add(e){var a=i[e.id()];if(!(t&&e.removed()||a)){i[e.id()]=true;if(e.isNode()){n.push(e);addConnectedEdges(e);addChildren(e)}else n.unshift(e)}}for(var s=0,l=a.length;s<l;s++){var u=a[s];add(u)}function removeEdgeRef(e,t){var a=e._private.edges;pt(a,t);e.clearTraversalCache()}function removeParallelRef(e){e.clearTraversalCache()}var v=[];v.ids={};function removeChildRef(e,t){t=t[0];e=e[0];var a=e._private.children;var n=e.id();pt(a,t);t._private.parent=null;if(!v.ids[n]){v.ids[n]=true;v.push(e)}}a.dirtyCompoundBoundsCache();t&&o.removeFromPool(n);for(var c=0;c<n.length;c++){var d=n[c];if(d.isEdge()){var h=d.source()[0];var p=d.target()[0];removeEdgeRef(h,d);removeEdgeRef(p,d);var g=d.parallelEdges();for(var y=0;y<g.length;y++){var m=g[y];removeParallelRef(m);m.isBundledBezier()&&m.dirtyBoundingBoxCache()}}else{var b=d.parent();b.length!==0&&removeChildRef(b,d)}t&&(d._private.removed=true)}var x=o._private.elements;o._private.hasCompoundNodes=false;for(var w=0;w<x.length;w++){var E=x[w];if(E.isParent()){o._private.hasCompoundNodes=true;break}}var T=new zl(this.cy(),n);T.size()>0&&(e?T.emitAndNotify("remove"):t&&T.emit("remove"));for(var S=0;S<v.length;S++){var k=v[S];t&&k.removed()||k.updateStyle()}return T};Vl.move=function(e){var t=this._private.cy;var a=this;var n=false;var i=false;var o=function toString(e){return e==null?e:""+e};if(e.source!==void 0||e.target!==void 0){var s=o(e.source);var l=o(e.target);var u=s!=null&&t.hasElementWithId(s);var v=l!=null&&t.hasElementWithId(l);if(u||v){t.batch((function(){a.remove(n,i);a.emitAndNotify("moveout");for(var e=0;e<a.length;e++){var t=a[e];var o=t._private.data;if(t.isEdge()){u&&(o.source=s);v&&(o.target=l)}}a.restore(n,i)}));a.emitAndNotify("move")}}else if(e.parent!==void 0){var c=o(e.parent);var d=c===null||t.hasElementWithId(c);if(d){var h=c===null?void 0:c;t.batch((function(){var e=a.remove(n,i);e.emitAndNotify("moveout");for(var t=0;t<a.length;t++){var o=a[t];var s=o._private.data;o.isNode()&&(s.parent=h)}e.restore(n,i)}));a.emitAndNotify("move")}}return this};[wn,zo,Vo,ps,ys,ws,Es,ol,bl,xl,El,Tl,Pl,_l,Rl,Ll].forEach((function(e){Y(Vl,e)}));var ql={add:function add(e){var t;var a=this;if(y(e)){var n=e;if(n._private.cy===a)t=n.restore();else{var i=[];for(var o=0;o<n.length;o++){var s=n[o];i.push(s.json())}t=new zl(a,i)}}else if(v(e)){var l=e;t=new zl(a,l)}else if(c(e)&&(v(e.nodes)||v(e.edges))){var u=e;var d=[];var h=["nodes","edges"];for(var p=0,g=h.length;p<g;p++){var m=h[p];var b=u[m];if(v(b))for(var x=0,w=b.length;x<w;x++){var E=Y({group:m},b[x]);d.push(E)}}t=new zl(a,d)}else{var T=e;t=new St(a,T).collection()}return t},remove:function remove(e){if(y(e));else if(l(e)){var t=e;e=this.$(t)}return e.remove()}};function generateCubicBezier(e,t,a,n){var i=4,o=.001,s=1e-7,l=10,u=11,v=1/(u-1),c=typeof Float32Array!=="undefined";if(arguments.length!==4)return false;for(var d=0;d<4;++d)if(typeof arguments[d]!=="number"||isNaN(arguments[d])||!isFinite(arguments[d]))return false;e=Math.min(e,1);a=Math.min(a,1);e=Math.max(e,0);a=Math.max(a,0);var h=c?new Float32Array(u):new Array(u);function A(e,t){return 1-3*t+3*e}function B(e,t){return 3*t-6*e}function C(e){return 3*e}function calcBezier(e,t,a){return((A(t,a)*e+B(t,a))*e+C(t))*e}function getSlope(e,t,a){return 3*A(t,a)*e*e+2*B(t,a)*e+C(t)}function newtonRaphsonIterate(t,n){for(var o=0;o<i;++o){var s=getSlope(n,e,a);if(s===0)return n;var l=calcBezier(n,e,a)-t;n-=l/s}return n}function calcSampleValues(){for(var t=0;t<u;++t)h[t]=calcBezier(t*v,e,a)}function binarySubdivide(t,n,i){var o,u,v=0;do{u=n+(i-n)/2;o=calcBezier(u,e,a)-t;o>0?i=u:n=u}while(Math.abs(o)>s&&++v<l);return u}function getTForX(t){var n=0,i=1,s=u-1;for(;i!==s&&h[i]<=t;++i)n+=v;--i;var l=(t-h[i])/(h[i+1]-h[i]),c=n+l*v,d=getSlope(c,e,a);return d>=o?newtonRaphsonIterate(t,c):d===0?c:binarySubdivide(t,n,n+v)}var p=false;function precompute(){p=true;e===t&&a===n||calcSampleValues()}var g=function f(i){p||precompute();return e===t&&a===n?i:i===0?0:i===1?1:calcBezier(getTForX(i),t,n)};g.getControlPoints=function(){return[{x:e,y:t},{x:a,y:n}]};var y="generateBezier("+[e,t,a,n]+")";g.toString=function(){return y};return g}var jl=function(){function springAccelerationForState(e){return-e.tension*e.x-e.friction*e.v}function springEvaluateStateWithDerivative(e,t,a){var n={x:e.x+a.dx*t,v:e.v+a.dv*t,tension:e.tension,friction:e.friction};return{dx:n.v,dv:springAccelerationForState(n)}}function springIntegrateState(e,t){var a={dx:e.v,dv:springAccelerationForState(e)},n=springEvaluateStateWithDerivative(e,t*.5,a),i=springEvaluateStateWithDerivative(e,t*.5,n),o=springEvaluateStateWithDerivative(e,t,i),s=1/6*(a.dx+2*(n.dx+i.dx)+o.dx),l=1/6*(a.dv+2*(n.dv+i.dv)+o.dv);e.x=e.x+s*t;e.v=e.v+l*t;return e}return function springRK4Factory(e,t,a){var n,i,o,s={x:-1,v:0,tension:null,friction:null},l=[0],u=0,v=1e-4,c=.016;e=parseFloat(e)||500;t=parseFloat(t)||20;a=a||null;s.tension=e;s.friction=t;n=a!==null;if(n){u=springRK4Factory(e,t);i=u/a*c}else i=c;for(;;){o=springIntegrateState(o||s,i);l.push(1+o.x);u+=16;if(!(Math.abs(o.x)>v&&Math.abs(o.v)>v))break}return n?function(e){return l[e*(l.length-1)|0]}:u}}();var Hl=function cubicBezier(e,t,a,n){var i=generateCubicBezier(e,t,a,n);return function(e,t,a){return e+(t-e)*i(a)}};var Wl={linear:function linear(e,t,a){return e+(t-e)*a},ease:Hl(.25,.1,.25,1),"ease-in":Hl(.42,0,1,1),"ease-out":Hl(0,0,.58,1),"ease-in-out":Hl(.42,0,.58,1),"ease-in-sine":Hl(.47,0,.745,.715),"ease-out-sine":Hl(.39,.575,.565,1),"ease-in-out-sine":Hl(.445,.05,.55,.95),"ease-in-quad":Hl(.55,.085,.68,.53),"ease-out-quad":Hl(.25,.46,.45,.94),"ease-in-out-quad":Hl(.455,.03,.515,.955),"ease-in-cubic":Hl(.55,.055,.675,.19),"ease-out-cubic":Hl(.215,.61,.355,1),"ease-in-out-cubic":Hl(.645,.045,.355,1),"ease-in-quart":Hl(.895,.03,.685,.22),"ease-out-quart":Hl(.165,.84,.44,1),"ease-in-out-quart":Hl(.77,0,.175,1),"ease-in-quint":Hl(.755,.05,.855,.06),"ease-out-quint":Hl(.23,1,.32,1),"ease-in-out-quint":Hl(.86,0,.07,1),"ease-in-expo":Hl(.95,.05,.795,.035),"ease-out-expo":Hl(.19,1,.22,1),"ease-in-out-expo":Hl(1,0,0,1),"ease-in-circ":Hl(.6,.04,.98,.335),"ease-out-circ":Hl(.075,.82,.165,1),"ease-in-out-circ":Hl(.785,.135,.15,.86),spring:function spring(e,t,a){if(a===0)return Wl.linear;var spring=jl(e,t,a);return function(e,t,a){return e+(t-e)*spring(a)}},"cubic-bezier":Hl};function getEasedValue(e,t,a,n,i){if(n===1)return a;if(t===a)return a;var o=i(t,a,n);if(e==null)return o;(e.roundValue||e.color)&&(o=Math.round(o));e.min!==void 0&&(o=Math.max(o,e.min));e.max!==void 0&&(o=Math.min(o,e.max));return o}function getValue(e,t){return e.pfValue!=null||e.value!=null?e.pfValue==null||t!=null&&t.type.units==="%"?e.value:e.pfValue:e}function ease(e,t,a,n,i){var o=i!=null?i.type:null;a<0?a=0:a>1&&(a=1);var s=getValue(e,i);var l=getValue(t,i);if(h(s)&&h(l))return getEasedValue(o,s,l,a,n);if(v(s)&&v(l)){var u=[];for(var c=0;c<l.length;c++){var d=s[c];var p=l[c];if(d!=null&&p!=null){var g=getEasedValue(o,d,p,a,n);u.push(g)}else u.push(p)}return u}}function step$1(e,t,a,n){var i=!n;var o=e._private;var s=t._private;var u=s.easing;var v=s.startTime;var c=n?e:e.cy();var d=c.style();if(!s.easingImpl)if(u==null)s.easingImpl=Wl.linear;else{var h;if(l(u)){var p=d.parse("transition-timing-function",u);h=p.value}else h=u;var g,y;if(l(h)){g=h;y=[]}else{g=h[1];y=h.slice(2).map((function(e){return+e}))}if(y.length>0){g==="spring"&&y.push(s.duration);s.easingImpl=Wl[g].apply(null,y)}else s.easingImpl=Wl[g]}var m=s.easingImpl;var b;b=s.duration===0?1:(a-v)/s.duration;s.applying&&(b=s.progress);b<0?b=0:b>1&&(b=1);if(s.delay==null){var x=s.startPosition;var w=s.position;if(w&&i&&!e.locked()){var E={};valid(x.x,w.x)&&(E.x=ease(x.x,w.x,b,m));valid(x.y,w.y)&&(E.y=ease(x.y,w.y,b,m));e.position(E)}var T=s.startPan;var S=s.pan;var k=o.pan;var P=S!=null&&n;if(P){valid(T.x,S.x)&&(k.x=ease(T.x,S.x,b,m));valid(T.y,S.y)&&(k.y=ease(T.y,S.y,b,m));e.emit("pan")}var _=s.startZoom;var D=s.zoom;var I=D!=null&&n;if(I){valid(_,D)&&(o.zoom=dr(o.minZoom,ease(_,D,b,m),o.maxZoom));e.emit("zoom")}(P||I)&&e.emit("viewport");var M=s.style;if(M&&M.length>0&&i){for(var R=0;R<M.length;R++){var L=M[R];var N=L.name;var O=L;var z=s.startStyle[N];var V=d.properties[z.name];var q=ease(z,O,b,m,V);d.overrideBypass(e,N,q)}e.emit("style")}}s.progress=b;return b}function valid(e,t){return e!=null&&t!=null&&(!(!h(e)||!h(t))||!(!e||!t))}function startAnimation(e,t,a,n){var i=t._private;i.started=true;i.startTime=a-i.progress*i.duration}function stepAll(e,t){var a=t._private.aniEles;var n=[];function stepOne(t,a){var i=t._private;var o=i.animation.current;var s=i.animation.queue;var l=false;if(o.length===0){var u=s.shift();u&&o.push(u)}var v=function callbacks(e){for(var t=e.length-1;t>=0;t--){var a=e[t];a()}e.splice(0,e.length)};for(var c=o.length-1;c>=0;c--){var d=o[c];var h=d._private;if(h.stopped){o.splice(c,1);h.hooked=false;h.playing=false;h.started=false;v(h.frames)}else if(h.playing||h.applying){h.playing&&h.applying&&(h.applying=false);h.started||startAnimation(t,d,e);step$1(t,d,e,a);h.applying&&(h.applying=false);v(h.frames);h.step!=null&&h.step(e);if(d.completed()){o.splice(c,1);h.hooked=false;h.playing=false;h.started=false;v(h.completes)}l=true}}a||o.length!==0||s.length!==0||n.push(t);return l}var i=false;for(var o=0;o<a.length;o++){var s=a[o];var l=stepOne(s);i=i||l}var u=stepOne(t,true);(i||u)&&(a.length>0?t.notify("draw",a):t.notify("draw"));a.unmerge(n);t.emit("step")}var Xl={animate:Fo.animate(),animation:Fo.animation(),animated:Fo.animated(),clearQueue:Fo.clearQueue(),delay:Fo.delay(),delayAnimation:Fo.delayAnimation(),stop:Fo.stop(),addToAnimationPool:function addToAnimationPool(e){var t=this;t.styleEnabled()&&t._private.aniEles.merge(e)},stopAnimationLoop:function stopAnimationLoop(){this._private.animationsRunning=false},startAnimationLoop:function startAnimationLoop(){var e=this;e._private.animationsRunning=true;if(e.styleEnabled()){var t=e.renderer();t&&t.beforeRender?t.beforeRender((function rendererAnimationStep(t,a){stepAll(a,e)}),t.beforeRenderPriorities.animations):headlessStep()}function headlessStep(){e._private.animationsRunning&&Ne((function animationStep(t){stepAll(t,e);headlessStep()}))}}};var Yl={qualifierCompare:function qualifierCompare(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function eventMatches(e,t,a){var n=t.qualifier;return n==null||e!==a.target&&m(a.target)&&n.matches(a.target)},addEventFields:function addEventFields(e,t){t.cy=e;t.target=e},callbackContext:function callbackContext(e,t,a){return t.qualifier!=null?a.target:e}};var Gl=function argSelector(e){return l(e)?new hs(e):e};var Kl={createEmitter:function createEmitter(){var e=this._private;e.emitter||(e.emitter=new Emitter(Yl,this));return this},emitter:function emitter(){return this._private.emitter},on:function on(e,t,a){this.emitter().on(e,Gl(t),a);return this},removeListener:function removeListener(e,t,a){this.emitter().removeListener(e,Gl(t),a);return this},removeAllListeners:function removeAllListeners(){this.emitter().removeAllListeners();return this},one:function one(e,t,a){this.emitter().one(e,Gl(t),a);return this},once:function once(e,t,a){this.emitter().one(e,Gl(t),a);return this},emit:function emit(e,t){this.emitter().emit(e,t);return this},emitAndNotify:function emitAndNotify(e,t){this.emit(e);this.notify(e,t);return this}};Fo.eventAliasesOn(Kl);var Ul={png:function png(e){var t=this._private.renderer;e=e||{};return t.png(e)},jpg:function jpg(e){var t=this._private.renderer;e=e||{};e.bg=e.bg||"#fff";return t.jpg(e)}};Ul.jpeg=Ul.jpg;var Zl={layout:function layout(e){var t=this;if(e!=null)if(e.name!=null){var a=e.name;var n=t.extension("layout",a);if(n!=null){var i;i=l(e.eles)?t.$(e.eles):e.eles!=null?e.eles:t.$();var layout=new n(Y({},e,{cy:t,eles:i}));return layout}it("No such layout `"+a+"` found.  Did you forget to import it and `cytoscape.use()` it?")}else it("A `name` must be specified to make a layout");else it("Layout options must be specified to make a layout")}};Zl.createLayout=Zl.makeLayout=Zl.layout;var $l={notify:function notify(e,t){var a=this._private;if(this.batching()){a.batchNotifications=a.batchNotifications||{};var n=a.batchNotifications[e]=a.batchNotifications[e]||this.collection();t!=null&&n.merge(t)}else if(a.notificationsEnabled){var i=this.renderer();!this.destroyed()&&i&&i.notify(e,t)}},notifications:function notifications(e){var t=this._private;if(e===void 0)return t.notificationsEnabled;t.notificationsEnabled=!!e;return this},noNotifications:function noNotifications(e){this.notifications(false);e();this.notifications(true)},batching:function batching(){return this._private.batchCount>0},startBatch:function startBatch(){var e=this._private;e.batchCount==null&&(e.batchCount=0);if(e.batchCount===0){e.batchStyleEles=this.collection();e.batchNotifications={}}e.batchCount++;return this},endBatch:function endBatch(){var e=this._private;if(e.batchCount===0)return this;e.batchCount--;if(e.batchCount===0){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach((function(a){var n=e.batchNotifications[a];n.empty()?t.notify(a):t.notify(a,n)}))}return this},batch:function batch(e){this.startBatch();e();this.endBatch();return this},batchData:function batchData(e){var t=this;return this.batch((function(){var a=Object.keys(e);for(var n=0;n<a.length;n++){var i=a[n];var o=e[i];var s=t.getElementById(i);s.data(o)}}))}};var Ql=ft({hideEdgesOnViewport:false,textureOnViewport:false,motionBlur:false,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:false,showFps:false,webgl:false,webglDebug:false,webglDebugShowAtlases:false,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]});var Jl={renderTo:function renderTo(e,t,a,n){var i=this._private.renderer;i.renderTo(e,t,a,n);return this},renderer:function renderer(){return this._private.renderer},forceRender:function forceRender(){this.notify("draw");return this},resize:function resize(){this.invalidateSize();this.emitAndNotify("resize");return this},initRenderer:function initRenderer(e){var t=this;var a=t.extension("renderer",e.name);if(a!=null){e.wheelSensitivity!==void 0&&st("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var n=Ql(e);n.cy=t;t._private.renderer=new a(n);this.notify("init")}else it("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"))},destroyRenderer:function destroyRenderer(){var e=this;e.notify("destroy");var t=e.container();if(t){t._cyreg=null;while(t.childNodes.length>0)t.removeChild(t.childNodes[0])}e._private.renderer=null;e.mutableElements().forEach((function(e){var t=e._private;t.rscratch={};t.rstyle={};t.animation.current=[];t.animation.queue=[]}))},onRender:function onRender(e){return this.on("render",e)},offRender:function offRender(e){return this.off("render",e)}};Jl.invalidateDimensions=Jl.resize;var eu={collection:function collection(e,t){if(l(e))return this.$(e);if(y(e))return e.collection();if(v(e)){t||(t={});return new zl(this,e,t.unique,t.removed)}return new zl(this)},nodes:function nodes(e){var nodes=this.$((function(e){return e.isNode()}));return e?nodes.filter(e):nodes},edges:function edges(e){var edges=this.$((function(e){return e.isEdge()}));return e?edges.filter(e):edges},$:function $(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function mutableElements(){return this._private.elements}};eu.elements=eu.filter=eu.$;var tu={};var ru="t";var au="f";tu.apply=function(e){var t=this;var a=t._private;var n=a.cy;var i=n.collection();for(var o=0;o<e.length;o++){var s=e[o];var l=t.getContextMeta(s);if(!l.empty){var u=t.getContextStyle(l);var v=t.applyContextStyle(l,u,s);s._private.appliedInitStyle?t.updateTransitions(s,v.diffProps):s._private.appliedInitStyle=true;var c=t.updateStyleHints(s);c&&i.push(s)}}return i};tu.getPropertiesDiff=function(e,t){var a=this;var n=a._private.propDiffs=a._private.propDiffs||{};var i=e+"-"+t;var o=n[i];if(o)return o;var s=[];var l={};for(var u=0;u<a.length;u++){var v=a[u];var c=e[u]===ru;var d=t[u]===ru;var h=c!==d;var p=v.mappedProperties.length>0;if(h||d&&p){var g=void 0;h&&p||h?g=v.properties:p&&(g=v.mappedProperties);for(var y=0;y<g.length;y++){var m=g[y];var b=m.name;var x=false;for(var w=u+1;w<a.length;w++){var E=a[w];var T=t[w]===ru;if(T){x=E.properties[m.name]!=null;if(x)break}}if(!l[b]&&!x){l[b]=true;s.push(b)}}}}n[i]=s;return s};tu.getContextMeta=function(e){var t=this;var a="";var n;var i=e._private.styleCxtKey||"";for(var o=0;o<t.length;o++){var s=t[o];var l=s.selector&&s.selector.matches(e);a+=l?ru:au}n=t.getPropertiesDiff(i,a);e._private.styleCxtKey=a;return{key:a,diffPropNames:n,empty:n.length===0}};tu.getContextStyle=function(e){var t=e.key;var a=this;var n=this._private.contextStyles=this._private.contextStyles||{};if(n[t])return n[t];var i={_private:{key:t}};for(var o=0;o<a.length;o++){var s=a[o];var l=t[o]===ru;if(l)for(var u=0;u<s.properties.length;u++){var v=s.properties[u];i[v.name]=v}}n[t]=i;return i};tu.applyContextStyle=function(e,t,a){var n=this;var i=e.diffPropNames;var o={};var s=n.types;for(var l=0;l<i.length;l++){var u=i[l];var v=t[u];var c=a.pstyle(u);if(!v){if(!c)continue;v=c.bypass?{name:u,deleteBypassed:true}:{name:u,delete:true}}if(c!==v){if(v.mapped===s.fn&&c!=null&&c.mapping!=null&&c.mapping.value===v.value){var d=c.mapping;var h=d.fnValue=v.value(a);if(h===d.prevFnValue)continue}var p=o[u]={prev:c};n.applyParsedProperty(a,v);p.next=a.pstyle(u);p.next&&p.next.bypass&&(p.next=p.next.bypassed)}}return{diffProps:o}};tu.updateStyleHints=function(e){var t=e._private;var a=this;var n=a.propertyGroupNames;var i=a.propertyGroupKeys;var o=function propHash(e,t,n){return a.getPropertiesHash(e,t,n)};var s=t.styleKey;if(e.removed())return false;var l=t.group==="nodes";var u=e._private.style;n=Object.keys(u);for(var v=0;v<i.length;v++){var c=i[v];t.styleKeys[c]=[Fe,Ve]}var d=function updateGrKey1(e,a){return t.styleKeys[a][0]=je(e,t.styleKeys[a][0])};var h=function updateGrKey2(e,a){return t.styleKeys[a][1]=He(e,t.styleKeys[a][1])};var p=function updateGrKey(e,t){d(e,t);h(e,t)};var g=function updateGrKeyWStr(e,t){for(var a=0;a<e.length;a++){var n=e.charCodeAt(a);d(n,t);h(n,t)}};var y=2e9;var m=function cleanNum(e){return-128<e&&e<128&&Math.floor(e)!==e?y-(e*1024|0):e};for(var b=0;b<n.length;b++){var x=n[b];var w=u[x];if(w!=null){var E=this.properties[x];var T=E.type;var S=E.groupKey;var k=void 0;E.hashOverride!=null?k=E.hashOverride(e,w):w.pfValue!=null&&(k=w.pfValue);var P=E.enums==null?w.value:null;var _=k!=null;var D=P!=null;var I=_||D;var M=w.units;if(T.number&&I&&!T.multiple){var R=_?k:P;p(m(R),S);_||M==null||g(M,S)}else g(w.strValue,S)}}var L=[Fe,Ve];for(var N=0;N<i.length;N++){var O=i[N];var z=t.styleKeys[O];L[0]=je(z[0],L[0]);L[1]=He(z[1],L[1])}t.styleKey=We(L[0],L[1]);var V=t.styleKeys;t.labelDimsKey=Xe(V.labelDimensions);var q=o(e,["label"],V.labelDimensions);t.labelKey=Xe(q);t.labelStyleKey=Xe(Ye(V.commonLabel,q));if(!l){var j=o(e,["source-label"],V.labelDimensions);t.sourceLabelKey=Xe(j);t.sourceLabelStyleKey=Xe(Ye(V.commonLabel,j));var H=o(e,["target-label"],V.labelDimensions);t.targetLabelKey=Xe(H);t.targetLabelStyleKey=Xe(Ye(V.commonLabel,H))}if(l){var W=t.styleKeys,X=W.nodeBody,Y=W.nodeBorder,G=W.nodeOutline,K=W.backgroundImage,U=W.compound,Z=W.pie;var Q=[X,Y,G,K,U,Z].filter((function(e){return e!=null})).reduce(Ye,[Fe,Ve]);t.nodeKey=Xe(Q);t.hasPie=Z!=null&&Z[0]!==Fe&&Z[1]!==Ve}return s!==t.styleKey};tu.clearStyleHints=function(e){var t=e._private;t.styleCxtKey="";t.styleKeys={};t.styleKey=null;t.labelKey=null;t.labelStyleKey=null;t.sourceLabelKey=null;t.sourceLabelStyleKey=null;t.targetLabelKey=null;t.targetLabelStyleKey=null;t.nodeKey=null;t.hasPie=null};tu.applyParsedProperty=function(e,t){var a=this;var n=t;var i=e._private.style;var o;var s=a.types;var l=a.properties[n.name].type;var u=n.bypass;var v=i[n.name];var c=v&&v.bypass;var d=e._private;var p="mapping";var g=function getVal(e){return e==null?null:e.pfValue!=null?e.pfValue:e.value};var y=function checkTriggers(){var t=g(v);var i=g(n);a.checkTriggers(e,n.name,t,i)};t.name==="curve-style"&&e.isEdge()&&(t.value!=="bezier"&&e.isLoop()||t.value==="haystack"&&(e.source().isParent()||e.target().isParent()))&&(n=t=this.parse(t.name,"bezier",u));if(n.delete){i[n.name]=void 0;y();return true}if(n.deleteBypassed){if(v){if(v.bypass){v.bypassed=void 0;y();return true}return false}y();return true}if(n.deleteBypass){if(v){if(v.bypass){i[n.name]=v.bypassed;y();return true}return false}y();return true}var m=function printMappingErr(){st("Do not assign mappings to elements without corresponding data (i.e. ele `"+e.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case s.mapData:var b=n.field.split(".");var x=d.data;for(var w=0;w<b.length&&x;w++){var E=b[w];x=x[E]}if(x==null){m();return false}var T;if(!h(x)){st("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+x+"` for `"+e.id()+"` is non-numeric)");return false}var S=n.fieldMax-n.fieldMin;T=S===0?0:(x-n.fieldMin)/S;T<0?T=0:T>1&&(T=1);if(l.color){var k=n.valueMin[0];var P=n.valueMax[0];var _=n.valueMin[1];var D=n.valueMax[1];var I=n.valueMin[2];var M=n.valueMax[2];var R=n.valueMin[3]==null?1:n.valueMin[3];var L=n.valueMax[3]==null?1:n.valueMax[3];var N=[Math.round(k+(P-k)*T),Math.round(_+(D-_)*T),Math.round(I+(M-I)*T),Math.round(R+(L-R)*T)];o={bypass:n.bypass,name:n.name,value:N,strValue:"rgb("+N[0]+", "+N[1]+", "+N[2]+")"}}else{if(!l.number)return false;var O=n.valueMin+(n.valueMax-n.valueMin)*T;o=this.parse(n.name,O,n.bypass,p)}if(!o){m();return false}o.mapping=n;n=o;break;case s.data:var z=n.field.split(".");var V=d.data;for(var q=0;q<z.length&&V;q++){var j=z[q];V=V[j]}V!=null&&(o=this.parse(n.name,V,n.bypass,p));if(!o){m();return false}o.mapping=n;n=o;break;case s.fn:var H=n.value;var W=n.fnValue!=null?n.fnValue:H(e);n.prevFnValue=W;if(W==null){st("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+e.id()+"` is null)");return false}o=this.parse(n.name,W,n.bypass,p);if(!o){st("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+e.id()+"` is invalid)");return false}o.mapping=ut(n);n=o;break;case void 0:break;default:return false}if(u){n.bypassed=c?v.bypassed:v;i[n.name]=n}else c?v.bypassed=n:i[n.name]=n;y();return true};tu.cleanElements=function(e,t){for(var a=0;a<e.length;a++){var n=e[a];this.clearStyleHints(n);n.dirtyCompoundBoundsCache();n.dirtyBoundingBoxCache();if(t){var i=n._private.style;var o=Object.keys(i);for(var s=0;s<o.length;s++){var l=o[s];var u=i[l];u!=null&&(u.bypass?u.bypassed=null:i[l]=null)}}else n._private.style={}}};tu.update=function(){var e=this._private.cy;var t=e.mutableElements();t.updateStyle()};tu.updateTransitions=function(e,t){var a=this;var n=e._private;var i=e.pstyle("transition-property").value;var o=e.pstyle("transition-duration").pfValue;var s=e.pstyle("transition-delay").pfValue;if(i.length>0&&o>0){var l={};var u=false;for(var c=0;c<i.length;c++){var d=i[c];var p=e.pstyle(d);var g=t[d];if(g){var y=g.prev;var m=y;var b=g.next!=null?g.next:p;var x=false;var w=void 0;var E=1e-6;if(m){if(h(m.pfValue)&&h(b.pfValue)){x=b.pfValue-m.pfValue;w=m.pfValue+E*x}else if(h(m.value)&&h(b.value)){x=b.value-m.value;w=m.value+E*x}else if(v(m.value)&&v(b.value)){x=m.value[0]!==b.value[0]||m.value[1]!==b.value[1]||m.value[2]!==b.value[2];w=m.strValue}if(x){l[d]=b.strValue;this.applyBypass(e,d,w);u=true}}}}if(!u)return;n.transitioning=true;new Bn((function(t){s>0?e.delayAnimation(s).play().promise().then(t):t()})).then((function(){return e.animation({style:l,duration:o,easing:e.pstyle("transition-timing-function").value,queue:false}).play().promise()})).then((function(){a.removeBypasses(e,i);e.emitAndNotify("style");n.transitioning=false}))}else if(n.transitioning){this.removeBypasses(e,i);e.emitAndNotify("style");n.transitioning=false}};tu.checkTrigger=function(e,t,a,n,i,o){var s=this.properties[t];var l=i(s);e.removed()||l!=null&&l(a,n,e)&&o(s)};tu.checkZOrderTrigger=function(e,t,a,n){var i=this;this.checkTrigger(e,t,a,n,(function(e){return e.triggersZOrder}),(function(){i._private.cy.notify("zorder",e)}))};tu.checkBoundsTrigger=function(e,t,a,n){this.checkTrigger(e,t,a,n,(function(e){return e.triggersBounds}),(function(t){e.dirtyCompoundBoundsCache();e.dirtyBoundingBoxCache()}))};tu.checkConnectedEdgesBoundsTrigger=function(e,t,a,n){this.checkTrigger(e,t,a,n,(function(e){return e.triggersBoundsOfConnectedEdges}),(function(t){e.connectedEdges().forEach((function(e){e.dirtyBoundingBoxCache()}))}))};tu.checkParallelEdgesBoundsTrigger=function(e,t,a,n){this.checkTrigger(e,t,a,n,(function(e){return e.triggersBoundsOfParallelEdges}),(function(t){e.parallelEdges().forEach((function(e){e.dirtyBoundingBoxCache()}))}))};tu.checkTriggers=function(e,t,a,n){e.dirtyStyleCache();this.checkZOrderTrigger(e,t,a,n);this.checkBoundsTrigger(e,t,a,n);this.checkConnectedEdgesBoundsTrigger(e,t,a,n);this.checkParallelEdgesBoundsTrigger(e,t,a,n)};var nu={};nu.applyBypass=function(e,t,a,n){var i=this;var o=[];var s=true;if(t==="*"||t==="**"){if(a!==void 0)for(var u=0;u<i.properties.length;u++){var v=i.properties[u];var d=v.name;var h=this.parse(d,a,true);h&&o.push(h)}}else if(l(t)){var p=this.parse(t,a,true);p&&o.push(p)}else{if(!c(t))return false;var g=t;n=a;var y=Object.keys(g);for(var m=0;m<y.length;m++){var b=y[m];var x=g[b];x===void 0&&(x=g[M(b)]);if(x!==void 0){var w=this.parse(b,x,true);w&&o.push(w)}}}if(o.length===0)return false;var E=false;for(var T=0;T<e.length;T++){var S=e[T];var k={};var P=void 0;for(var _=0;_<o.length;_++){var D=o[_];if(n){var I=S.pstyle(D.name);P=k[D.name]={prev:I}}E=this.applyParsedProperty(S,ut(D))||E;n&&(P.next=S.pstyle(D.name))}E&&this.updateStyleHints(S);n&&this.updateTransitions(S,k,s)}return E};nu.overrideBypass=function(e,t,a){t=I(t);for(var n=0;n<e.length;n++){var i=e[n];var o=i._private.style[t];var s=this.properties[t].type;var l=s.color;var u=s.mutiple;var v=o?o.pfValue!=null?o.pfValue:o.value:null;if(o&&o.bypass){o.value=a;o.pfValue!=null&&(o.pfValue=a);o.strValue=l?"rgb("+a.join(",")+")":u?a.join(" "):""+a;this.updateStyleHints(i)}else this.applyBypass(i,t,a);this.checkTriggers(i,t,v,a)}};nu.removeAllBypasses=function(e,t){return this.removeBypasses(e,this.propertyNames,t)};nu.removeBypasses=function(e,t,a){var n=true;for(var i=0;i<e.length;i++){var o=e[i];var s={};for(var l=0;l<t.length;l++){var u=t[l];var v=this.properties[u];var c=o.pstyle(v.name);if(c&&c.bypass){var d="";var h=this.parse(u,d,true);var p=s[v.name]={prev:c};this.applyParsedProperty(o,h);p.next=o.pstyle(v.name)}}this.updateStyleHints(o);a&&this.updateTransitions(o,s,n)}};var iu={};iu.getEmSizeInPixels=function(){var e=this.containerCss("font-size");return e!=null?parseFloat(e):1};iu.containerCss=function(e){var t=this._private.cy;var a=t.container();var n=t.window();if(n&&a&&n.getComputedStyle)return n.getComputedStyle(a).getPropertyValue(e)};var ou={};ou.getRenderedStyle=function(e,t){return t?this.getStylePropertyValue(e,t,true):this.getRawStyle(e,true)};ou.getRawStyle=function(e,t){var a=this;e=e[0];if(e){var n={};for(var i=0;i<a.properties.length;i++){var o=a.properties[i];var s=a.getStylePropertyValue(e,o.name,t);if(s!=null){n[o.name]=s;n[M(o.name)]=s}}return n}};ou.getIndexedStyle=function(e,t,a,n){var i=e.pstyle(t)[a][n];return i!=null?i:e.cy().style().getDefaultProperty(t)[a][0]};ou.getStylePropertyValue=function(e,t,a){var n=this;e=e[0];if(e){var i=n.properties[t];i.alias&&(i=i.pointsTo);var o=i.type;var s=e.pstyle(i.name);if(s){var u=s.value,c=s.units,d=s.strValue;if(a&&o.number&&u!=null&&h(u)){var p=e.cy().zoom();var g=function getRenderedValue(e){return e*p};var y=function getValueStringWithUnits(e,t){return g(e)+t};var m=v(u);var b=m?c.every((function(e){return e!=null})):c!=null;return b?m?u.map((function(e,t){return y(e,c[t])})).join(" "):y(u,c):m?u.map((function(e){return l(e)?e:""+g(e)})).join(" "):""+g(u)}if(d!=null)return d}return null}};ou.getAnimationStartStyle=function(e,t){var a={};for(var n=0;n<t.length;n++){var i=t[n];var o=i.name;var s=e.pstyle(o);s!==void 0&&(s=c(s)?this.parse(o,s.strValue):this.parse(o,s));s&&(a[o]=s)}return a};ou.getPropsList=function(e){var t=this;var a=[];var n=e;var i=t.properties;if(n){var o=Object.keys(n);for(var s=0;s<o.length;s++){var l=o[s];var u=n[l];var v=i[l]||i[I(l)];var c=this.parse(v.name,u);c&&a.push(c)}}return a};ou.getNonDefaultPropertiesHash=function(e,t,a){var n=a.slice();var i,o,s,l;var u,v;for(u=0;u<t.length;u++){i=t[u];o=e.pstyle(i,false);if(o!=null)if(o.pfValue!=null){n[0]=je(l,n[0]);n[1]=He(l,n[1])}else{s=o.strValue;for(v=0;v<s.length;v++){l=s.charCodeAt(v);n[0]=je(l,n[0]);n[1]=He(l,n[1])}}}return n};ou.getPropertiesHash=ou.getNonDefaultPropertiesHash;var su={};su.appendFromJson=function(e){var t=this;for(var a=0;a<e.length;a++){var n=e[a];var i=n.selector;var o=n.style||n.css;var s=Object.keys(o);t.selector(i);for(var l=0;l<s.length;l++){var u=s[l];var v=o[u];t.css(u,v)}}return t};su.fromJson=function(e){var t=this;t.resetToDefault();t.appendFromJson(e);return t};su.json=function(){var e=[];for(var t=this.defaultLength;t<this.length;t++){var a=this[t];var n=a.selector;var i=a.properties;var o={};for(var s=0;s<i.length;s++){var l=i[s];o[l.name]=l.strValue}e.push({selector:n?n.toString():"core",style:o})}return e};var lu={};lu.appendFromString=function(e){var t=this;var a=this;var n=""+e;var i;var o;var s;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function removeSelAndBlockFromRemaining(){n=n.length>i.length?n.substr(i.length):""}function removePropAndValFromRem(){o=o.length>s.length?o.substr(s.length):""}for(;;){var l=n.match(/^\s*$/);if(l)break;var u=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!u){st("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=u[0];var v=u[1];if(v!=="core"){var c=new hs(v);if(c.invalid){st("Skipping parsing of block: Invalid selector found in string stylesheet: "+v);removeSelAndBlockFromRemaining();continue}}var d=u[2];var h=false;o=d;var p=[];for(;;){var g=o.match(/^\s*$/);if(g)break;var y=o.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!y){st("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+d);h=true;break}s=y[0];var m=y[1];var b=y[2];var x=t.properties[m];if(x){var w=a.parse(m,b);if(w){p.push({name:m,val:b});removePropAndValFromRem()}else{st("Skipping property: Invalid property definition in: "+s);removePropAndValFromRem()}}else{st("Skipping property: Invalid property name in: "+s);removePropAndValFromRem()}}if(h){removeSelAndBlockFromRemaining();break}a.selector(v);for(var E=0;E<p.length;E++){var T=p[E];a.css(T.name,T.val)}removeSelAndBlockFromRemaining()}return a};lu.fromString=function(e){var t=this;t.resetToDefault();t.appendFromString(e);return t};var uu={};(function(){var e=N;var t=z;var a=q;var n=j;var i=H;var o=function data(e){return"^"+e+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"};var s=function mapData(o){var s=e+"|\\w+|"+t+"|"+a+"|"+n+"|"+i;return"^"+o+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+e+")\\s*\\,\\s*("+e+")\\s*,\\s*("+s+")\\s*\\,\\s*("+s+")\\)$"};var u=["^url\\s*\\(\\s*['\"]?(.+?)['\"]?\\s*\\)$","^(none)$","^(.+)$"];uu.types={time:{number:true,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:true,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:true,min:0,max:100,units:"%",implicitUnits:"%",multiple:true},zeroOneNumber:{number:true,min:0,max:1,unitless:true},zeroOneNumbers:{number:true,min:0,max:1,unitless:true,multiple:true},nOneOneNumber:{number:true,min:-1,max:1,unitless:true},nonNegativeInt:{number:true,min:0,integer:true,unitless:true},nonNegativeNumber:{number:true,min:0,unitless:true},position:{enums:["parent","origin"]},nodeSize:{number:true,min:0,enums:["label"]},number:{number:true,unitless:true},numbers:{number:true,unitless:true,multiple:true},positiveNumber:{number:true,unitless:true,min:0,strictMin:true},size:{number:true,min:0},bidirectionalSize:{number:true},bidirectionalSizeMaybePercent:{number:true,allowPercent:true},bidirectionalSizes:{number:true,multiple:true},sizeMaybePercent:{number:true,min:0,allowPercent:true},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:true,min:0,allowPercent:true,enums:["auto"],multiple:true},bgPos:{number:true,allowPercent:true,multiple:true},bgRelativeTo:{enums:["inner","include-padding"],multiple:true},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:true},bgFit:{enums:["none","contain","cover"],multiple:true},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:true},bgClip:{enums:["none","node"],multiple:true},bgContainment:{enums:["inside","over"],multiple:true},color:{color:true},colors:{color:true,multiple:true},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:true},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:true},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:true,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:true,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:true},data:{mapping:true,regex:o("data")},layoutData:{mapping:true,regex:o("layoutData")},scratch:{mapping:true,regex:o("scratch")},mapData:{mapping:true,regex:s("mapData")},mapLayoutData:{mapping:true,regex:s("mapLayoutData")},mapScratch:{mapping:true,regex:s("mapScratch")},fn:{mapping:true,fn:true},url:{regexes:u,singleRegexMatchValue:true},urls:{regexes:u,singleRegexMatchValue:true,multiple:true},propList:{propList:true},angle:{number:true,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:true,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:true,multiple:true,evenMultiple:true,min:-1,max:1,unitless:true},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:true,multiple:true,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:true,validate:function validate(e,t){switch(e.length){case 2:return t[0]!=="deg"&&t[0]!=="rad"&&t[1]!=="deg"&&t[1]!=="rad";case 1:return l(e[0])||t[0]==="deg"||t[0]==="rad";default:return false}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:true,multiple:true,min:0,validate:function validate(e){var t=e.length;return t===1||t===2||t===4}}};var v={zeroNonZero:function zeroNonZero(e,t){return(e==null||t==null)&&e!==t||(e==0&&t!=0||e!=0&&t==0)},any:function any(e,t){return e!=t},emptyNonEmpty:function emptyNonEmpty(e,t){var a=T(e);var n=T(t);return a&&!n||!a&&n}};var c=uu.types;var d=[{name:"label",type:c.text,triggersBounds:v.any,triggersZOrder:v.emptyNonEmpty},{name:"text-rotation",type:c.textRotation,triggersBounds:v.any},{name:"text-margin-x",type:c.bidirectionalSize,triggersBounds:v.any},{name:"text-margin-y",type:c.bidirectionalSize,triggersBounds:v.any}];var h=[{name:"source-label",type:c.text,triggersBounds:v.any},{name:"source-text-rotation",type:c.textRotation,triggersBounds:v.any},{name:"source-text-margin-x",type:c.bidirectionalSize,triggersBounds:v.any},{name:"source-text-margin-y",type:c.bidirectionalSize,triggersBounds:v.any},{name:"source-text-offset",type:c.size,triggersBounds:v.any}];var p=[{name:"target-label",type:c.text,triggersBounds:v.any},{name:"target-text-rotation",type:c.textRotation,triggersBounds:v.any},{name:"target-text-margin-x",type:c.bidirectionalSize,triggersBounds:v.any},{name:"target-text-margin-y",type:c.bidirectionalSize,triggersBounds:v.any},{name:"target-text-offset",type:c.size,triggersBounds:v.any}];var g=[{name:"font-family",type:c.fontFamily,triggersBounds:v.any},{name:"font-style",type:c.fontStyle,triggersBounds:v.any},{name:"font-weight",type:c.fontWeight,triggersBounds:v.any},{name:"font-size",type:c.size,triggersBounds:v.any},{name:"text-transform",type:c.textTransform,triggersBounds:v.any},{name:"text-wrap",type:c.textWrap,triggersBounds:v.any},{name:"text-overflow-wrap",type:c.textOverflowWrap,triggersBounds:v.any},{name:"text-max-width",type:c.size,triggersBounds:v.any},{name:"text-outline-width",type:c.size,triggersBounds:v.any},{name:"line-height",type:c.positiveNumber,triggersBounds:v.any}];var y=[{name:"text-valign",type:c.valign,triggersBounds:v.any},{name:"text-halign",type:c.halign,triggersBounds:v.any},{name:"color",type:c.color},{name:"text-outline-color",type:c.color},{name:"text-outline-opacity",type:c.zeroOneNumber},{name:"text-background-color",type:c.color},{name:"text-background-opacity",type:c.zeroOneNumber},{name:"text-background-padding",type:c.size,triggersBounds:v.any},{name:"text-border-opacity",type:c.zeroOneNumber},{name:"text-border-color",type:c.color},{name:"text-border-width",type:c.size,triggersBounds:v.any},{name:"text-border-style",type:c.borderStyle,triggersBounds:v.any},{name:"text-background-shape",type:c.textBackgroundShape,triggersBounds:v.any},{name:"text-justification",type:c.justification}];var m=[{name:"events",type:c.bool,triggersZOrder:v.any},{name:"text-events",type:c.bool,triggersZOrder:v.any}];var b=[{name:"display",type:c.display,triggersZOrder:v.any,triggersBounds:v.any,triggersBoundsOfConnectedEdges:v.any,triggersBoundsOfParallelEdges:function triggersBoundsOfParallelEdges(e,t,a){return e!==t&&a.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:c.visibility,triggersZOrder:v.any},{name:"opacity",type:c.zeroOneNumber,triggersZOrder:v.zeroNonZero},{name:"text-opacity",type:c.zeroOneNumber},{name:"min-zoomed-font-size",type:c.size},{name:"z-compound-depth",type:c.zCompoundDepth,triggersZOrder:v.any},{name:"z-index-compare",type:c.zIndexCompare,triggersZOrder:v.any},{name:"z-index",type:c.number,triggersZOrder:v.any}];var x=[{name:"overlay-padding",type:c.size,triggersBounds:v.any},{name:"overlay-color",type:c.color},{name:"overlay-opacity",type:c.zeroOneNumber,triggersBounds:v.zeroNonZero},{name:"overlay-shape",type:c.overlayShape,triggersBounds:v.any},{name:"overlay-corner-radius",type:c.cornerRadius}];var w=[{name:"underlay-padding",type:c.size,triggersBounds:v.any},{name:"underlay-color",type:c.color},{name:"underlay-opacity",type:c.zeroOneNumber,triggersBounds:v.zeroNonZero},{name:"underlay-shape",type:c.overlayShape,triggersBounds:v.any},{name:"underlay-corner-radius",type:c.cornerRadius}];var E=[{name:"transition-property",type:c.propList},{name:"transition-duration",type:c.time},{name:"transition-delay",type:c.time},{name:"transition-timing-function",type:c.easing}];var S=function nodeSizeHashOverride(e,t){return t.value==="label"?-e.poolIndex():t.pfValue};var k=[{name:"height",type:c.nodeSize,triggersBounds:v.any,hashOverride:S},{name:"width",type:c.nodeSize,triggersBounds:v.any,hashOverride:S},{name:"shape",type:c.nodeShape,triggersBounds:v.any},{name:"shape-polygon-points",type:c.polygonPointList,triggersBounds:v.any},{name:"corner-radius",type:c.cornerRadius},{name:"background-color",type:c.color},{name:"background-fill",type:c.fill},{name:"background-opacity",type:c.zeroOneNumber},{name:"background-blacken",type:c.nOneOneNumber},{name:"background-gradient-stop-colors",type:c.colors},{name:"background-gradient-stop-positions",type:c.percentages},{name:"background-gradient-direction",type:c.gradientDirection},{name:"padding",type:c.sizeMaybePercent,triggersBounds:v.any},{name:"padding-relative-to",type:c.paddingRelativeTo,triggersBounds:v.any},{name:"bounds-expansion",type:c.boundsExpansion,triggersBounds:v.any}];var P=[{name:"border-color",type:c.color},{name:"border-opacity",type:c.zeroOneNumber},{name:"border-width",type:c.size,triggersBounds:v.any},{name:"border-style",type:c.borderStyle},{name:"border-cap",type:c.lineCap},{name:"border-join",type:c.lineJoin},{name:"border-dash-pattern",type:c.numbers},{name:"border-dash-offset",type:c.number},{name:"border-position",type:c.linePosition}];var _=[{name:"outline-color",type:c.color},{name:"outline-opacity",type:c.zeroOneNumber},{name:"outline-width",type:c.size,triggersBounds:v.any},{name:"outline-style",type:c.borderStyle},{name:"outline-offset",type:c.size,triggersBounds:v.any}];var D=[{name:"background-image",type:c.urls},{name:"background-image-crossorigin",type:c.bgCrossOrigin},{name:"background-image-opacity",type:c.zeroOneNumbers},{name:"background-image-containment",type:c.bgContainment},{name:"background-image-smoothing",type:c.bools},{name:"background-position-x",type:c.bgPos},{name:"background-position-y",type:c.bgPos},{name:"background-width-relative-to",type:c.bgRelativeTo},{name:"background-height-relative-to",type:c.bgRelativeTo},{name:"background-repeat",type:c.bgRepeat},{name:"background-fit",type:c.bgFit},{name:"background-clip",type:c.bgClip},{name:"background-width",type:c.bgWH},{name:"background-height",type:c.bgWH},{name:"background-offset-x",type:c.bgPos},{name:"background-offset-y",type:c.bgPos}];var I=[{name:"position",type:c.position,triggersBounds:v.any},{name:"compound-sizing-wrt-labels",type:c.compoundIncludeLabels,triggersBounds:v.any},{name:"min-width",type:c.size,triggersBounds:v.any},{name:"min-width-bias-left",type:c.sizeMaybePercent,triggersBounds:v.any},{name:"min-width-bias-right",type:c.sizeMaybePercent,triggersBounds:v.any},{name:"min-height",type:c.size,triggersBounds:v.any},{name:"min-height-bias-top",type:c.sizeMaybePercent,triggersBounds:v.any},{name:"min-height-bias-bottom",type:c.sizeMaybePercent,triggersBounds:v.any}];var M=[{name:"line-style",type:c.lineStyle},{name:"line-color",type:c.color},{name:"line-fill",type:c.fill},{name:"line-cap",type:c.lineCap},{name:"line-opacity",type:c.zeroOneNumber},{name:"line-dash-pattern",type:c.numbers},{name:"line-dash-offset",type:c.number},{name:"line-outline-width",type:c.size},{name:"line-outline-color",type:c.color},{name:"line-gradient-stop-colors",type:c.colors},{name:"line-gradient-stop-positions",type:c.percentages},{name:"curve-style",type:c.curveStyle,triggersBounds:v.any,triggersBoundsOfParallelEdges:function triggersBoundsOfParallelEdges(e,t){return e!==t&&(e==="bezier"||t==="bezier")}},{name:"haystack-radius",type:c.zeroOneNumber,triggersBounds:v.any},{name:"source-endpoint",type:c.edgeEndpoint,triggersBounds:v.any},{name:"target-endpoint",type:c.edgeEndpoint,triggersBounds:v.any},{name:"control-point-step-size",type:c.size,triggersBounds:v.any},{name:"control-point-distances",type:c.bidirectionalSizes,triggersBounds:v.any},{name:"control-point-weights",type:c.numbers,triggersBounds:v.any},{name:"segment-distances",type:c.bidirectionalSizes,triggersBounds:v.any},{name:"segment-weights",type:c.numbers,triggersBounds:v.any},{name:"segment-radii",type:c.numbers,triggersBounds:v.any},{name:"radius-type",type:c.radiusType,triggersBounds:v.any},{name:"taxi-turn",type:c.bidirectionalSizeMaybePercent,triggersBounds:v.any},{name:"taxi-turn-min-distance",type:c.size,triggersBounds:v.any},{name:"taxi-direction",type:c.axisDirection,triggersBounds:v.any},{name:"taxi-radius",type:c.number,triggersBounds:v.any},{name:"edge-distances",type:c.edgeDistances,triggersBounds:v.any},{name:"arrow-scale",type:c.positiveNumber,triggersBounds:v.any},{name:"loop-direction",type:c.angle,triggersBounds:v.any},{name:"loop-sweep",type:c.angle,triggersBounds:v.any},{name:"source-distance-from-node",type:c.size,triggersBounds:v.any},{name:"target-distance-from-node",type:c.size,triggersBounds:v.any}];var R=[{name:"ghost",type:c.bool,triggersBounds:v.any},{name:"ghost-offset-x",type:c.bidirectionalSize,triggersBounds:v.any},{name:"ghost-offset-y",type:c.bidirectionalSize,triggersBounds:v.any},{name:"ghost-opacity",type:c.zeroOneNumber}];var L=[{name:"selection-box-color",type:c.color},{name:"selection-box-opacity",type:c.zeroOneNumber},{name:"selection-box-border-color",type:c.color},{name:"selection-box-border-width",type:c.size},{name:"active-bg-color",type:c.color},{name:"active-bg-opacity",type:c.zeroOneNumber},{name:"active-bg-size",type:c.size},{name:"outside-texture-bg-color",type:c.color},{name:"outside-texture-bg-opacity",type:c.zeroOneNumber}];var O=[];uu.pieBackgroundN=16;O.push({name:"pie-size",type:c.sizeMaybePercent});for(var V=1;V<=uu.pieBackgroundN;V++){O.push({name:"pie-"+V+"-background-color",type:c.color});O.push({name:"pie-"+V+"-background-size",type:c.percent});O.push({name:"pie-"+V+"-background-opacity",type:c.zeroOneNumber})}var W=[];var X=uu.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:c.arrowShape,triggersBounds:v.any},{name:"arrow-color",type:c.color},{name:"arrow-fill",type:c.arrowFill},{name:"arrow-width",type:c.arrowWidth}].forEach((function(e){X.forEach((function(t){var a=t+"-"+e.name;var n=e.type,i=e.triggersBounds;W.push({name:a,type:n,triggersBounds:i})}))}),{});var Y=uu.properties=[].concat(m,E,b,x,w,R,y,g,d,h,p,k,P,_,D,O,I,M,W,L);var G=uu.propertyGroups={behavior:m,transition:E,visibility:b,overlay:x,underlay:w,ghost:R,commonLabel:y,labelDimensions:g,mainLabel:d,sourceLabel:h,targetLabel:p,nodeBody:k,nodeBorder:P,nodeOutline:_,backgroundImage:D,pie:O,compound:I,edgeLine:M,edgeArrow:W,core:L};var K=uu.propertyGroupNames={};var U=uu.propertyGroupKeys=Object.keys(G);U.forEach((function(e){K[e]=G[e].map((function(e){return e.name}));G[e].forEach((function(t){return t.groupKey=e}))}));var Z=uu.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];uu.propertyNames=Y.map((function(e){return e.name}));for(var Q=0;Q<Y.length;Q++){var J=Y[Q];Y[J.name]=J}for(var ee=0;ee<Z.length;ee++){var te=Z[ee];var re=Y[te.pointsTo];var ae={name:te.name,alias:true,pointsTo:re};Y.push(ae);Y[te.name]=ae}})();uu.getDefaultProperty=function(e){return this.getDefaultProperties()[e]};uu.getDefaultProperties=function(){var e=this._private;if(e.defaultProperties!=null)return e.defaultProperties;var t=Y({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce((function(e,t){for(var a=1;a<=uu.pieBackgroundN;a++){var n=t.name.replace("{{i}}",a);var i=t.value;e[n]=i}return e}),{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce((function(e,t){uu.arrowPrefixes.forEach((function(a){var n=a+"-"+t.name;var i=t.value;e[n]=i}));return e}),{}));var a={};for(var n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var o=i.name;var s=t[o];var l=this.parse(o,s);a[o]=l}}e.defaultProperties=a;return e.defaultProperties};uu.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25});this.defaultLength=this.length};var vu={};vu.parse=function(e,t,a,n){var i=this;if(u(t))return i.parseImplWarn(e,t,a,n);var o=n==="mapping"||n===true||n===false||n==null?"dontcare":n;var s=a?"t":"f";var l=""+t;var v=Ue(e,l,s,o);var c=i.propCache=i.propCache||[];var d;(d=c[v])||(d=c[v]=i.parseImplWarn(e,t,a,n));if(a||n==="mapping"){d=ut(d);d&&(d.value=ut(d.value))}return d};vu.parseImplWarn=function(e,t,a,n){var i=this.parseImpl(e,t,a,n);i||t==null||st("The style property `".concat(e,": ").concat(t,"` is invalid"));!i||i.name!=="width"&&i.name!=="height"||t!=="label"||st("The style value of `label` is deprecated for `"+i.name+"`");return i};vu.parseImpl=function(e,t,a,n){var i=this;e=I(e);var o=i.properties[e];var s=t;var c=i.types;if(!o)return null;if(t===void 0)return null;if(o.alias){o=o.pointsTo;e=o.name}var d=l(t);d&&(t=t.trim());var h=o.type;if(!h)return null;if(a&&(t===""||t===null))return{name:e,value:t,bypass:true,deleteBypass:true};if(u(t))return{name:e,value:t,strValue:"fn",mapped:c.fn,bypass:a};var g,y;if(!d||n||t.length<7||t[1]!=="a");else{if(t.length>=7&&t[0]==="d"&&(g=new RegExp(c.data.regex).exec(t))){if(a)return false;var m=c.data;return{name:e,value:g,strValue:""+t,mapped:m,field:g[1],bypass:a}}if(t.length>=10&&t[0]==="m"&&(y=new RegExp(c.mapData.regex).exec(t))){if(a)return false;if(h.multiple)return false;var b=c.mapData;if(!(h.color||h.number))return false;var x=this.parse(e,y[4]);if(!x||x.mapped)return false;var w=this.parse(e,y[5]);if(!w||w.mapped)return false;if(x.pfValue===w.pfValue||x.strValue===w.strValue){st("`"+e+": "+t+"` is not a valid mapper because the output range is zero; converting to `"+e+": "+x.strValue+"`");return this.parse(e,x.strValue)}if(h.color){var E=x.value;var T=w.value;var S=E[0]===T[0]&&E[1]===T[1]&&E[2]===T[2]&&(E[3]===T[3]||(E[3]==null||E[3]===1)&&(T[3]==null||T[3]===1));if(S)return false}return{name:e,value:y,strValue:""+t,mapped:b,field:y[1],fieldMin:parseFloat(y[2]),fieldMax:parseFloat(y[3]),valueMin:x.value,valueMax:w.value,bypass:a}}}if(h.multiple&&n!=="multiple"){var k;k=d?t.split(/\s+/):v(t)?t:[t];if(h.evenMultiple&&k.length%2!==0)return null;var P=[];var _=[];var D=[];var M="";var R=false;for(var L=0;L<k.length;L++){var O=i.parse(e,k[L],a,"multiple");R=R||l(O.value);P.push(O.value);D.push(O.pfValue!=null?O.pfValue:O.value);_.push(O.units);M+=(L>0?" ":"")+O.strValue}return h.validate&&!h.validate(P,_)?null:h.singleEnum&&R?P.length===1&&l(P[0])?{name:e,value:P[0],strValue:P[0],bypass:a}:null:{name:e,value:P,pfValue:D,strValue:M,bypass:a,units:_}}var z=function checkEnums(){for(var n=0;n<h.enums.length;n++){var i=h.enums[n];if(i===t)return{name:e,value:t,strValue:""+t,bypass:a}}return null};if(h.number){var V;var q="px";h.units&&(V=h.units);h.implicitUnits&&(q=h.implicitUnits);if(!h.unitless)if(d){var j="px|em"+(h.allowPercent?"|\\%":"");V&&(j=V);var H=t.match("^("+N+")("+j+")?$");if(H){t=H[1];V=H[2]||q}}else V&&!h.implicitUnits||(V=q);t=parseFloat(t);if(isNaN(t)&&h.enums===void 0)return null;if(isNaN(t)&&h.enums!==void 0){t=s;return z()}if(h.integer&&!p(t))return null;if(h.min!==void 0&&(t<h.min||h.strictMin&&t===h.min)||h.max!==void 0&&(t>h.max||h.strictMax&&t===h.max))return null;var W={name:e,value:t,strValue:""+t+(V||""),units:V,bypass:a};h.unitless||V!=="px"&&V!=="em"?W.pfValue=t:W.pfValue=V!=="px"&&V?this.getEmSizeInPixels()*t:t;V!=="ms"&&V!=="s"||(W.pfValue=V==="ms"?t:1e3*t);V!=="deg"&&V!=="rad"||(W.pfValue=V==="rad"?t:rr(t));V==="%"&&(W.pfValue=t/100);return W}if(h.propList){var X=[];var Y=""+t;if(Y==="none");else{var G=Y.split(/\s*,\s*|\s+/);for(var K=0;K<G.length;K++){var U=G[K].trim();i.properties[U]?X.push(U):st("`"+U+"` is not a valid property name")}if(X.length===0)return null}return{name:e,value:X,strValue:X.length===0?"none":X.join(" "),bypass:a}}if(h.color){var Z=Q(t);return Z?{name:e,value:Z,pfValue:Z,strValue:"rgb("+Z[0]+","+Z[1]+","+Z[2]+")",bypass:a}:null}if(h.regex||h.regexes){if(h.enums){var J=z();if(J)return J}var ee=h.regexes?h.regexes:[h.regex];for(var te=0;te<ee.length;te++){var re=new RegExp(ee[te]);var ae=re.exec(t);if(ae)return{name:e,value:h.singleRegexMatchValue?ae[1]:ae,strValue:""+t,bypass:a}}return null}return h.string?{name:e,value:""+t,strValue:""+t,bypass:a}:h.enums?z():null};var cu=function Style(e){if(!(this instanceof cu))return new cu(e);if(x(e)){this._private={cy:e,coreStyle:{}};this.length=0;this.resetToDefault()}else it("A style must have a core reference")};var du=cu.prototype;du.instanceString=function(){return"style"};du.clear=function(){var e=this._private;var t=e.cy;var a=t.elements();for(var n=0;n<this.length;n++)this[n]=void 0;this.length=0;e.contextStyles={};e.propDiffs={};this.cleanElements(a,true);a.forEach((function(e){var t=e[0]._private;t.styleDirty=true;t.appliedInitStyle=false}));return this};du.resetToDefault=function(){this.clear();this.addDefaultStylesheet();return this};du.core=function(e){return this._private.coreStyle[e]||this.getDefaultProperty(e)};du.selector=function(e){var t=e==="core"?null:new hs(e);var a=this.length++;this[a]={selector:t,properties:[],mappedProperties:[],index:a};return this};du.css=function(){var e=this;var t=arguments;if(t.length===1){var a=t[0];for(var n=0;n<e.properties.length;n++){var i=e.properties[n];var o=a[i.name];o===void 0&&(o=a[M(i.name)]);o!==void 0&&this.cssRule(i.name,o)}}else t.length===2&&this.cssRule(t[0],t[1]);return this};du.style=du.css;du.cssRule=function(e,t){var a=this.parse(e,t);if(a){var n=this.length-1;this[n].properties.push(a);this[n].properties[a.name]=a;a.name.match(/pie-(\d+)-background-size/)&&a.value&&(this._private.hasPie=true);a.mapped&&this[n].mappedProperties.push(a);var i=!this[n].selector;i&&(this._private.coreStyle[a.name]=a)}return this};du.append=function(e){w(e)?e.appendToStyle(this):v(e)?this.appendFromJson(e):l(e)&&this.appendFromString(e);return this};cu.fromJson=function(e,t){var a=new cu(e);a.fromJson(t);return a};cu.fromString=function(e,t){return new cu(e).fromString(t)};[tu,nu,iu,ou,su,lu,uu,vu].forEach((function(e){Y(du,e)}));cu.types=du.types;cu.properties=du.properties;cu.propertyGroups=du.propertyGroups;cu.propertyGroupNames=du.propertyGroupNames;cu.propertyGroupKeys=du.propertyGroupKeys;var hu={style:function style(e){if(e){var t=this.setStyle(e);t.update()}return this._private.style},setStyle:function setStyle(e){var t=this._private;w(e)?t.style=e.generateStyle(this):v(e)?t.style=cu.fromJson(this,e):l(e)?t.style=cu.fromString(this,e):t.style=cu(this);return t.style},updateStyle:function updateStyle(){this.mutableElements().updateStyle()}};var fu="single";var pu={autolock:function autolock(e){if(e===void 0)return this._private.autolock;this._private.autolock=!!e;return this},autoungrabify:function autoungrabify(e){if(e===void 0)return this._private.autoungrabify;this._private.autoungrabify=!!e;return this},autounselectify:function autounselectify(e){if(e===void 0)return this._private.autounselectify;this._private.autounselectify=!!e;return this},selectionType:function selectionType(e){var t=this._private;t.selectionType==null&&(t.selectionType=fu);if(e===void 0)return t.selectionType;e!=="additive"&&e!=="single"||(t.selectionType=e);return this},panningEnabled:function panningEnabled(e){if(e===void 0)return this._private.panningEnabled;this._private.panningEnabled=!!e;return this},userPanningEnabled:function userPanningEnabled(e){if(e===void 0)return this._private.userPanningEnabled;this._private.userPanningEnabled=!!e;return this},zoomingEnabled:function zoomingEnabled(e){if(e===void 0)return this._private.zoomingEnabled;this._private.zoomingEnabled=!!e;return this},userZoomingEnabled:function userZoomingEnabled(e){if(e===void 0)return this._private.userZoomingEnabled;this._private.userZoomingEnabled=!!e;return this},boxSelectionEnabled:function boxSelectionEnabled(e){if(e===void 0)return this._private.boxSelectionEnabled;this._private.boxSelectionEnabled=!!e;return this},pan:function pan(){var e=arguments;var pan=this._private.pan;var t,a,n,i,o;switch(e.length){case 0:return pan;case 1:if(l(e[0])){t=e[0];return pan[t]}if(c(e[0])){if(!this._private.panningEnabled)return this;n=e[0];i=n.x;o=n.y;h(i)&&(pan.x=i);h(o)&&(pan.y=o);this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;t=e[0];a=e[1];t!=="x"&&t!=="y"||!h(a)||(pan[t]=a);this.emit("pan viewport");break}this.notify("viewport");return this},panBy:function panBy(e,t){var a=arguments;var n=this._private.pan;var i,o,s,l,u;if(!this._private.panningEnabled)return this;switch(a.length){case 1:if(c(e)){s=a[0];l=s.x;u=s.y;h(l)&&(n.x+=l);h(u)&&(n.y+=u);this.emit("pan viewport")}break;case 2:i=e;o=t;i!=="x"&&i!=="y"||!h(o)||(n[i]+=o);this.emit("pan viewport");break}this.notify("viewport");return this},gc:function gc(){this.notify("gc")},fit:function fit(e,t){var a=this.getFitViewport(e,t);if(a){var n=this._private;n.zoom=a.zoom;n.pan=a.pan;this.emit("pan zoom viewport");this.notify("viewport")}return this},getFitViewport:function getFitViewport(e,t){if(h(e)&&t===void 0){t=e;e=void 0}if(this._private.panningEnabled&&this._private.zoomingEnabled){var a;if(l(e)){var n=e;e=this.$(n)}else if(k(e)){var i=e;a={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2};a.w=a.x2-a.x1;a.h=a.y2-a.y1}else y(e)||(e=this.mutableElements());if(!y(e)||!e.empty()){a=a||e.boundingBox();var o=this.width();var s=this.height();var u;t=h(t)?t:0;if(!isNaN(o)&&!isNaN(s)&&o>0&&s>0&&!isNaN(a.w)&&!isNaN(a.h)&&a.w>0&&a.h>0){u=Math.min((o-2*t)/a.w,(s-2*t)/a.h);u=u>this._private.maxZoom?this._private.maxZoom:u;u=u<this._private.minZoom?this._private.minZoom:u;var v={x:(o-u*(a.x1+a.x2))/2,y:(s-u*(a.y1+a.y2))/2};return{zoom:u,pan:v}}}}},zoomRange:function zoomRange(e,t){var a=this._private;if(t==null){var n=e;e=n.min;t=n.max}if(h(e)&&h(t)&&e<=t){a.minZoom=e;a.maxZoom=t}else h(e)&&t===void 0&&e<=a.maxZoom?a.minZoom=e:h(t)&&e===void 0&&t>=a.minZoom&&(a.maxZoom=t);return this},minZoom:function minZoom(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function maxZoom(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function getZoomedViewport(e){var t=this._private;var a=t.pan;var n=t.zoom;var i;var o;var s=false;t.zoomingEnabled||(s=true);if(h(e))o=e;else if(c(e)){o=e.level;e.position!=null?i=Ut(e.position,n,a):e.renderedPosition!=null&&(i=e.renderedPosition);i==null||t.panningEnabled||(s=true)}o=o>t.maxZoom?t.maxZoom:o;o=o<t.minZoom?t.minZoom:o;if(s||!h(o)||o===n||i!=null&&(!h(i.x)||!h(i.y)))return null;if(i!=null){var l=a;var u=n;var v=o;var d={x:-v/u*(i.x-l.x)+i.x,y:-v/u*(i.y-l.y)+i.y};return{zoomed:true,panned:true,zoom:v,pan:d}}return{zoomed:true,panned:false,zoom:o,pan:a}},zoom:function zoom(e){if(e===void 0)return this._private.zoom;var t=this.getZoomedViewport(e);var a=this._private;if(t==null||!t.zoomed)return this;a.zoom=t.zoom;if(t.panned){a.pan.x=t.pan.x;a.pan.y=t.pan.y}this.emit("zoom"+(t.panned?" pan":"")+" viewport");this.notify("viewport");return this},viewport:function viewport(e){var t=this._private;var a=true;var n=true;var i=[];var o=false;var s=false;if(!e)return this;h(e.zoom)||(a=false);c(e.pan)||(n=false);if(!a&&!n)return this;if(a){var l=e.zoom;if(l<t.minZoom||l>t.maxZoom||!t.zoomingEnabled)o=true;else{t.zoom=l;i.push("zoom")}}if(n&&(!o||!e.cancelOnFailedZoom)&&t.panningEnabled){var u=e.pan;if(h(u.x)){t.pan.x=u.x;s=false}if(h(u.y)){t.pan.y=u.y;s=false}s||i.push("pan")}if(i.length>0){i.push("viewport");this.emit(i.join(" "));this.notify("viewport")}return this},center:function center(e){var t=this.getCenterPan(e);if(t){this._private.pan=t;this.emit("pan viewport");this.notify("viewport")}return this},getCenterPan:function getCenterPan(e,t){if(this._private.panningEnabled){if(l(e)){var a=e;e=this.mutableElements().filter(a)}else y(e)||(e=this.mutableElements());if(e.length!==0){var n=e.boundingBox();var i=this.width();var o=this.height();t=t===void 0?this._private.zoom:t;var s={x:(i-t*(n.x1+n.x2))/2,y:(o-t*(n.y1+n.y2))/2};return s}}},reset:function reset(){if(!this._private.panningEnabled||!this._private.zoomingEnabled)return this;this.viewport({pan:{x:0,y:0},zoom:1});return this},invalidateSize:function invalidateSize(){this._private.sizeCache=null},size:function size(){var e=this._private;var t=e.container;var a=this;return e.sizeCache=e.sizeCache||(t?function(){var e=a.window().getComputedStyle(t);var n=function val(t){return parseFloat(e.getPropertyValue(t))};return{width:t.clientWidth-n("padding-left")-n("padding-right"),height:t.clientHeight-n("padding-top")-n("padding-bottom")}}():{width:1,height:1})},width:function width(){return this.size().width},height:function height(){return this.size().height},extent:function extent(){var e=this._private.pan;var t=this._private.zoom;var a=this.renderedExtent();var n={x1:(a.x1-e.x)/t,x2:(a.x2-e.x)/t,y1:(a.y1-e.y)/t,y2:(a.y2-e.y)/t};n.w=n.x2-n.x1;n.h=n.y2-n.y1;return n},renderedExtent:function renderedExtent(){var e=this.width();var t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}},multiClickDebounceTime:function multiClickDebounceTime(e){if(!e)return this._private.multiClickDebounceTime;this._private.multiClickDebounceTime=e;return this}};pu.centre=pu.center;pu.autolockNodes=pu.autolock;pu.autoungrabifyNodes=pu.autoungrabify;var gu={data:Fo.data({field:"data",bindingEvent:"data",allowBinding:true,allowSetting:true,settingEvent:"data",settingTriggersEvent:true,triggerFnName:"trigger",allowGetting:true,updateStyle:true}),removeData:Fo.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:true,updateStyle:true}),scratch:Fo.data({field:"scratch",bindingEvent:"scratch",allowBinding:true,allowSetting:true,settingEvent:"scratch",settingTriggersEvent:true,triggerFnName:"trigger",allowGetting:true,updateStyle:true}),removeScratch:Fo.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:true,updateStyle:true})};gu.attr=gu.data;gu.removeAttr=gu.removeData;var yu=function Core(t){var a=this;t=Y({},t);var n=t.container;n&&!g(n)&&g(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{};if(i&&i.cy){i.cy.destroy();i={}}var o=i.readies=i.readies||[];n&&(n._cyreg=i);i.cy=a;var s=e!==void 0&&n!==void 0&&!t.headless;var l=t;l.layout=Y({name:s?"grid":"null"},l.layout);l.renderer=Y({name:s?"canvas":"null"},l.renderer);var d=function defVal(e,t,a){return t!==void 0?t:a!==void 0?a:e};var p=this._private={container:n,ready:false,options:l,elements:new zl(this),listeners:[],aniEles:new zl(this),data:l.data||{},scratch:{},layout:null,renderer:null,destroyed:false,notificationsEnabled:true,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:d(true,l.zoomingEnabled),userZoomingEnabled:d(true,l.userZoomingEnabled),panningEnabled:d(true,l.panningEnabled),userPanningEnabled:d(true,l.userPanningEnabled),boxSelectionEnabled:d(true,l.boxSelectionEnabled),autolock:d(false,l.autolock,l.autolockNodes),autoungrabify:d(false,l.autoungrabify,l.autoungrabifyNodes),autounselectify:d(false,l.autounselectify),styleEnabled:l.styleEnabled===void 0?s:l.styleEnabled,zoom:h(l.zoom)?l.zoom:1,pan:{x:c(l.pan)&&h(l.pan.x)?l.pan.x:0,y:c(l.pan)&&h(l.pan.y)?l.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:false,multiClickDebounceTime:d(250,l.multiClickDebounceTime)};this.createEmitter();this.selectionType(l.selectionType);this.zoomRange({min:l.minZoom,max:l.maxZoom});var y=function loadExtData(e,t){var a=e.some(P);if(a)return Bn.all(e).then(t);t(e)};p.styleEnabled&&a.setStyle([]);var m=Y({},l,l.renderer);a.initRenderer(m);var b=function setElesAndLayout(e,t,n){a.notifications(false);var i=a.mutableElements();i.length>0&&i.remove();e!=null&&(c(e)||v(e))&&a.add(e);a.one("layoutready",(function(e){a.notifications(true);a.emit(e);a.one("load",t);a.emitAndNotify("load")})).one("layoutstop",(function(){a.one("done",n);a.emit("done")}));var o=Y({},a._private.options.layout);o.eles=a.elements();a.layout(o).run()};y([l.style,l.elements],(function(e){var t=e[0];var n=e[1];p.styleEnabled&&a.style().append(t);b(n,(function(){a.startAnimationLoop();p.ready=true;u(l.ready)&&a.on("ready",l.ready);for(var e=0;e<o.length;e++){var t=o[e];a.on("ready",t)}i&&(i.readies=[]);a.emit("ready")}),l.done)}))};var mu=yu.prototype;Y(mu,{instanceString:function instanceString(){return"core"},isReady:function isReady(){return this._private.ready},destroyed:function destroyed(){return this._private.destroyed},ready:function ready(e){this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e);return this},destroy:function destroy(){var e=this;if(!e.destroyed()){e.stopAnimationLoop();e.destroyRenderer();this.emit("destroy");e._private.destroyed=true;return e}},hasElementWithId:function hasElementWithId(e){return this._private.elements.hasElementWithId(e)},getElementById:function getElementById(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function hasCompoundNodes(){return this._private.hasCompoundNodes},headless:function headless(){return this._private.renderer.isHeadless()},styleEnabled:function styleEnabled(){return this._private.styleEnabled},addToPool:function addToPool(e){this._private.elements.merge(e);return this},removeFromPool:function removeFromPool(e){this._private.elements.unmerge(e);return this},container:function container(){return this._private.container||null},window:function window(){var t=this._private.container;if(t==null)return e;var a=this._private.container.ownerDocument;return a===void 0||a==null?e:a.defaultView||e},mount:function mount(e){if(e!=null){var t=this;var a=t._private;var n=a.options;!g(e)&&g(e[0])&&(e=e[0]);t.stopAnimationLoop();t.destroyRenderer();a.container=e;a.styleEnabled=true;t.invalidateSize();t.initRenderer(Y({},n,n.renderer,{name:n.renderer.name==="null"?"canvas":n.renderer.name}));t.startAnimationLoop();t.style(n.style);t.emit("mount");return t}},unmount:function unmount(){var e=this;e.stopAnimationLoop();e.destroyRenderer();e.initRenderer({name:"null"});e.emit("unmount");return e},options:function options(){return ut(this._private.options)},json:function json(e){var t=this;var a=t._private;var n=t.mutableElements();var i=function getFreshRef(e){return t.getElementById(e.id())};if(c(e)){t.startBatch();if(e.elements){var o={};var s=function updateEles(e,a){var n=[];var i=[];for(var s=0;s<e.length;s++){var l=e[s];if(l.data.id){var u=""+l.data.id;var v=t.getElementById(u);o[u]=true;if(v.length!==0)i.push({ele:v,json:l});else if(a){l.group=a;n.push(l)}else n.push(l)}else st("cy.json() cannot handle elements without an ID attribute")}t.add(n);for(var c=0;c<i.length;c++){var d=i[c],h=d.ele,p=d.json;h.json(p)}};if(v(e.elements))s(e.elements);else{var l=["nodes","edges"];for(var u=0;u<l.length;u++){var d=l[u];var h=e.elements[d];v(h)&&s(h,d)}}var p=t.collection();n.filter((function(e){return!o[e.id()]})).forEach((function(e){e.isParent()?p.merge(e):e.remove()}));p.forEach((function(e){return e.children().move({parent:null})}));p.forEach((function(e){return i(e).remove()}))}e.style&&t.style(e.style);e.zoom!=null&&e.zoom!==a.zoom&&t.zoom(e.zoom);e.pan&&(e.pan.x===a.pan.x&&e.pan.y===a.pan.y||t.pan(e.pan));e.data&&t.data(e.data);var g=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"];for(var y=0;y<g.length;y++){var m=g[y];e[m]!=null&&t[m](e[m])}t.endBatch();return this}var b=!!e;var json={};if(b)json.elements=this.elements().map((function(e){return e.json()}));else{json.elements={};n.forEach((function(e){var t=e.group();json.elements[t]||(json.elements[t]=[]);json.elements[t].push(e.json())}))}this._private.styleEnabled&&(json.style=t.style().json());json.data=ut(t.data());var x=a.options;json.zoomingEnabled=a.zoomingEnabled;json.userZoomingEnabled=a.userZoomingEnabled;json.zoom=a.zoom;json.minZoom=a.minZoom;json.maxZoom=a.maxZoom;json.panningEnabled=a.panningEnabled;json.userPanningEnabled=a.userPanningEnabled;json.pan=ut(a.pan);json.boxSelectionEnabled=a.boxSelectionEnabled;json.renderer=ut(x.renderer);json.hideEdgesOnViewport=x.hideEdgesOnViewport;json.textureOnViewport=x.textureOnViewport;json.wheelSensitivity=x.wheelSensitivity;json.motionBlur=x.motionBlur;json.multiClickDebounceTime=x.multiClickDebounceTime;return json}});mu.$id=mu.getElementById;[ql,Xl,Kl,Ul,Zl,$l,Jl,eu,hu,pu,gu].forEach((function(e){Y(mu,e)}));var bu={fit:true,directed:false,padding:30,circle:false,grid:false,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:true,nodeDimensionsIncludeLabels:false,roots:void 0,depthSort:void 0,animate:false,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(e,t){return true},ready:void 0,stop:void 0,transform:function transform(e,t){return t}};var xu={maximal:false,acyclic:false};var wu=function getInfo(e){return e.scratch("breadthfirst")};var Eu=function setInfo(e,t){return e.scratch("breadthfirst",t)};function BreadthFirstLayout(e){this.options=Y({},bu,xu,e)}BreadthFirstLayout.prototype.run=function(){var e=this.options;var t=e.cy;var a=e.eles;var n=a.nodes().filter((function(e){return e.isChildless()}));var i=a;var o=e.directed;var s=e.acyclic||e.maximal||e.maximalAdjustments>0;var u=!!e.boundingBox;var c=t.extent();var d=hr(u?e.boundingBox:{x1:c.x1,y1:c.y1,w:c.w,h:c.h});var h;if(y(e.roots))h=e.roots;else if(v(e.roots)){var p=[];for(var g=0;g<e.roots.length;g++){var m=e.roots[g];var b=t.getElementById(m);p.push(b)}h=t.collection(p)}else if(l(e.roots))h=t.$(e.roots);else if(o)h=n.roots();else{var x=a.components();h=t.collection();var w=function _loop(){var e=x[E];var t=e.maxDegree(false);var a=e.filter((function(e){return e.degree(false)===t}));h=h.add(a)};for(var E=0;E<x.length;E++)w()}var T=[];var S={};var k=function addToDepth(e,t){T[t]==null&&(T[t]=[]);var a=T[t].length;T[t].push(e);Eu(e,{index:a,depth:t})};var P=function changeDepth(e,t){var a=wu(e),n=a.depth,i=a.index;T[n][i]=null;e.isChildless()&&k(e,t)};i.bfs({roots:h,directed:e.directed,visit:function visit(e,t,a,n,i){var o=e[0];var s=o.id();o.isChildless()&&k(o,i);S[s]=true}});var _=[];for(var D=0;D<n.length;D++){var I=n[D];S[I.id()]||_.push(I)}var M=function assignDepthsAt(e){var t=T[e];for(var a=0;a<t.length;a++){var n=t[a];if(n!=null)Eu(n,{depth:e,index:a});else{t.splice(a,1);a--}}};var R=function adjustMaximally(t,n){var i=wu(t);var o=t.incomers().filter((function(e){return e.isNode()&&a.has(e)}));var s=-1;var l=t.id();for(var u=0;u<o.length;u++){var v=o[u];var c=wu(v);s=Math.max(s,c.depth)}if(i.depth<=s){if(!e.acyclic&&n[l])return null;var d=s+1;P(t,d);n[l]=d;return true}return false};if(o&&s){var L=[];var N={};var O=function enqueue(e){return L.push(e)};var z=function dequeue(){return L.shift()};n.forEach((function(e){return L.push(e)}));while(L.length>0){var V=z();var q=R(V,N);if(q)V.outgoers().filter((function(e){return e.isNode()&&a.has(e)})).forEach(O);else if(q===null){st("Detected double maximal shift for node `"+V.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var j=0;if(e.avoidOverlap)for(var H=0;H<n.length;H++){var X=n[H];var Y=X.layoutDimensions(e);var G=Y.w;var K=Y.h;j=Math.max(j,G,K)}var U={};var Z=function getWeightedPercent(e){if(U[e.id()])return U[e.id()];var t=wu(e).depth;var a=e.neighborhood();var i=0;var o=0;for(var s=0;s<a.length;s++){var l=a[s];if(!l.isEdge()&&!l.isParent()&&n.has(l)){var u=wu(l);if(u!=null){var v=u.index;var c=u.depth;if(v!=null&&c!=null){var d=T[c].length;if(c<t){i+=v/d;o++}}}}}o=Math.max(1,o);i/=o;o===0&&(i=0);U[e.id()]=i;return i};var Q=function sortFn(e,t){var a=Z(e);var n=Z(t);var i=a-n;return i===0?W(e.id(),t.id()):i};e.depthSort!==void 0&&(Q=e.depthSort);var J=T.length;for(var ee=0;ee<J;ee++){T[ee].sort(Q);M(ee)}var te=[];for(var re=0;re<_.length;re++)te.push(_[re]);var ae=function assignDepths(){for(var e=0;e<J;e++)M(e)};if(te.length){T.unshift(te);J=T.length;ae()}var ne=0;for(var ie=0;ie<J;ie++)ne=Math.max(T[ie].length,ne);var oe={x:d.x1+d.w/2,y:d.y1+d.h/2};var se=n.reduce((function(t,a){return function(e){return{w:t.w===-1?e.w:(t.w+e.w)/2,h:t.h===-1?e.h:(t.h+e.h)/2}}(a.boundingBox({includeLabels:e.nodeDimensionsIncludeLabels}))}),{w:-1,h:-1});var le=Math.max(J===1?0:u?(d.h-e.padding*2-se.h)/(J-1):(d.h-e.padding*2-se.h)/(J+1),j);var ue=T.reduce((function(e,t){return Math.max(e,t.length)}),0);var ve=function getPosition(t){var a=wu(t),n=a.depth,i=a.index;if(e.circle){var o=Math.min(d.w/2/J,d.h/2/J);o=Math.max(o,j);var s=o*n+o-(J>0&&T[0].length<=3?o/2:0);var l=2*Math.PI/T[n].length*i;n===0&&T[0].length===1&&(s=1);return{x:oe.x+s*Math.cos(l),y:oe.y+s*Math.sin(l)}}var v=T[n].length;var c=Math.max(v===1?0:u?(d.w-e.padding*2-se.w)/((e.grid?ue:v)-1):(d.w-e.padding*2-se.w)/((e.grid?ue:v)+1),j);var h={x:oe.x+(i+1-(v+1)/2)*c,y:oe.y+(n+1-(J+1)/2)*le};return h};a.nodes().layoutPositions(this,e,ve);return this};var Cu={fit:true,padding:30,boundingBox:void 0,avoidOverlap:true,nodeDimensionsIncludeLabels:false,spacingFactor:void 0,radius:void 0,startAngle:1.5*Math.PI,sweep:void 0,clockwise:true,sort:void 0,animate:false,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(e,t){return true},ready:void 0,stop:void 0,transform:function transform(e,t){return t}};function CircleLayout(e){this.options=Y({},Cu,e)}CircleLayout.prototype.run=function(){var e=this.options;var t=e;var a=e.cy;var n=t.eles;var i=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise;var o=n.nodes().not(":parent");t.sort&&(o=o.sort(t.sort));var s=hr(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()});var l={x:s.x1+s.w/2,y:s.y1+s.h/2};var u=t.sweep===void 0?2*Math.PI-2*Math.PI/o.length:t.sweep;var v=u/Math.max(1,o.length-1);var c;var d=0;for(var p=0;p<o.length;p++){var g=o[p];var y=g.layoutDimensions(t);var m=y.w;var b=y.h;d=Math.max(d,m,b)}c=h(t.radius)?t.radius:o.length<=1?0:Math.min(s.h,s.w)/2-d;if(o.length>1&&t.avoidOverlap){d*=1.75;var x=Math.cos(v)-Math.cos(0);var w=Math.sin(v)-Math.sin(0);var E=Math.sqrt(d*d/(x*x+w*w));c=Math.max(E,c)}var T=function getPos(e,a){var n=t.startAngle+a*v*(i?1:-1);var o=c*Math.cos(n);var s=c*Math.sin(n);var u={x:l.x+o,y:l.y+s};return u};n.nodes().layoutPositions(this,t,T);return this};var Tu={fit:true,padding:30,startAngle:1.5*Math.PI,sweep:void 0,clockwise:true,equidistant:false,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:true,nodeDimensionsIncludeLabels:false,height:void 0,width:void 0,spacingFactor:void 0,concentric:function concentric(e){return e.degree()},levelWidth:function levelWidth(e){return e.maxDegree()/4},animate:false,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(e,t){return true},ready:void 0,stop:void 0,transform:function transform(e,t){return t}};function ConcentricLayout(e){this.options=Y({},Tu,e)}ConcentricLayout.prototype.run=function(){var e=this.options;var t=e;var a=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise;var n=e.cy;var i=t.eles;var o=i.nodes().not(":parent");var s=hr(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});var l={x:s.x1+s.w/2,y:s.y1+s.h/2};var u=[];var v=0;for(var c=0;c<o.length;c++){var d=o[c];var h=void 0;h=t.concentric(d);u.push({value:h,node:d});d._private.scratch.concentric=h}o.updateStyle();for(var p=0;p<o.length;p++){var g=o[p];var y=g.layoutDimensions(t);v=Math.max(v,y.w,y.h)}u.sort((function(e,t){return t.value-e.value}));var m=t.levelWidth(o);var b=[[]];var x=b[0];for(var w=0;w<u.length;w++){var E=u[w];if(x.length>0){var T=Math.abs(x[0].value-E.value);if(T>=m){x=[];b.push(x)}}x.push(E)}var S=v+t.minNodeSpacing;if(!t.avoidOverlap){var k=b.length>0&&b[0].length>1;var P=Math.min(s.w,s.h)/2-S;var _=P/(b.length+k?1:0);S=Math.min(S,_)}var D=0;for(var I=0;I<b.length;I++){var M=b[I];var R=t.sweep===void 0?2*Math.PI-2*Math.PI/M.length:t.sweep;var L=M.dTheta=R/Math.max(1,M.length-1);if(M.length>1&&t.avoidOverlap){var N=Math.cos(L)-Math.cos(0);var O=Math.sin(L)-Math.sin(0);var z=Math.sqrt(S*S/(N*N+O*O));D=Math.max(z,D)}M.r=D;D+=S}if(t.equidistant){var V=0;var q=0;for(var j=0;j<b.length;j++){var H=b[j];var W=H.r-q;V=Math.max(V,W)}q=0;for(var X=0;X<b.length;X++){var Y=b[X];X===0&&(q=Y.r);Y.r=q;q+=V}}var G={};for(var K=0;K<b.length;K++){var U=b[K];var Z=U.dTheta;var Q=U.r;for(var J=0;J<U.length;J++){var ee=U[J];var te=t.startAngle+(a?1:-1)*Z*J;var re={x:l.x+Q*Math.cos(te),y:l.y+Q*Math.sin(te)};G[ee.node.id()]=re}}i.nodes().layoutPositions(this,t,(function(e){var t=e.id();return G[t]}));return this};var Su;var ku={ready:function ready(){},stop:function stop(){},animate:true,animationEasing:void 0,animationDuration:void 0,animateFilter:function animateFilter(e,t){return true},animationThreshold:250,refresh:20,fit:true,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:false,randomize:false,componentSpacing:40,nodeRepulsion:function nodeRepulsion(e){return 2048},nodeOverlap:4,idealEdgeLength:function idealEdgeLength(e){return 32},edgeElasticity:function edgeElasticity(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function CoseLayout(e){this.options=Y({},ku,e);this.options.layout=this;var t=this.options.eles.nodes();var a=this.options.eles.edges();var n=a.filter((function(e){var a=e.source().data("id");var n=e.target().data("id");var i=t.some((function(e){return e.data("id")===a}));var o=t.some((function(e){return e.data("id")===n}));return!i||!o}));this.options.eles=this.options.eles.not(n)}CoseLayout.prototype.run=function(){var e=this.options;var t=e.cy;var a=this;a.stopped=false;e.animate!==true&&e.animate!==false||a.emit({type:"layoutstart",layout:a});Su=true===e.debug;var n=Pu(t,a,e);Su&&Au(n);e.randomize&&Bu(n);var i=Oe();var o=function refresh(){Mu(n,t,e);true===e.fit&&t.fit(e.padding)};var s=function mainLoop(t){if(a.stopped||t>=e.numIter)return false;Ru(n,e);n.temperature=n.temperature*e.coolingFactor;return!(n.temperature<e.minTemp)};var l=function done(){if(e.animate===true||e.animate===false){o();a.one("layoutstop",e.stop);a.emit({type:"layoutstop",layout:a})}else{var t=e.eles.nodes();var i=Iu(n,e,t);t.layoutPositions(a,e,i)}};var u=0;var v=true;if(e.animate===true){var c=function frame(){var t=0;while(v&&t<e.refresh){v=s(u);u++;t++}if(v){var a=Oe();a-i>=e.animationThreshold&&o();Ne(c)}else{Yu(n,e);l()}};c()}else{while(v){v=s(u);u++}Yu(n,e);l()}return this};CoseLayout.prototype.stop=function(){this.stopped=true;this.thread&&this.thread.stop();this.emit("layoutstop");return this};CoseLayout.prototype.destroy=function(){this.thread&&this.thread.stop();return this};var Pu=function createLayoutInfo(e,t,a){var n=a.eles.edges();var i=a.eles.nodes();var o=hr(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()});var s={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:i.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:n.size(),temperature:a.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o};var l=a.eles.components();var v={};for(var c=0;c<l.length;c++){var d=l[c];for(var h=0;h<d.length;h++){var p=d[h];v[p.id()]=c}}for(c=0;c<s.nodeSize;c++){var g=i[c];var y=g.layoutDimensions(a);var m={};m.isLocked=g.locked();m.id=g.data("id");m.parentId=g.data("parent");m.cmptId=v[g.id()];m.children=[];m.positionX=g.position("x");m.positionY=g.position("y");m.offsetX=0;m.offsetY=0;m.height=y.w;m.width=y.h;m.maxX=m.positionX+m.width/2;m.minX=m.positionX-m.width/2;m.maxY=m.positionY+m.height/2;m.minY=m.positionY-m.height/2;m.padLeft=parseFloat(g.style("padding"));m.padRight=parseFloat(g.style("padding"));m.padTop=parseFloat(g.style("padding"));m.padBottom=parseFloat(g.style("padding"));m.nodeRepulsion=u(a.nodeRepulsion)?a.nodeRepulsion(g):a.nodeRepulsion;s.layoutNodes.push(m);s.idToIndex[m.id]=c}var b=[];var x=0;var w=-1;var E=[];for(c=0;c<s.nodeSize;c++){g=s.layoutNodes[c];var T=g.parentId;if(null!=T)s.layoutNodes[s.idToIndex[T]].children.push(g.id);else{b[++w]=g.id;E.push(g.id)}}s.graphSet.push(E);while(x<=w){var S=b[x++];var k=s.idToIndex[S];p=s.layoutNodes[k];var P=p.children;if(P.length>0){s.graphSet.push(P);for(c=0;c<P.length;c++)b[++w]=P[c]}}for(c=0;c<s.graphSet.length;c++){var _=s.graphSet[c];for(h=0;h<_.length;h++){var D=s.idToIndex[_[h]];s.indexToGraph[D]=c}}for(c=0;c<s.edgeSize;c++){var I=n[c];var M={};M.id=I.data("id");M.sourceId=I.data("source");M.targetId=I.data("target");var R=u(a.idealEdgeLength)?a.idealEdgeLength(I):a.idealEdgeLength;var L=u(a.edgeElasticity)?a.edgeElasticity(I):a.edgeElasticity;var N=s.idToIndex[M.sourceId];var O=s.idToIndex[M.targetId];var z=s.indexToGraph[N];var V=s.indexToGraph[O];if(z!=V){var q=_u(M.sourceId,M.targetId,s);var j=s.graphSet[q];var H=0;m=s.layoutNodes[N];while(-1===j.indexOf(m.id)){m=s.layoutNodes[s.idToIndex[m.parentId]];H++}m=s.layoutNodes[O];while(-1===j.indexOf(m.id)){m=s.layoutNodes[s.idToIndex[m.parentId]];H++}R*=H*a.nestingFactor}M.idealLength=R;M.elasticity=L;s.layoutEdges.push(M)}return s};var _u=function findLCA(e,t,a){var n=Du(e,t,0,a);return 2>n.count?0:n.graph};var Du=function findLCA_aux(e,t,a,n){var i=n.graphSet[a];if(-1<i.indexOf(e)&&-1<i.indexOf(t))return{count:2,graph:a};var o=0;for(var s=0;s<i.length;s++){var l=i[s];var u=n.idToIndex[l];var v=n.layoutNodes[u].children;if(0!==v.length){var c=n.indexToGraph[n.idToIndex[v[0]]];var d=Du(e,t,c,n);if(0!==d.count){if(1!==d.count)return d;o++;if(2===o)break}}}return{count:o,graph:a}};var Au;var Bu=function randomizePositions(e,t){var a=e.clientWidth;var n=e.clientHeight;for(var i=0;i<e.nodeSize;i++){var o=e.layoutNodes[i];if(0===o.children.length&&!o.isLocked){o.positionX=Math.random()*a;o.positionY=Math.random()*n}}};var Iu=function getScaleInBoundsFn(e,t,a){var n=e.boundingBox;var i={x1:Infinity,x2:-Infinity,y1:Infinity,y2:-Infinity};if(t.boundingBox){a.forEach((function(t){var a=e.layoutNodes[e.idToIndex[t.data("id")]];i.x1=Math.min(i.x1,a.positionX);i.x2=Math.max(i.x2,a.positionX);i.y1=Math.min(i.y1,a.positionY);i.y2=Math.max(i.y2,a.positionY)}));i.w=i.x2-i.x1;i.h=i.y2-i.y1}return function(a,o){var s=e.layoutNodes[e.idToIndex[a.data("id")]];if(t.boundingBox){var l=(s.positionX-i.x1)/i.w;var u=(s.positionY-i.y1)/i.h;return{x:n.x1+l*n.w,y:n.y1+u*n.h}}return{x:s.positionX,y:s.positionY}}};var Mu=function refreshPositions(e,t,a){var n=a.layout;var i=a.eles.nodes();var o=Iu(e,a,i);i.positions(o);if(true!==e.ready){e.ready=true;n.one("layoutready",a.ready);n.emit({type:"layoutready",layout:this})}};var Ru=function step(e,t,a){Lu(e,t);Vu(e);qu(e,t);ju(e);Hu(e)};var Lu=function calculateNodeForces(e,t){for(var a=0;a<e.graphSet.length;a++){var n=e.graphSet[a];var i=n.length;for(var o=0;o<i;o++){var s=e.layoutNodes[e.idToIndex[n[o]]];for(var l=o+1;l<i;l++){var u=e.layoutNodes[e.idToIndex[n[l]]];Ou(s,u,e,t)}}}};var Nu=function randomDistance(e){return 2*e*Math.random()-1};var Ou=function nodeRepulsion(e,t,a,n){var i=e.cmptId;var o=t.cmptId;if(i===o||a.isCompound){var s=t.positionX-e.positionX;var l=t.positionY-e.positionY;var u=1;if(0===s&&0===l){s=Nu(u);l=Nu(u)}var v=Fu(e,t,s,l);if(v>0){var c=n.nodeOverlap*v;var d=Math.sqrt(s*s+l*l);var h=c*s/d;var p=c*l/d}else{var g=zu(e,s,l);var y=zu(t,-1*s,-1*l);var m=y.x-g.x;var b=y.y-g.y;var x=m*m+b*b;d=Math.sqrt(x);c=(e.nodeRepulsion+t.nodeRepulsion)/x;h=c*m/d;p=c*b/d}if(!e.isLocked){e.offsetX-=h;e.offsetY-=p}if(!t.isLocked){t.offsetX+=h;t.offsetY+=p}}};var Fu=function nodesOverlap(e,t,a,n){if(a>0)var i=e.maxX-t.minX;else i=t.maxX-e.minX;if(n>0)var o=e.maxY-t.minY;else o=t.maxY-e.minY;return i>=0&&o>=0?Math.sqrt(i*i+o*o):0};var zu=function findClippingPoint(e,t,a){var n=e.positionX;var i=e.positionY;var o=e.height||1;var s=e.width||1;var l=a/t;var u=o/s;var v={};if(0===t&&0<a){v.x=n;v.y=i+o/2;return v}if(0===t&&0>a){v.x=n;v.y=i+o/2;return v}if(0<t&&-1*u<=l&&l<=u){v.x=n+s/2;v.y=i+s*a/2/t;return v}if(0>t&&-1*u<=l&&l<=u){v.x=n-s/2;v.y=i-s*a/2/t;return v}if(0<a&&(l<=-1*u||l>=u)){v.x=n+o*t/2/a;v.y=i+o/2;return v}if(0>a&&(l<=-1*u||l>=u)){v.x=n-o*t/2/a;v.y=i-o/2;return v}return v};var Vu=function calculateEdgeForces(e,t){for(var a=0;a<e.edgeSize;a++){var n=e.layoutEdges[a];var i=e.idToIndex[n.sourceId];var o=e.layoutNodes[i];var s=e.idToIndex[n.targetId];var l=e.layoutNodes[s];var u=l.positionX-o.positionX;var v=l.positionY-o.positionY;if(0!==u||0!==v){var c=zu(o,u,v);var d=zu(l,-1*u,-1*v);var h=d.x-c.x;var p=d.y-c.y;var g=Math.sqrt(h*h+p*p);var y=Math.pow(n.idealLength-g,2)/n.elasticity;if(0!==g){var m=y*h/g;var b=y*p/g}else{m=0;b=0}if(!o.isLocked){o.offsetX+=m;o.offsetY+=b}if(!l.isLocked){l.offsetX-=m;l.offsetY-=b}}}};var qu=function calculateGravityForces(e,t){if(t.gravity!==0){var a=1;for(var n=0;n<e.graphSet.length;n++){var i=e.graphSet[n];var o=i.length;if(0===n){var s=e.clientHeight/2;var l=e.clientWidth/2}else{var u=e.layoutNodes[e.idToIndex[i[0]]];var v=e.layoutNodes[e.idToIndex[u.parentId]];s=v.positionX;l=v.positionY}for(var c=0;c<o;c++){var d=e.layoutNodes[e.idToIndex[i[c]]];if(!d.isLocked){var h=s-d.positionX;var p=l-d.positionY;var g=Math.sqrt(h*h+p*p);if(g>a){var y=t.gravity*h/g;var m=t.gravity*p/g;d.offsetX+=y;d.offsetY+=m}}}}}};var ju=function propagateForces(e,t){var a=[];var n=0;var i=-1;a.push.apply(a,e.graphSet[0]);i+=e.graphSet[0].length;while(n<=i){var o=a[n++];var s=e.idToIndex[o];var l=e.layoutNodes[s];var u=l.children;if(0<u.length&&!l.isLocked){var v=l.offsetX;var c=l.offsetY;for(var d=0;d<u.length;d++){var h=e.layoutNodes[e.idToIndex[u[d]]];h.offsetX+=v;h.offsetY+=c;a[++i]=u[d]}l.offsetX=0;l.offsetY=0}}};var Hu=function updatePositions(e,t){for(var a=0;a<e.nodeSize;a++){var n=e.layoutNodes[a];if(0<n.children.length){n.maxX=void 0;n.minX=void 0;n.maxY=void 0;n.minY=void 0}}for(a=0;a<e.nodeSize;a++){n=e.layoutNodes[a];if(!(0<n.children.length||n.isLocked)){var i=Wu(n.offsetX,n.offsetY,e.temperature);n.positionX+=i.x;n.positionY+=i.y;n.offsetX=0;n.offsetY=0;n.minX=n.positionX-n.width;n.maxX=n.positionX+n.width;n.minY=n.positionY-n.height;n.maxY=n.positionY+n.height;Xu(n,e)}}for(a=0;a<e.nodeSize;a++){n=e.layoutNodes[a];if(0<n.children.length&&!n.isLocked){n.positionX=(n.maxX+n.minX)/2;n.positionY=(n.maxY+n.minY)/2;n.width=n.maxX-n.minX;n.height=n.maxY-n.minY}}};var Wu=function limitForce(e,t,a){var n=Math.sqrt(e*e+t*t);if(n>a)var i={x:a*e/n,y:a*t/n};else i={x:e,y:t};return i};var Xu=function updateAncestryBoundaries(e,t){var a=e.parentId;if(null!=a){var n=t.layoutNodes[t.idToIndex[a]];var i=false;if(null==n.maxX||e.maxX+n.padRight>n.maxX){n.maxX=e.maxX+n.padRight;i=true}if(null==n.minX||e.minX-n.padLeft<n.minX){n.minX=e.minX-n.padLeft;i=true}if(null==n.maxY||e.maxY+n.padBottom>n.maxY){n.maxY=e.maxY+n.padBottom;i=true}if(null==n.minY||e.minY-n.padTop<n.minY){n.minY=e.minY-n.padTop;i=true}return i?Xu(n,t):void 0}};var Yu=function separateComponents(e,t){var a=e.layoutNodes;var n=[];for(var i=0;i<a.length;i++){var o=a[i];var s=o.cmptId;var l=n[s]=n[s]||[];l.push(o)}var u=0;for(i=0;i<n.length;i++){var v=n[i];if(v){v.x1=Infinity;v.x2=-Infinity;v.y1=Infinity;v.y2=-Infinity;for(var c=0;c<v.length;c++){var d=v[c];v.x1=Math.min(v.x1,d.positionX-d.width/2);v.x2=Math.max(v.x2,d.positionX+d.width/2);v.y1=Math.min(v.y1,d.positionY-d.height/2);v.y2=Math.max(v.y2,d.positionY+d.height/2)}v.w=v.x2-v.x1;v.h=v.y2-v.y1;u+=v.w*v.h}}n.sort((function(e,t){return t.w*t.h-e.w*e.h}));var h=0;var p=0;var g=0;var y=0;var m=Math.sqrt(u)*e.clientWidth/e.clientHeight;for(i=0;i<n.length;i++){v=n[i];if(v){for(c=0;c<v.length;c++){d=v[c];if(!d.isLocked){d.positionX+=h-v.x1;d.positionY+=p-v.y1}}h+=v.w+t.componentSpacing;g+=v.w+t.componentSpacing;y=Math.max(y,v.h);if(g>m){p+=y+t.componentSpacing;h=0;g=0;y=0}}}};var Gu={fit:true,padding:30,boundingBox:void 0,avoidOverlap:true,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:false,spacingFactor:void 0,condense:false,rows:void 0,cols:void 0,position:function position(e){},sort:void 0,animate:false,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(e,t){return true},ready:void 0,stop:void 0,transform:function transform(e,t){return t}};function GridLayout(e){this.options=Y({},Gu,e)}GridLayout.prototype.run=function(){var e=this.options;var t=e;var a=e.cy;var n=t.eles;var i=n.nodes().not(":parent");t.sort&&(i=i.sort(t.sort));var o=hr(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()});if(o.h===0||o.w===0)n.nodes().layoutPositions(this,t,(function(e){return{x:o.x1,y:o.y1}}));else{var s=i.size();var l=Math.sqrt(s*o.h/o.w);var u=Math.round(l);var v=Math.round(o.w/o.h*l);var c=function small(e){if(e==null)return Math.min(u,v);var t=Math.min(u,v);t==u?u=e:v=e};var d=function large(e){if(e==null)return Math.max(u,v);var t=Math.max(u,v);t==u?u=e:v=e};var h=t.rows;var p=t.cols!=null?t.cols:t.columns;if(h!=null&&p!=null){u=h;v=p}else if(h!=null&&p==null){u=h;v=Math.ceil(s/u)}else if(h==null&&p!=null){v=p;u=Math.ceil(s/v)}else if(v*u>s){var g=c();var y=d();(g-1)*y>=s?c(g-1):(y-1)*g>=s&&d(y-1)}else while(v*u<s){var m=c();var b=d();(b+1)*m>=s?d(b+1):c(m+1)}var x=o.w/v;var w=o.h/u;if(t.condense){x=0;w=0}if(t.avoidOverlap)for(var E=0;E<i.length;E++){var T=i[E];var S=T._private.position;if(S.x==null||S.y==null){S.x=0;S.y=0}var k=T.layoutDimensions(t);var P=t.avoidOverlapPadding;var _=k.w+P;var D=k.h+P;x=Math.max(x,_);w=Math.max(w,D)}var I={};var M=function used(e,t){return!!I["c-"+e+"-"+t]};var R=function use(e,t){I["c-"+e+"-"+t]=true};var L=0;var N=0;var O=function moveToNextCell(){N++;if(N>=v){N=0;L++}};var z={};for(var V=0;V<i.length;V++){var q=i[V];var j=t.position(q);if(j&&(j.row!==void 0||j.col!==void 0)){var H={row:j.row,col:j.col};if(H.col===void 0){H.col=0;while(M(H.row,H.col))H.col++}else if(H.row===void 0){H.row=0;while(M(H.row,H.col))H.row++}z[q.id()]=H;R(H.row,H.col)}}var W=function getPos(e,t){var a,n;if(e.locked()||e.isParent())return false;var i=z[e.id()];if(i){a=i.col*x+x/2+o.x1;n=i.row*w+w/2+o.y1}else{while(M(L,N))O();a=N*x+x/2+o.x1;n=L*w+w/2+o.y1;R(L,N);O()}return{x:a,y:n}};i.layoutPositions(this,t,W)}return this};var Ku={ready:function ready(){},stop:function stop(){}};function NullLayout(e){this.options=Y({},Ku,e)}NullLayout.prototype.run=function(){var e=this.options;var t=e.eles;var a=this;e.cy;a.emit("layoutstart");t.nodes().positions((function(){return{x:0,y:0}}));a.one("layoutready",e.ready);a.emit("layoutready");a.one("layoutstop",e.stop);a.emit("layoutstop");return this};NullLayout.prototype.stop=function(){return this};var Uu={positions:void 0,zoom:void 0,pan:void 0,fit:true,padding:30,spacingFactor:void 0,animate:false,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(e,t){return true},ready:void 0,stop:void 0,transform:function transform(e,t){return t}};function PresetLayout(e){this.options=Y({},Uu,e)}PresetLayout.prototype.run=function(){var e=this.options;var t=e.eles;var a=t.nodes();var n=u(e.positions);function getPosition(t){if(e.positions==null)return Kt(t.position());if(n)return e.positions(t);var a=e.positions[t._private.data.id];return a==null?null:a}a.layoutPositions(this,e,(function(e,t){var a=getPosition(e);return!e.locked()&&a!=null&&a}));return this};var Zu={fit:true,padding:30,boundingBox:void 0,animate:false,animationDuration:500,animationEasing:void 0,animateFilter:function animateFilter(e,t){return true},ready:void 0,stop:void 0,transform:function transform(e,t){return t}};function RandomLayout(e){this.options=Y({},Zu,e)}RandomLayout.prototype.run=function(){var e=this.options;var t=e.cy;var a=e.eles;var n=hr(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});var i=function getPos(e,t){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};a.nodes().layoutPositions(this,e,i);return this};var $u=[{name:"breadthfirst",impl:BreadthFirstLayout},{name:"circle",impl:CircleLayout},{name:"concentric",impl:ConcentricLayout},{name:"cose",impl:CoseLayout},{name:"grid",impl:GridLayout},{name:"null",impl:NullLayout},{name:"preset",impl:PresetLayout},{name:"random",impl:RandomLayout}];function NullRenderer(e){this.options=e;this.notifications=0}var Qu=function noop(){};var Ju=function throwImgErr(){throw new Error("A headless instance can not render images")};NullRenderer.prototype={recalculateRenderedStyle:Qu,notify:function notify(){this.notifications++},init:Qu,isHeadless:function isHeadless(){return true},png:Ju,jpg:Ju};var ev={};ev.arrowShapeWidth=.3;ev.registerArrowShapes=function(){var e=this.arrowShapes={};var t=this;var a=function bbCollide(e,t,a,n,i,o,s){var l=i.x-a/2-s;var u=i.x+a/2+s;var v=i.y-a/2-s;var c=i.y+a/2+s;var d=l<=e&&e<=u&&v<=t&&t<=c;return d};var n=function transform(e,t,a,n,i){var o=e*Math.cos(n)-t*Math.sin(n);var s=e*Math.sin(n)+t*Math.cos(n);var l=o*a;var u=s*a;var v=l+i.x;var c=u+i.y;return{x:v,y:c}};var i=function transformPoints(e,t,a,i){var o=[];for(var s=0;s<e.length;s+=2){var l=e[s];var u=e[s+1];o.push(n(l,u,t,a,i))}return o};var o=function pointsToArr(e){var t=[];for(var a=0;a<e.length;a++){var n=e[a];t.push(n.x,n.y)}return t};var s=function standardGap(e){return e.pstyle("width").pfValue*e.pstyle("arrow-scale").pfValue*2};var u=function defineArrowShape(n,u){l(u)&&(u=e[u]);e[n]=Y({name:n,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function collide(e,t,a,n,s,l){var u=o(i(this.points,a+2*l,n,s));var v=Mr(e,t,u);return v},roughCollide:a,draw:function draw(e,a,n,o){var s=i(this.points,a,n,o);t.arrowShapeImpl("polygon")(e,s)},spacing:function spacing(e){return 0},gap:s},u)};u("none",{collide:rt,roughCollide:rt,draw:nt,spacing:at,gap:at});u("triangle",{points:[-.15,-.3,0,0,.15,-.3]});u("arrow","triangle");u("triangle-backcurve",{points:e.triangle.points,controlPoint:[0,-.15],roughCollide:a,draw:function draw(e,a,o,s,l){var u=i(this.points,a,o,s);var v=this.controlPoint;var c=n(v[0],v[1],a,o,s);t.arrowShapeImpl(this.name)(e,u,c)},gap:function gap(e){return s(e)*.8}});u("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function collide(e,t,a,n,s,l,u){var v=o(i(this.points,a+2*u,n,s));var c=o(i(this.pointsTee,a+2*u,n,s));var d=Mr(e,t,v)||Mr(e,t,c);return d},draw:function draw(e,a,n,o,s){var l=i(this.points,a,n,o);var u=i(this.pointsTee,a,n,o);t.arrowShapeImpl(this.name)(e,l,u)}});u("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function collide(e,t,a,n,s,l,u){var v=s;var c=Math.pow(v.x-e,2)+Math.pow(v.y-t,2)<=Math.pow((a+2*u)*this.radius,2);var d=o(i(this.points,a+2*u,n,s));return Mr(e,t,d)||c},draw:function draw(e,a,n,o,s){var l=i(this.pointsTr,a,n,o);t.arrowShapeImpl(this.name)(e,l,o.x,o.y,this.radius*a)},spacing:function spacing(e){return t.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.radius}});u("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function crossLinePts(e,t){var a=this.baseCrossLinePts.slice();var n=t/e;var i=3;var o=5;a[i]=a[i]-n;a[o]=a[o]-n;return a},collide:function collide(e,t,a,n,s,l,u){var v=o(i(this.points,a+2*u,n,s));var c=o(i(this.crossLinePts(a,l),a+2*u,n,s));var d=Mr(e,t,v)||Mr(e,t,c);return d},draw:function draw(e,a,n,o,s){var l=i(this.points,a,n,o);var u=i(this.crossLinePts(a,s),a,n,o);t.arrowShapeImpl(this.name)(e,l,u)}});u("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function gap(e){return s(e)*.525}});u("circle",{radius:.15,collide:function collide(e,t,a,n,i,o,s){var l=i;var u=Math.pow(l.x-e,2)+Math.pow(l.y-t,2)<=Math.pow((a+2*s)*this.radius,2);return u},draw:function draw(e,a,n,i,o){t.arrowShapeImpl(this.name)(e,i.x,i.y,this.radius*a)},spacing:function spacing(e){return t.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.radius}});u("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function spacing(e){return 1},gap:function gap(e){return 1}});u("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]});u("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function gap(e){return e.pstyle("width").pfValue*e.pstyle("arrow-scale").value}});u("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function gap(e){return.95*e.pstyle("width").pfValue*e.pstyle("arrow-scale").value}})};var tv={};tv.projectIntoViewport=function(e,t){var a=this.cy;var n=this.findContainerClientCoords();var i=n[0];var o=n[1];var s=n[4];var l=a.pan();var u=a.zoom();var v=((e-i)/s-l.x)/u;var c=((t-o)/s-l.y)/u;return[v,c]};tv.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var e=this.container;var t=e.getBoundingClientRect();var a=this.cy.window().getComputedStyle(e);var n=function styleValue(e){return parseFloat(a.getPropertyValue(e))};var i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")};var o={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")};var s=e.clientWidth;var l=e.clientHeight;var u=i.left+i.right;var v=i.top+i.bottom;var c=o.left+o.right;var d=t.width/(s+c);var h=s-u;var p=l-v;var g=t.left+i.left+o.left;var y=t.top+i.top+o.top;return this.containerBB=[g,y,h,p,d]};tv.invalidateContainerClientCoordsCache=function(){this.containerBB=null};tv.findNearestElement=function(e,t,a,n){return this.findNearestElements(e,t,a,n)[0]};tv.findNearestElements=function(e,t,a,n){var i=this;var o=this;var s=o.getCachedZSortedEles();var l=[];var u=o.cy.zoom();var v=o.cy.hasCompoundNodes();var c=(n?24:8)/u;var d=(n?8:2)/u;var h=(n?8:2)/u;var p=Infinity;var g;var y;a&&(s=s.interactive);function addEle(e,t){if(e.isNode()){if(y)return;y=e;l.push(e)}if(e.isEdge()&&(t==null||t<p))if(g){if(g.pstyle("z-compound-depth").value===e.pstyle("z-compound-depth").value&&g.pstyle("z-compound-depth").value===e.pstyle("z-compound-depth").value)for(var a=0;a<l.length;a++)if(l[a].isEdge()){l[a]=e;g=e;p=t!=null?t:p;break}}else{l.push(e);g=e;p=t!=null?t:p}}function checkNode(a){var n=a.outerWidth()+2*d;var s=a.outerHeight()+2*d;var l=n/2;var u=s/2;var v=a.position();var c=a.pstyle("corner-radius").value==="auto"?"auto":a.pstyle("corner-radius").pfValue;var h=a._private.rscratch;if(v.x-l<=e&&e<=v.x+l&&v.y-u<=t&&t<=v.y+u){var p=o.nodeShapes[i.getNodeShape(a)];if(p.checkPoint(e,t,0,n,s,v.x,v.y,c,h)){addEle(a,0);return true}}}function checkEdge(a){var n=a._private;var s=n.rscratch;var u=a.pstyle("width").pfValue;var d=a.pstyle("arrow-scale").value;var h=u/2+c;var p=h*h;var g=h*2;var y=n.source;var m=n.target;var b;if(s.edgeType==="segments"||s.edgeType==="straight"||s.edgeType==="haystack"){var x=s.allpts;for(var w=0;w+3<x.length;w+=2)if(Pr(e,t,x[w],x[w+1],x[w+2],x[w+3],g)&&p>(b=Ir(e,t,x[w],x[w+1],x[w+2],x[w+3]))){addEle(a,b);return true}}else if(s.edgeType==="bezier"||s.edgeType==="multibezier"||s.edgeType==="self"||s.edgeType==="compound"){x=s.allpts;for(w=0;w+5<s.allpts.length;w+=4)if(_r(e,t,x[w],x[w+1],x[w+2],x[w+3],x[w+4],x[w+5],g)&&p>(b=Br(e,t,x[w],x[w+1],x[w+2],x[w+3],x[w+4],x[w+5]))){addEle(a,b);return true}}y=y||n.source;m=m||n.target;var E=i.getArrowWidth(u,d);var T=[{name:"source",x:s.arrowStartX,y:s.arrowStartY,angle:s.srcArrowAngle},{name:"target",x:s.arrowEndX,y:s.arrowEndY,angle:s.tgtArrowAngle},{name:"mid-source",x:s.midX,y:s.midY,angle:s.midsrcArrowAngle},{name:"mid-target",x:s.midX,y:s.midY,angle:s.midtgtArrowAngle}];for(w=0;w<T.length;w++){var S=T[w];var k=o.arrowShapes[a.pstyle(S.name+"-arrow-shape").value];var P=a.pstyle("width").pfValue;if(k.roughCollide(e,t,E,S.angle,{x:S.x,y:S.y},P,c)&&k.collide(e,t,E,S.angle,{x:S.x,y:S.y},P,c)){addEle(a);return true}}if(v&&l.length>0){checkNode(y);checkNode(m)}}function preprop(e,t,a){return mt(e,t,a)}function checkLabel(a,n){var i=a._private;var o=h;var s;s=n?n+"-":"";a.boundingBox();var l=i.labelBounds[n||"main"];var u=a.pstyle(s+"label").value;var v=a.pstyle("text-events").strValue==="yes";if(v&&u){var c=preprop(i.rscratch,"labelX",n);var d=preprop(i.rscratch,"labelY",n);var p=preprop(i.rscratch,"labelAngle",n);var g=a.pstyle(s+"text-margin-x").pfValue;var y=a.pstyle(s+"text-margin-y").pfValue;var m=l.x1-o-g;var b=l.x2+o-g;var x=l.y1-o-y;var w=l.y2+o-y;if(p){var E=Math.cos(p);var T=Math.sin(p);var S=function rotate(e,t){e-=c;t-=d;return{x:e*E-t*T+c,y:e*T+t*E+d}};var k=S(m,x);var P=S(m,w);var _=S(b,x);var D=S(b,w);var I=[k.x+g,k.y+y,_.x+g,_.y+y,D.x+g,D.y+y,P.x+g,P.y+y];if(Mr(e,t,I)){addEle(a);return true}}else if(Cr(l,e,t)){addEle(a);return true}}}for(var m=s.length-1;m>=0;m--){var b=s[m];b.isNode()?checkNode(b)||checkLabel(b):checkEdge(b)||checkLabel(b)||checkLabel(b,"source")||checkLabel(b,"target")}return l};tv.getAllInBox=function(e,t,a,n){var i=this.getCachedZSortedEles().interactive;var o=[];var s=Math.min(e,a);var l=Math.max(e,a);var u=Math.min(t,n);var v=Math.max(t,n);e=s;a=l;t=u;n=v;var c=hr({x1:e,y1:t,x2:a,y2:n});for(var d=0;d<i.length;d++){var h=i[d];if(h.isNode()){var p=h;var g=p.boundingBox({includeNodes:true,includeEdges:false,includeLabels:false});Er(c,g)&&!Sr(g,c)&&o.push(p)}else{var y=h;var m=y._private;var b=m.rscratch;if(b.startX!=null&&b.startY!=null&&!Cr(c,b.startX,b.startY))continue;if(b.endX!=null&&b.endY!=null&&!Cr(c,b.endX,b.endY))continue;if(b.edgeType==="bezier"||b.edgeType==="multibezier"||b.edgeType==="self"||b.edgeType==="compound"||b.edgeType==="segments"||b.edgeType==="haystack"){var x=m.rstyle.bezierPts||m.rstyle.linePts||m.rstyle.haystackPts;var w=true;for(var E=0;E<x.length;E++)if(!Tr(c,x[E])){w=false;break}w&&o.push(y)}else b.edgeType!=="haystack"&&b.edgeType!=="straight"||o.push(y)}}return o};var rv={};rv.calculateArrowAngles=function(e){var t=e._private.rscratch;var a=t.edgeType==="haystack";var n=t.edgeType==="bezier";var i=t.edgeType==="multibezier";var o=t.edgeType==="segments";var s=t.edgeType==="compound";var l=t.edgeType==="self";var u,v;var c,d,h,p;if(a){c=t.haystackPts[0];d=t.haystackPts[1];h=t.haystackPts[2];p=t.haystackPts[3]}else{c=t.arrowStartX;d=t.arrowStartY;h=t.arrowEndX;p=t.arrowEndY}b=t.midX;x=t.midY;if(o){u=c-t.segpts[0];v=d-t.segpts[1]}else if(i||s||l||n){var g=t.allpts;var y=ur(g[0],g[2],g[4],.1);var m=ur(g[1],g[3],g[5],.1);u=c-y;v=d-m}else{u=c-b;v=d-x}t.srcArrowAngle=ar(u,v);var b=t.midX;var x=t.midY;if(a){b=(c+h)/2;x=(d+p)/2}u=h-c;v=p-d;if(o){g=t.allpts;if(g.length/2%2===0){var w=g.length/2;var E=w-2;u=g[w]-g[E];v=g[w+1]-g[E+1]}else if(t.isRound){u=t.midVector[1];v=-t.midVector[0]}else{w=g.length/2-1;E=w-2;u=g[w]-g[E];v=g[w+1]-g[E+1]}}else if(i||s||l){g=t.allpts;var T=t.ctrlpts;var S,k;var P,_;if(T.length/2%2===0){var D=g.length/2-1;var I=D+2;var M=I+2;S=ur(g[D],g[I],g[M],0);k=ur(g[D+1],g[I+1],g[M+1],0);P=ur(g[D],g[I],g[M],1e-4);_=ur(g[D+1],g[I+1],g[M+1],1e-4)}else{I=g.length/2-1;D=I-2;M=I+2;S=ur(g[D],g[I],g[M],.4999);k=ur(g[D+1],g[I+1],g[M+1],.4999);P=ur(g[D],g[I],g[M],.5);_=ur(g[D+1],g[I+1],g[M+1],.5)}u=P-S;v=_-k}t.midtgtArrowAngle=ar(u,v);t.midDispX=u;t.midDispY=v;u*=-1;v*=-1;if(o){g=t.allpts;if(g.length/2%2===0);else if(!t.isRound){w=g.length/2-1;var R=w+2;u=-(g[R]-g[w]);v=-(g[R+1]-g[w+1])}}t.midsrcArrowAngle=ar(u,v);if(o){u=h-t.segpts[t.segpts.length-2];v=p-t.segpts[t.segpts.length-1]}else if(i||s||l||n){g=t.allpts;var L=g.length;y=ur(g[L-6],g[L-4],g[L-2],.9);m=ur(g[L-5],g[L-3],g[L-1],.9);u=h-y;v=p-m}else{u=h-b;v=p-x}t.tgtArrowAngle=ar(u,v)};rv.getArrowWidth=rv.getArrowHeight=function(e,t){var a=this.arrowWidthCache=this.arrowWidthCache||{};var n=a[e+", "+t];if(n)return n;n=Math.max(Math.pow(e*13.37,.9),29)*t;a[e+", "+t]=n;return n};var av,nv,iv,ov,sv,lv,uv,vv,cv,dv,hv,fv,pv={},gv={};var yv,mv,bv,xv;var wv;var Ev=function asVec(e,t,a){a.x=t.x-e.x;a.y=t.y-e.y;a.len=Math.sqrt(a.x*a.x+a.y*a.y);a.nx=a.x/a.len;a.ny=a.y/a.len;a.ang=Math.atan2(a.ny,a.nx)};var Cv=function invertVec(e,t){t.x=e.x*-1;t.y=e.y*-1;t.nx=e.nx*-1;t.ny=e.ny*-1;t.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang};var Tv=function calcCornerArc(e,t,a,n,i){e!==wv?Ev(t,e,pv):Cv(gv,pv);Ev(t,a,gv);iv=pv.nx*gv.ny-pv.ny*gv.nx;ov=pv.nx*gv.nx-pv.ny*-gv.ny;uv=Math.asin(Math.max(-1,Math.min(1,iv)));if(Math.abs(uv)<1e-6){av=t.x;nv=t.y;cv=hv=0}else{sv=1;lv=false;if(ov<0)if(uv<0)uv=Math.PI+uv;else{uv=Math.PI-uv;sv=-1;lv=true}else if(uv>0){sv=-1;lv=true}hv=t.radius!==void 0?t.radius:n;vv=uv/2;fv=Math.min(pv.len/2,gv.len/2);if(i){dv=Math.abs(Math.cos(vv)*hv/Math.sin(vv));if(dv>fv){dv=fv;cv=Math.abs(dv*Math.sin(vv)/Math.cos(vv))}else cv=hv}else{dv=Math.min(fv,hv);cv=Math.abs(dv*Math.sin(vv)/Math.cos(vv))}bv=t.x+gv.nx*dv;xv=t.y+gv.ny*dv;av=bv-gv.ny*cv*sv;nv=xv+gv.nx*cv*sv;yv=t.x+pv.nx*dv;mv=t.y+pv.ny*dv;wv=t}};
/**
 * Draw corner provided by {@link getRoundCorner}
 *
 * @param ctx :CanvasRenderingContext2D
 * @param roundCorner {{cx:number, cy:number, radius:number, endAngle: number, startAngle: number, counterClockwise: boolean}}
 */function drawPreparedRoundCorner(e,t){t.radius===0?e.lineTo(t.cx,t.cy):e.arc(t.cx,t.cy,t.radius,t.startAngle,t.endAngle,t.counterClockwise)}
/**
 * Get round corner from a point and its previous and next neighbours in a path
 *
 * @param previousPoint {{x: number, y:number, radius: number?}}
 * @param currentPoint {{x: number, y:number, radius: number?}}
 * @param nextPoint {{x: number, y:number, radius: number?}}
 * @param radiusMax :number
 * @param isArcRadius :boolean
 * @return {{
 * cx:number, cy:number, radius:number,
 * startX:number, startY:number,
 * stopX:number, stopY: number,
 * endAngle: number, startAngle: number, counterClockwise: boolean
 * }}
 */function getRoundCorner(e,t,a,n){var i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(n===0||t.radius===0)return{cx:t.x,cy:t.y,radius:0,startX:t.x,startY:t.y,stopX:t.x,stopY:t.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0};Tv(e,t,a,n,i);return{cx:av,cy:nv,radius:cv,startX:yv,startY:mv,stopX:bv,stopY:xv,startAngle:pv.ang+Math.PI/2*sv,endAngle:gv.ang-Math.PI/2*sv,counterClockwise:lv}}var Sv=.01;var kv=Math.sqrt(2*Sv);var Pv={};Pv.findMidptPtsEtc=function(e,t){var a=t.posPts,n=t.intersectionPts,i=t.vectorNormInverse;var o;var s=e.pstyle("source-endpoint");var l=e.pstyle("target-endpoint");var u=s.units!=null&&l.units!=null;var v=function recalcVectorNormInverse(e,t,a,n){var i=n-t;var o=a-e;var s=Math.sqrt(o*o+i*i);return{x:-i/s,y:o/s}};var c=e.pstyle("edge-distances").value;switch(c){case"node-position":o=a;break;case"intersection":o=n;break;case"endpoints":if(u){var d=this.manualEndptToPx(e.source()[0],s),h=_slicedToArray(d,2),p=h[0],g=h[1];var y=this.manualEndptToPx(e.target()[0],l),m=_slicedToArray(y,2),b=m[0],x=m[1];var w={x1:p,y1:g,x2:b,y2:x};i=v(p,g,b,x);o=w}else{st("Edge ".concat(e.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default)."));o=n}break}return{midptPts:o,vectorNormInverse:i}};Pv.findHaystackPoints=function(e){for(var t=0;t<e.length;t++){var a=e[t];var n=a._private;var i=n.rscratch;if(!i.haystack){var o=Math.random()*2*Math.PI;i.source={x:Math.cos(o),y:Math.sin(o)};o=Math.random()*2*Math.PI;i.target={x:Math.cos(o),y:Math.sin(o)}}var s=n.source;var l=n.target;var u=s.position();var v=l.position();var c=s.width();var d=l.width();var h=s.height();var p=l.height();var g=a.pstyle("haystack-radius").value;var y=g/2;i.haystackPts=i.allpts=[i.source.x*c*y+u.x,i.source.y*h*y+u.y,i.target.x*d*y+v.x,i.target.y*p*y+v.y];i.midX=(i.allpts[0]+i.allpts[2])/2;i.midY=(i.allpts[1]+i.allpts[3])/2;i.edgeType="haystack";i.haystack=true;this.storeEdgeProjections(a);this.calculateArrowAngles(a);this.recalculateEdgeLabelProjections(a);this.calculateLabelAngles(a)}};Pv.findSegmentsPoints=function(e,t){var a=e._private.rscratch;var n=e.pstyle("segment-weights");var i=e.pstyle("segment-distances");var o=e.pstyle("segment-radii");var s=e.pstyle("radius-type");var l=Math.min(n.pfValue.length,i.pfValue.length);var u=o.pfValue[o.pfValue.length-1];var v=s.pfValue[s.pfValue.length-1];a.edgeType="segments";a.segpts=[];a.radii=[];a.isArcRadius=[];for(var c=0;c<l;c++){var d=n.pfValue[c];var h=i.pfValue[c];var p=1-d;var g=d;var y=this.findMidptPtsEtc(e,t),m=y.midptPts,b=y.vectorNormInverse;var x={x:m.x1*p+m.x2*g,y:m.y1*p+m.y2*g};a.segpts.push(x.x+b.x*h,x.y+b.y*h);a.radii.push(o.pfValue[c]!==void 0?o.pfValue[c]:u);a.isArcRadius.push((s.pfValue[c]!==void 0?s.pfValue[c]:v)==="arc-radius")}};Pv.findLoopPoints=function(e,t,a,n){var i=e._private.rscratch;var o=t.dirCounts,s=t.srcPos;var l=e.pstyle("control-point-distances");var u=l?l.pfValue[0]:void 0;var v=e.pstyle("loop-direction").pfValue;var c=e.pstyle("loop-sweep").pfValue;var d=e.pstyle("control-point-step-size").pfValue;i.edgeType="self";var h=a;var p=d;if(n){h=0;p=u}var g=v-Math.PI/2;var y=g-c/2;var m=g+c/2;var b=String(v+"_"+c);h=o[b]===void 0?o[b]=0:++o[b];i.ctrlpts=[s.x+Math.cos(y)*1.4*p*(h/3+1),s.y+Math.sin(y)*1.4*p*(h/3+1),s.x+Math.cos(m)*1.4*p*(h/3+1),s.y+Math.sin(m)*1.4*p*(h/3+1)]};Pv.findCompoundLoopPoints=function(e,t,a,n){var i=e._private.rscratch;i.edgeType="compound";var o=t.srcPos,s=t.tgtPos,l=t.srcW,u=t.srcH,v=t.tgtW,c=t.tgtH;var d=e.pstyle("control-point-step-size").pfValue;var h=e.pstyle("control-point-distances");var p=h?h.pfValue[0]:void 0;var g=a;var y=d;if(n){g=0;y=p}var m=50;var b={x:o.x-l/2,y:o.y-u/2};var x={x:s.x-v/2,y:s.y-c/2};var w={x:Math.min(b.x,x.x),y:Math.min(b.y,x.y)};var E=.5;var T=Math.max(E,Math.log(l*Sv));var S=Math.max(E,Math.log(v*Sv));i.ctrlpts=[w.x,w.y-(1+Math.pow(m,1.12)/100)*y*(g/3+1)*T,w.x-(1+Math.pow(m,1.12)/100)*y*(g/3+1)*S,w.y]};Pv.findStraightEdgePoints=function(e){e._private.rscratch.edgeType="straight"};Pv.findBezierPoints=function(e,t,a,n,i){var o=e._private.rscratch;var s=e.pstyle("control-point-step-size").pfValue;var l=e.pstyle("control-point-distances");var u=e.pstyle("control-point-weights");var v=l&&u?Math.min(l.value.length,u.value.length):1;var c=l?l.pfValue[0]:void 0;var d=u.value[0];var h=n;o.edgeType=h?"multibezier":"bezier";o.ctrlpts=[];for(var p=0;p<v;p++){var g=(.5-t.eles.length/2+a)*s*(i?-1:1);var y=void 0;var m=ir(g);if(h){c=l?l.pfValue[p]:s;d=u.value[p]}y=n?c:c!==void 0?m*c:void 0;var b=y!==void 0?y:g;var x=1-d;var w=d;var E=this.findMidptPtsEtc(e,t),T=E.midptPts,S=E.vectorNormInverse;var k={x:T.x1*x+T.x2*w,y:T.y1*x+T.y2*w};o.ctrlpts.push(k.x+S.x*b,k.y+S.y*b)}};Pv.findTaxiPoints=function(e,t){var a=e._private.rscratch;a.edgeType="segments";var n="vertical";var i="horizontal";var o="leftward";var s="rightward";var l="downward";var u="upward";var v="auto";var c=t.posPts,d=t.srcW,h=t.srcH,p=t.tgtW,g=t.tgtH;var y=e.pstyle("edge-distances").value;var m=y!=="node-position";var b=e.pstyle("taxi-direction").value;var x=b;var w=e.pstyle("taxi-turn");var E=w.units==="%";var T=w.pfValue;var S=T<0;var k=e.pstyle("taxi-turn-min-distance").pfValue;var P=m?(d+p)/2:0;var _=m?(h+g)/2:0;var D=c.x2-c.x1;var I=c.y2-c.y1;var M=function subDWH(e,t){return e>0?Math.max(e-t,0):Math.min(e+t,0)};var R=M(D,P);var L=M(I,_);var N=false;if(x===v)b=Math.abs(R)>Math.abs(L)?i:n;else if(x===u||x===l){b=n;N=true}else if(x===o||x===s){b=i;N=true}var O=b===n;var z=O?L:R;var V=O?I:D;var q=ir(V);var j=false;if(!(N&&(E||S))&&(x===l&&V<0||x===u&&V>0||x===o&&V>0||x===s&&V<0)){q*=-1;z=q*Math.abs(z);j=true}var H;if(E){var W=T<0?1+T:T;H=W*z}else{var X=T<0?z:0;H=X+T*q}var Y=function getIsTooClose(e){return Math.abs(e)<k||Math.abs(e)>=Math.abs(z)};var G=Y(H);var K=Y(Math.abs(z)-Math.abs(H));var U=G||K;if(U&&!j)if(O){var Z=Math.abs(V)<=h/2;var Q=Math.abs(D)<=p/2;if(Z){var J=(c.x1+c.x2)/2;var ee=c.y1,te=c.y2;a.segpts=[J,ee,J,te]}else if(Q){var re=(c.y1+c.y2)/2;var ae=c.x1,ne=c.x2;a.segpts=[ae,re,ne,re]}else a.segpts=[c.x1,c.y2]}else{var ie=Math.abs(V)<=d/2;var oe=Math.abs(I)<=g/2;if(ie){var se=(c.y1+c.y2)/2;var le=c.x1,ue=c.x2;a.segpts=[le,se,ue,se]}else if(oe){var ve=(c.x1+c.x2)/2;var ce=c.y1,de=c.y2;a.segpts=[ve,ce,ve,de]}else a.segpts=[c.x2,c.y1]}else if(O){var he=c.y1+H+(m?h/2*q:0);var fe=c.x1,pe=c.x2;a.segpts=[fe,he,pe,he]}else{var ge=c.x1+H+(m?d/2*q:0);var ye=c.y1,me=c.y2;a.segpts=[ge,ye,ge,me]}if(a.isRound){var be=e.pstyle("taxi-radius").value;var xe=e.pstyle("radius-type").value[0]==="arc-radius";a.radii=new Array(a.segpts.length/2).fill(be);a.isArcRadius=new Array(a.segpts.length/2).fill(xe)}};Pv.tryToCorrectInvalidPoints=function(e,t){var a=e._private.rscratch;if(a.edgeType==="bezier"){var n=t.srcPos,i=t.tgtPos,o=t.srcW,s=t.srcH,l=t.tgtW,u=t.tgtH,v=t.srcShape,c=t.tgtShape,d=t.srcCornerRadius,p=t.tgtCornerRadius,g=t.srcRs,y=t.tgtRs;var m=!h(a.startX)||!h(a.startY);var b=!h(a.arrowStartX)||!h(a.arrowStartY);var x=!h(a.endX)||!h(a.endY);var w=!h(a.arrowEndX)||!h(a.arrowEndY);var E=3;var T=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth;var S=E*T;var k=or({x:a.ctrlpts[0],y:a.ctrlpts[1]},{x:a.startX,y:a.startY});var P=k<S;var _=or({x:a.ctrlpts[0],y:a.ctrlpts[1]},{x:a.endX,y:a.endY});var D=_<S;var I=false;if(m||b||P){I=true;var M={x:a.ctrlpts[0]-n.x,y:a.ctrlpts[1]-n.y};var R=Math.sqrt(M.x*M.x+M.y*M.y);var L={x:M.x/R,y:M.y/R};var N=Math.max(o,s);var O={x:a.ctrlpts[0]+L.x*2*N,y:a.ctrlpts[1]+L.y*2*N};var z=v.intersectLine(n.x,n.y,o,s,O.x,O.y,0,d,g);if(P){a.ctrlpts[0]=a.ctrlpts[0]+L.x*(S-k);a.ctrlpts[1]=a.ctrlpts[1]+L.y*(S-k)}else{a.ctrlpts[0]=z[0]+L.x*S;a.ctrlpts[1]=z[1]+L.y*S}}if(x||w||D){I=true;var V={x:a.ctrlpts[0]-i.x,y:a.ctrlpts[1]-i.y};var q=Math.sqrt(V.x*V.x+V.y*V.y);var j={x:V.x/q,y:V.y/q};var H=Math.max(o,s);var W={x:a.ctrlpts[0]+j.x*2*H,y:a.ctrlpts[1]+j.y*2*H};var X=c.intersectLine(i.x,i.y,l,u,W.x,W.y,0,p,y);if(D){a.ctrlpts[0]=a.ctrlpts[0]+j.x*(S-_);a.ctrlpts[1]=a.ctrlpts[1]+j.y*(S-_)}else{a.ctrlpts[0]=X[0]+j.x*S;a.ctrlpts[1]=X[1]+j.y*S}}I&&this.findEndpoints(e)}};Pv.storeAllpts=function(e){var t=e._private.rscratch;if(t.edgeType==="multibezier"||t.edgeType==="bezier"||t.edgeType==="self"||t.edgeType==="compound"){t.allpts=[];t.allpts.push(t.startX,t.startY);for(var a=0;a+1<t.ctrlpts.length;a+=2){t.allpts.push(t.ctrlpts[a],t.ctrlpts[a+1]);a+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[a]+t.ctrlpts[a+2])/2,(t.ctrlpts[a+1]+t.ctrlpts[a+3])/2)}t.allpts.push(t.endX,t.endY);var n,i;if(t.ctrlpts.length/2%2===0){n=t.allpts.length/2-1;t.midX=t.allpts[n];t.midY=t.allpts[n+1]}else{n=t.allpts.length/2-3;i=.5;t.midX=ur(t.allpts[n],t.allpts[n+2],t.allpts[n+4],i);t.midY=ur(t.allpts[n+1],t.allpts[n+3],t.allpts[n+5],i)}}else if(t.edgeType==="straight"){t.allpts=[t.startX,t.startY,t.endX,t.endY];t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4;t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4}else if(t.edgeType==="segments"){t.allpts=[];t.allpts.push(t.startX,t.startY);t.allpts.push.apply(t.allpts,t.segpts);t.allpts.push(t.endX,t.endY);if(t.isRound){t.roundCorners=[];for(var o=2;o+3<t.allpts.length;o+=2){var s=t.radii[o/2-1];var l=t.isArcRadius[o/2-1];t.roundCorners.push(getRoundCorner({x:t.allpts[o-2],y:t.allpts[o-1]},{x:t.allpts[o],y:t.allpts[o+1],radius:s},{x:t.allpts[o+2],y:t.allpts[o+3]},s,l))}}if(t.segpts.length%4===0){var u=t.segpts.length/2;var v=u-2;t.midX=(t.segpts[v]+t.segpts[u])/2;t.midY=(t.segpts[v+1]+t.segpts[u+1])/2}else{var c=t.segpts.length/2-1;if(t.isRound){var d={x:t.segpts[c],y:t.segpts[c+1]};var h=t.roundCorners[c/2];if(h.radius===0){var p={x:t.segpts[c+2],y:t.segpts[c+3]};t.midX=d.x;t.midY=d.y;t.midVector=[d.y-p.y,p.x-d.x]}else{var g=[d.x-h.cx,d.y-h.cy];var y=h.radius/Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2));g=g.map((function(e){return e*y}));t.midX=h.cx+g[0];t.midY=h.cy+g[1];t.midVector=g}}else{t.midX=t.segpts[c];t.midY=t.segpts[c+1]}}}};Pv.checkForInvalidEdgeWarning=function(e){var t=e[0]._private.rscratch;if(t.nodesOverlap||h(t.startX)&&h(t.startY)&&h(t.endX)&&h(t.endY))t.loggedErr=false;else if(!t.loggedErr){t.loggedErr=true;st("Edge `"+e.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap.")}};Pv.findEdgeControlPoints=function(e){var t=this;if(e&&e.length!==0){var a=this;var n=a.cy;var i=n.hasCompoundNodes();var o=new wt;var s=function getKey(e,t){return[].concat(_toConsumableArray(e),[t?1:0]).join("-")};var l=[];var u=[];for(var v=0;v<e.length;v++){var c=e[v];var d=c._private;var p=c.pstyle("curve-style").value;if(!c.removed()&&c.takesUpSpace())if(p!=="haystack"){var g=p==="unbundled-bezier"||p.endsWith("segments")||p==="straight"||p==="straight-triangle"||p.endsWith("taxi");var y=p==="unbundled-bezier"||p==="bezier";var m=d.source;var b=d.target;var x=m.poolIndex();var w=b.poolIndex();var E=[x,w].sort();var T=s(E,g);var S=o.get(T);if(S==null){S={eles:[]};l.push({pairId:E,edgeIsUnbundled:g});o.set(T,S)}S.eles.push(c);g&&(S.hasUnbundled=true);y&&(S.hasBezier=true)}else u.push(c)}var k=function _loop(){var e=l[P],n=e.pairId,u=e.edgeIsUnbundled;var v=s(n,u);var c=o.get(v);var d;if(!c.hasUnbundled){var p=c.eles[0].parallelEdges().filter((function(e){return e.isBundledBezier()}));gt(c.eles);p.forEach((function(e){return c.eles.push(e)}));c.eles.sort((function(e,t){return e.poolIndex()-t.poolIndex()}))}var g=c.eles[0];var y=g.source();var m=g.target();if(y.poolIndex()>m.poolIndex()){var b=y;y=m;m=b}var x=c.srcPos=y.position();var w=c.tgtPos=m.position();var E=c.srcW=y.outerWidth();var T=c.srcH=y.outerHeight();var S=c.tgtW=m.outerWidth();var k=c.tgtH=m.outerHeight();var _=c.srcShape=a.nodeShapes[t.getNodeShape(y)];var D=c.tgtShape=a.nodeShapes[t.getNodeShape(m)];var I=c.srcCornerRadius=y.pstyle("corner-radius").value==="auto"?"auto":y.pstyle("corner-radius").pfValue;var M=c.tgtCornerRadius=m.pstyle("corner-radius").value==="auto"?"auto":m.pstyle("corner-radius").pfValue;var R=c.tgtRs=m._private.rscratch;var L=c.srcRs=y._private.rscratch;c.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var N=0;N<c.eles.length;N++){var O=c.eles[N];var z=O[0]._private.rscratch;var V=O.pstyle("curve-style").value;var q=V==="unbundled-bezier"||V.endsWith("segments")||V.endsWith("taxi");var j=!y.same(O.source());if(!c.calculatedIntersection&&y!==m&&(c.hasBezier||c.hasUnbundled)){c.calculatedIntersection=true;var H=_.intersectLine(x.x,x.y,E,T,w.x,w.y,0,I,L);var W=c.srcIntn=H;var X=D.intersectLine(w.x,w.y,S,k,x.x,x.y,0,M,R);var Y=c.tgtIntn=X;var G=c.intersectionPts={x1:H[0],x2:X[0],y1:H[1],y2:X[1]};var K=c.posPts={x1:x.x,x2:w.x,y1:x.y,y2:w.y};var U=Math.abs(X[1]-H[1]);var Z=Math.abs(X[0]-H[0]);var Q=Math.sqrt(Z*Z+U*U);h(Q)&&Q>=kv||(Q=Math.sqrt(Math.max(Z*Z,Sv)+Math.max(U*U,Sv)));var J=c.vector={x:Z,y:U};var ee=c.vectorNorm={x:J.x/Q,y:J.y/Q};var te={x:-ee.y,y:ee.x};c.nodesOverlap=!h(Q)||D.checkPoint(H[0],H[1],0,S,k,w.x,w.y,M,R)||_.checkPoint(X[0],X[1],0,E,T,x.x,x.y,I,L);c.vectorNormInverse=te;d={nodesOverlap:c.nodesOverlap,dirCounts:c.dirCounts,calculatedIntersection:true,hasBezier:c.hasBezier,hasUnbundled:c.hasUnbundled,eles:c.eles,srcPos:w,srcRs:R,tgtPos:x,tgtRs:L,srcW:S,srcH:k,tgtW:E,tgtH:T,srcIntn:Y,tgtIntn:W,srcShape:D,tgtShape:_,posPts:{x1:K.x2,y1:K.y2,x2:K.x1,y2:K.y1},intersectionPts:{x1:G.x2,y1:G.y2,x2:G.x1,y2:G.y1},vector:{x:-J.x,y:-J.y},vectorNorm:{x:-ee.x,y:-ee.y},vectorNormInverse:{x:-te.x,y:-te.y}}}var re=j?d:c;z.nodesOverlap=re.nodesOverlap;z.srcIntn=re.srcIntn;z.tgtIntn=re.tgtIntn;z.isRound=V.startsWith("round");i&&(y.isParent()||y.isChild()||m.isParent()||m.isChild())&&(y.parents().anySame(m)||m.parents().anySame(y)||y.same(m)&&y.isParent())?t.findCompoundLoopPoints(O,re,N,q):y===m?t.findLoopPoints(O,re,N,q):V.endsWith("segments")?t.findSegmentsPoints(O,re):V.endsWith("taxi")?t.findTaxiPoints(O,re):V==="straight"||!q&&c.eles.length%2===1&&N===Math.floor(c.eles.length/2)?t.findStraightEdgePoints(O):t.findBezierPoints(O,re,N,q,j);t.findEndpoints(O);t.tryToCorrectInvalidPoints(O,re);t.checkForInvalidEdgeWarning(O);t.storeAllpts(O);t.storeEdgeProjections(O);t.calculateArrowAngles(O);t.recalculateEdgeLabelProjections(O);t.calculateLabelAngles(O)}};for(var P=0;P<l.length;P++)k();this.findHaystackPoints(u)}};function getPts(e){var t=[];if(e!=null){for(var a=0;a<e.length;a+=2){var n=e[a];var i=e[a+1];t.push({x:n,y:i})}return t}}Pv.getSegmentPoints=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);var a=t.edgeType;if(a==="segments")return getPts(t.segpts)};Pv.getControlPoints=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);var a=t.edgeType;if(a==="bezier"||a==="multibezier"||a==="self"||a==="compound")return getPts(t.ctrlpts)};Pv.getEdgeMidpoint=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);return{x:t.midX,y:t.midY}};var _v={};_v.manualEndptToPx=function(e,t){var a=this;var n=e.position();var i=e.outerWidth();var o=e.outerHeight();var s=e._private.rscratch;if(t.value.length===2){var l=[t.pfValue[0],t.pfValue[1]];t.units[0]==="%"&&(l[0]=l[0]*i);t.units[1]==="%"&&(l[1]=l[1]*o);l[0]+=n.x;l[1]+=n.y;return l}var u=t.pfValue[0];u=-Math.PI/2+u;var v=2*Math.max(i,o);var c=[n.x+Math.cos(u)*v,n.y+Math.sin(u)*v];return a.nodeShapes[this.getNodeShape(e)].intersectLine(n.x,n.y,i,o,c[0],c[1],0,e.pstyle("corner-radius").value==="auto"?"auto":e.pstyle("corner-radius").pfValue,s)};_v.findEndpoints=function(e){var t=this;var a;var n=e.source()[0];var i=e.target()[0];var o=n.position();var s=i.position();var l=e.pstyle("target-arrow-shape").value;var u=e.pstyle("source-arrow-shape").value;var v=e.pstyle("target-distance-from-node").pfValue;var c=e.pstyle("source-distance-from-node").pfValue;var d=n._private.rscratch;var p=i._private.rscratch;var g=e.pstyle("curve-style").value;var y=e._private.rscratch;var m=y.edgeType;var b=g==="taxi";var x=m==="self"||m==="compound";var w=m==="bezier"||m==="multibezier"||x;var E=m!=="bezier";var T=m==="straight"||m==="segments";var S=m==="segments";var k=w||E||T;var P=x||b;var _=e.pstyle("source-endpoint");var D=P?"outside-to-node":_.value;var I=n.pstyle("corner-radius").value==="auto"?"auto":n.pstyle("corner-radius").pfValue;var M=e.pstyle("target-endpoint");var R=P?"outside-to-node":M.value;var L=i.pstyle("corner-radius").value==="auto"?"auto":i.pstyle("corner-radius").pfValue;y.srcManEndpt=_;y.tgtManEndpt=M;var N;var O;var z;var V;if(w){var q=[y.ctrlpts[0],y.ctrlpts[1]];var j=E?[y.ctrlpts[y.ctrlpts.length-2],y.ctrlpts[y.ctrlpts.length-1]]:q;N=j;O=q}else if(T){var H=S?y.segpts.slice(0,2):[s.x,s.y];var W=S?y.segpts.slice(y.segpts.length-2):[o.x,o.y];N=W;O=H}if(R==="inside-to-node")a=[s.x,s.y];else if(M.units)a=this.manualEndptToPx(i,M);else if(R==="outside-to-line")a=y.tgtIntn;else{R==="outside-to-node"||R==="outside-to-node-or-label"?z=N:R!=="outside-to-line"&&R!=="outside-to-line-or-label"||(z=[o.x,o.y]);a=t.nodeShapes[this.getNodeShape(i)].intersectLine(s.x,s.y,i.outerWidth(),i.outerHeight(),z[0],z[1],0,L,p);if(R==="outside-to-node-or-label"||R==="outside-to-line-or-label"){var X=i._private.rscratch;var Y=X.labelWidth;var G=X.labelHeight;var K=X.labelX;var U=X.labelY;var Z=Y/2;var Q=G/2;var J=i.pstyle("text-valign").value;J==="top"?U-=Q:J==="bottom"&&(U+=Q);var ee=i.pstyle("text-halign").value;ee==="left"?K-=Z:ee==="right"&&(K+=Z);var te=Hr(z[0],z[1],[K-Z,U-Q,K+Z,U-Q,K+Z,U+Q,K-Z,U+Q],s.x,s.y);if(te.length>0){var re=o;var ae=sr(re,$t(a));var ne=sr(re,$t(te));var ie=ae;if(ne<ae){a=te;ie=ne}if(te.length>2){var oe=sr(re,{x:te[2],y:te[3]});oe<ie&&(a=[te[2],te[3]])}}}}var se=Xr(a,N,t.arrowShapes[l].spacing(e)+v);var le=Xr(a,N,t.arrowShapes[l].gap(e)+v);y.endX=le[0];y.endY=le[1];y.arrowEndX=se[0];y.arrowEndY=se[1];if(D==="inside-to-node")a=[o.x,o.y];else if(_.units)a=this.manualEndptToPx(n,_);else if(D==="outside-to-line")a=y.srcIntn;else{D==="outside-to-node"||D==="outside-to-node-or-label"?V=O:D!=="outside-to-line"&&D!=="outside-to-line-or-label"||(V=[s.x,s.y]);a=t.nodeShapes[this.getNodeShape(n)].intersectLine(o.x,o.y,n.outerWidth(),n.outerHeight(),V[0],V[1],0,I,d);if(D==="outside-to-node-or-label"||D==="outside-to-line-or-label"){var ue=n._private.rscratch;var ve=ue.labelWidth;var ce=ue.labelHeight;var de=ue.labelX;var he=ue.labelY;var fe=ve/2;var pe=ce/2;var ge=n.pstyle("text-valign").value;ge==="top"?he-=pe:ge==="bottom"&&(he+=pe);var ye=n.pstyle("text-halign").value;ye==="left"?de-=fe:ye==="right"&&(de+=fe);var me=Hr(V[0],V[1],[de-fe,he-pe,de+fe,he-pe,de+fe,he+pe,de-fe,he+pe],o.x,o.y);if(me.length>0){var be=s;var xe=sr(be,$t(a));var we=sr(be,$t(me));var Ee=xe;if(we<xe){a=[me[0],me[1]];Ee=we}if(me.length>2){var Ce=sr(be,{x:me[2],y:me[3]});Ce<Ee&&(a=[me[2],me[3]])}}}}var Te=Xr(a,O,t.arrowShapes[u].spacing(e)+c);var Se=Xr(a,O,t.arrowShapes[u].gap(e)+c);y.startX=Se[0];y.startY=Se[1];y.arrowStartX=Te[0];y.arrowStartY=Te[1];k&&(h(y.startX)&&h(y.startY)&&h(y.endX)&&h(y.endY)?y.badLine=false:y.badLine=true)};_v.getSourceEndpoint=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);switch(t.edgeType){case"haystack":return{x:t.haystackPts[0],y:t.haystackPts[1]};default:return{x:t.arrowStartX,y:t.arrowStartY}}};_v.getTargetEndpoint=function(e){var t=e[0]._private.rscratch;this.recalculateRenderedStyle(e);switch(t.edgeType){case"haystack":return{x:t.haystackPts[2],y:t.haystackPts[3]};default:return{x:t.arrowEndX,y:t.arrowEndY}}};var Dv={};function pushBezierPts(e,t,a){var n=function qbezierAt$1(e,t,a,n){return ur(e,t,a,n)};var i=t._private;var o=i.rstyle.bezierPts;for(var s=0;s<e.bezierProjPcts.length;s++){var l=e.bezierProjPcts[s];o.push({x:n(a[0],a[2],a[4],l),y:n(a[1],a[3],a[5],l)})}}Dv.storeEdgeProjections=function(e){var t=e._private;var a=t.rscratch;var n=a.edgeType;t.rstyle.bezierPts=null;t.rstyle.linePts=null;t.rstyle.haystackPts=null;if(n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){t.rstyle.bezierPts=[];for(var i=0;i+5<a.allpts.length;i+=4)pushBezierPts(this,e,a.allpts.slice(i,i+6))}else if(n==="segments"){var o=t.rstyle.linePts=[];for(i=0;i+1<a.allpts.length;i+=2)o.push({x:a.allpts[i],y:a.allpts[i+1]})}else if(n==="haystack"){var s=a.haystackPts;t.rstyle.haystackPts=[{x:s[0],y:s[1]},{x:s[2],y:s[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth};Dv.recalculateEdgeProjections=function(e){this.findEdgeControlPoints(e)};var Av={};Av.recalculateNodeLabelProjection=function(e){var t=e.pstyle("label").strValue;if(!T(t)){var a,n;var i=e._private;var o=e.width();var s=e.height();var l=e.padding();var u=e.position();var v=e.pstyle("text-halign").strValue;var c=e.pstyle("text-valign").strValue;var d=i.rscratch;var h=i.rstyle;switch(v){case"left":a=u.x-o/2-l;break;case"right":a=u.x+o/2+l;break;default:a=u.x}switch(c){case"top":n=u.y-s/2-l;break;case"bottom":n=u.y+s/2+l;break;default:n=u.y}d.labelX=a;d.labelY=n;h.labelX=a;h.labelY=n;this.calculateLabelAngles(e);this.applyLabelDimensions(e)}};var Bv=function lineAngleFromDelta(e,t){var a=Math.atan(t/e);e===0&&a<0&&(a*=-1);return a};var Iv=function lineAngle(e,t){var a=t.x-e.x;var n=t.y-e.y;return Bv(a,n)};var Mv=function bezierAngle(e,t,a,n){var i=dr(0,n-.001,1);var o=dr(0,n+.001,1);var s=vr(e,t,a,i);var l=vr(e,t,a,o);return Iv(s,l)};Av.recalculateEdgeLabelProjections=function(e){var t;var a=e._private;var n=a.rscratch;var i=this;var o={mid:e.pstyle("label").strValue,source:e.pstyle("source-label").strValue,target:e.pstyle("target-label").strValue};if(o.mid||o.source||o.target){t={x:n.midX,y:n.midY};var s=function setRs(e,t,n){bt(a.rscratch,e,t,n);bt(a.rstyle,e,t,n)};s("labelX",null,t.x);s("labelY",null,t.y);var l=Bv(n.midDispX,n.midDispY);s("labelAutoAngle",null,l);var u=function createControlPointInfo(){if(u.cache)return u.cache;var e=[];for(var t=0;t+5<n.allpts.length;t+=4){var o={x:n.allpts[t],y:n.allpts[t+1]};var s={x:n.allpts[t+2],y:n.allpts[t+3]};var l={x:n.allpts[t+4],y:n.allpts[t+5]};e.push({p0:o,p1:s,p2:l,startDist:0,length:0,segments:[]})}var v=a.rstyle.bezierPts;var c=i.bezierProjPcts.length;function addSegment(e,t,a,n,i){var o=or(t,a);var s=e.segments[e.segments.length-1];var l={p0:t,p1:a,t0:n,t1:i,startDist:s?s.startDist+s.length:0,length:o};e.segments.push(l);e.length+=o}for(var d=0;d<e.length;d++){var h=e[d];var p=e[d-1];p&&(h.startDist=p.startDist+p.length);addSegment(h,h.p0,v[d*c],0,i.bezierProjPcts[0]);for(var g=0;g<c-1;g++)addSegment(h,v[d*c+g],v[d*c+g+1],i.bezierProjPcts[g],i.bezierProjPcts[g+1]);addSegment(h,v[d*c+c-1],h.p2,i.bezierProjPcts[c-1],1)}return u.cache=e};var v=function calculateEndProjection(a){var i;var l=a==="source";if(o[a]){var v=e.pstyle(a+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":var c=u();var d;var h=0;var p=0;for(var g=0;g<c.length;g++){var y=c[l?g:c.length-1-g];for(var m=0;m<y.segments.length;m++){var b=y.segments[l?m:y.segments.length-1-m];var x=g===c.length-1&&m===y.segments.length-1;h=p;p+=b.length;if(p>=v||x){d={cp:y,segment:b};break}}if(d)break}var w=d.cp;var E=d.segment;var T=(v-h)/E.length;var S=E.t1-E.t0;var k=l?E.t0+S*T:E.t1-S*T;k=dr(0,k,1);t=vr(w.p0,w.p1,w.p2,k);i=Mv(w.p0,w.p1,w.p2,k);break;case"straight":case"segments":case"haystack":var P,_,D=0;var I,M;var R=n.allpts.length;for(var L=0;L+3<R;L+=2){if(l){I={x:n.allpts[L],y:n.allpts[L+1]};M={x:n.allpts[L+2],y:n.allpts[L+3]}}else{I={x:n.allpts[R-2-L],y:n.allpts[R-1-L]};M={x:n.allpts[R-4-L],y:n.allpts[R-3-L]}}P=or(I,M);_=D;D+=P;if(D>=v)break}var N=v-_;var O=N/P;O=dr(0,O,1);t=cr(I,M,O);i=Iv(I,M);break}s("labelX",a,t.x);s("labelY",a,t.y);s("labelAutoAngle",a,i)}};v("source");v("target");this.applyLabelDimensions(e)}};Av.applyLabelDimensions=function(e){this.applyPrefixedLabelDimensions(e);if(e.isEdge()){this.applyPrefixedLabelDimensions(e,"source");this.applyPrefixedLabelDimensions(e,"target")}};Av.applyPrefixedLabelDimensions=function(e,t){var a=e._private;var n=this.getLabelText(e,t);var i=Ke(n,e._private.labelDimsKey);if(mt(a.rscratch,"prefixedLabelDimsKey",t)!==i){bt(a.rscratch,"prefixedLabelDimsKey",t,i);var o=this.calculateLabelDimensions(e,n);var s=e.pstyle("line-height").pfValue;var l=e.pstyle("text-wrap").strValue;var u=mt(a.rscratch,"labelWrapCachedLines",t)||[];var v=l!=="wrap"?1:Math.max(u.length,1);var c=o.height/v;var d=c*s;var h=o.width;var p=o.height+(v-1)*(s-1)*c;bt(a.rstyle,"labelWidth",t,h);bt(a.rscratch,"labelWidth",t,h);bt(a.rstyle,"labelHeight",t,p);bt(a.rscratch,"labelHeight",t,p);bt(a.rscratch,"labelLineHeight",t,d)}};Av.getLabelText=function(e,t){var a=e._private;var n=t?t+"-":"";var i=e.pstyle(n+"label").strValue;var o=e.pstyle("text-transform").value;var s=function rscratch(e,n){if(n){bt(a.rscratch,e,t,n);return n}return mt(a.rscratch,e,t)};if(!i)return"";o=="none"||(o=="uppercase"?i=i.toUpperCase():o=="lowercase"&&(i=i.toLowerCase()));var l=e.pstyle("text-wrap").value;if(l==="wrap"){var u=s("labelKey");if(u!=null&&s("labelWrapKey")===u)return s("labelWrapCachedText");var v="​";var c=i.split("\n");var d=e.pstyle("text-max-width").pfValue;var h=e.pstyle("text-overflow-wrap").value;var p=h==="anywhere";var g=[];var y=/[\s\u200b]+|$/g;for(var m=0;m<c.length;m++){var b=c[m];var x=this.calculateLabelDimensions(e,b);var w=x.width;if(p){var E=b.split("").join(v);b=E}if(w>d){var T=b.matchAll(y);var S="";var k=0;var P,_=_createForOfIteratorHelper(T);try{for(_.s();!(P=_.n()).done;){var D=P.value;var I=D[0];var M=b.substring(k,D.index);k=D.index+I.length;var R=S.length===0?M:S+M+I;var L=this.calculateLabelDimensions(e,R);var N=L.width;if(N<=d)S+=M+I;else{S&&g.push(S);S=M+I}}}catch(e){_.e(e)}finally{_.f()}S.match(/^[\s\u200b]+$/)||g.push(S)}else g.push(b)}s("labelWrapCachedLines",g);i=s("labelWrapCachedText",g.join("\n"));s("labelWrapKey",u)}else if(l==="ellipsis"){var O=e.pstyle("text-max-width").pfValue;var z="";var V="…";var q=false;if(this.calculateLabelDimensions(e,i).width<O)return i;for(var j=0;j<i.length;j++){var H=this.calculateLabelDimensions(e,z+i[j]+V).width;if(H>O)break;z+=i[j];j===i.length-1&&(q=true)}q||(z+=V);return z}return i};Av.getLabelJustification=function(e){var t=e.pstyle("text-justification").strValue;var a=e.pstyle("text-halign").strValue;if(t!=="auto")return t;if(!e.isNode())return"center";switch(a){case"left":return"right";case"right":return"left";default:return"center"}};Av.calculateLabelDimensions=function(e,t){var a=this;var n=a.cy.window();var i=n.document;var o=0;var s=e.pstyle("font-style").strValue;var l=e.pstyle("font-size").pfValue;var u=e.pstyle("font-family").strValue;var v=e.pstyle("font-weight").strValue;var c=this.labelCalcCanvas;var d=this.labelCalcCanvasContext;if(!c){c=this.labelCalcCanvas=i.createElement("canvas");d=this.labelCalcCanvasContext=c.getContext("2d");var h=c.style;h.position="absolute";h.left="-9999px";h.top="-9999px";h.zIndex="-1";h.visibility="hidden";h.pointerEvents="none"}d.font="".concat(s," ").concat(v," ").concat(l,"px ").concat(u);var p=0;var g=0;var y=t.split("\n");for(var m=0;m<y.length;m++){var b=y[m];var x=d.measureText(b);var w=Math.ceil(x.width);var E=l;p=Math.max(w,p);g+=E}p+=o;g+=o;return{width:p,height:g}};Av.calculateLabelAngle=function(e,t){var a=e._private;var n=a.rscratch;var i=e.isEdge();var o=t?t+"-":"";var s=e.pstyle(o+"text-rotation");var l=s.strValue;return l==="none"?0:i&&l==="autorotate"?n.labelAutoAngle:l==="autorotate"?0:s.pfValue};Av.calculateLabelAngles=function(e){var t=this;var a=e.isEdge();var n=e._private;var i=n.rscratch;i.labelAngle=t.calculateLabelAngle(e);if(a){i.sourceLabelAngle=t.calculateLabelAngle(e,"source");i.targetLabelAngle=t.calculateLabelAngle(e,"target")}};var Rv={};var Lv=28;var Nv=false;Rv.getNodeShape=function(e){var t=this;var a=e.pstyle("shape").value;if(a==="cutrectangle"&&(e.width()<Lv||e.height()<Lv)){if(!Nv){st("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead");Nv=true}return"rectangle"}if(e.isParent())return a==="rectangle"||a==="roundrectangle"||a==="round-rectangle"||a==="cutrectangle"||a==="cut-rectangle"||a==="barrel"?a:"rectangle";if(a==="polygon"){var n=e.pstyle("shape-polygon-points").value;return t.nodeShapes.makePolygon(n).name}return a};var Ov={};Ov.registerCalculationListeners=function(){var e=this.cy;var t=e.collection();var a=this;var n=function enqueue(e){var a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];t.merge(e);if(a)for(var n=0;n<e.length;n++){var i=e[n];var o=i._private;var s=o.rstyle;s.clean=false;s.cleanConnected=false}};a.binder(e).on("bounds.* dirty.*",(function onDirtyBounds(e){var t=e.target;n(t)})).on("style.* background.*",(function onDirtyStyle(e){var t=e.target;n(t,false)}));var i=function updateEleCalcs(i){if(i){var o=a.onUpdateEleCalcsFns;t.cleanStyle();for(var s=0;s<t.length;s++){var l=t[s];var u=l._private.rstyle;if(l.isNode()&&!u.cleanConnected){n(l.connectedEdges());u.cleanConnected=true}}if(o)for(var v=0;v<o.length;v++){var c=o[v];c(i,t)}a.recalculateRenderedStyle(t);t=e.collection()}};a.flushRenderedStyleQueue=function(){i(true)};a.beforeRender(i,a.beforeRenderPriorities.eleCalcs)};Ov.onUpdateEleCalcs=function(e){var t=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];t.push(e)};Ov.recalculateRenderedStyle=function(e,t){var a=function isCleanConnected(e){return e._private.rstyle.cleanConnected};if(e.length!==0){var n=[];var i=[];if(!this.destroyed){t===void 0&&(t=true);for(var o=0;o<e.length;o++){var s=e[o];var l=s._private;var u=l.rstyle;!s.isEdge()||a(s.source())&&a(s.target())||(u.clean=false);s.isEdge()&&s.isBundledBezier()&&s.parallelEdges().some((function(e){return!e._private.rstyle.clean&&e.isBundledBezier()}))&&(u.clean=false);if(!(t&&u.clean||s.removed())&&s.pstyle("display").value!=="none"){l.group==="nodes"?i.push(s):n.push(s);u.clean=true}}for(var v=0;v<i.length;v++){var c=i[v];var d=c._private;var h=d.rstyle;var p=c.position();this.recalculateNodeLabelProjection(c);h.nodeX=p.x;h.nodeY=p.y;h.nodeW=c.pstyle("width").pfValue;h.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var g=0;g<n.length;g++){var y=n[g];var m=y._private;var b=m.rstyle;var x=m.rscratch;b.srcX=x.arrowStartX;b.srcY=x.arrowStartY;b.tgtX=x.arrowEndX;b.tgtY=x.arrowEndY;b.midX=x.midX;b.midY=x.midY;b.labelAngle=x.labelAngle;b.sourceLabelAngle=x.sourceLabelAngle;b.targetLabelAngle=x.targetLabelAngle}}}};var Fv={};Fv.updateCachedGrabbedEles=function(){var e=this.cachedZSortedEles;if(e){e.drag=[];e.nondrag=[];var t=[];for(var a=0;a<e.length;a++){var n=e[a];var i=n._private.rscratch;n.grabbed()&&!n.isParent()?t.push(n):i.inDragLayer?e.drag.push(n):e.nondrag.push(n)}for(a=0;a<t.length;a++){n=t[a];e.drag.push(n)}}};Fv.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};Fv.getCachedZSortedEles=function(e){if(e||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(Cl);t.interactive=t.filter((function(e){return e.interactive()}));this.cachedZSortedEles=t;this.updateCachedGrabbedEles()}else t=this.cachedZSortedEles;return t};var zv={};[tv,rv,Pv,_v,Dv,Av,Rv,Ov,Fv].forEach((function(e){Y(zv,e)}));var Vv={};Vv.getCachedImage=function(e,t,a){var n=this;var i=n.imageCache=n.imageCache||{};var o=i[e];if(o){o.image.complete||o.image.addEventListener("load",a);return o.image}o=i[e]=i[e]||{};var s=o.image=new Image;s.addEventListener("load",a);s.addEventListener("error",(function(){s.error=true}));var l="data:";var u=e.substring(0,l.length).toLowerCase()===l;if(!u){t=t==="null"?null:t;s.crossOrigin=t}s.src=e;return s};var qv={};qv.registerBinding=function(e,t,a,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(e)){var o=[];for(var s=0;s<e.length;s++){var l=e[s];if(l!==void 0){var u=this.binder(l);o.push(u.on.apply(u,i))}}return o}u=this.binder(e);return u.on.apply(u,i)};qv.binder=function(e){var t=this;var a=t.cy.window();var n=e===a||e===a.document||e===a.document.body||S(e);if(t.supportsPassiveEvents==null){var i=false;try{var o=Object.defineProperty({},"passive",{get:function get(){i=true;return true}});a.addEventListener("test",null,o)}catch(e){}t.supportsPassiveEvents=i}var s=function on(a,i,o){var s=Array.prototype.slice.call(arguments);n&&t.supportsPassiveEvents&&(s[2]={capture:o!=null&&o,passive:false,once:false});t.bindings.push({target:e,args:s});(e.addEventListener||e.on).apply(e,s);return this};return{on:s,addEventListener:s,addListener:s,bind:s}};qv.nodeIsDraggable=function(e){return e&&e.isNode()&&!e.locked()&&e.grabbable()};qv.nodeIsGrabbable=function(e){return this.nodeIsDraggable(e)&&e.interactive()};qv.load=function(){var e=this;var t=e.cy.window();var a=function isSelected(e){return e.selected()};var n=function getShadowRoot(e){var t=e.getRootNode();if(t&&t.nodeType===11&&t.host!==void 0)return t};var i=function triggerEvents(t,a,n,i){t==null&&(t=e.cy);for(var o=0;o<a.length;o++){var s=a[o];t.emit({originalEvent:n,type:s,position:i})}};var o=function isMultSelKeyDown(e){return e.shiftKey||e.metaKey||e.ctrlKey};var s=function allowPanningPassthrough(t,a){var n=true;if(e.cy.hasCompoundNodes()&&t&&t.pannable())for(var i=0;a&&i<a.length;i++){t=a[i];if(t.isNode()&&t.isParent()&&!t.pannable()){n=false;break}}else n=true;return n};var l=function setGrabbed(e){e[0]._private.grabbed=true};var u=function setFreed(e){e[0]._private.grabbed=false};var v=function setInDragLayer(e){e[0]._private.rscratch.inDragLayer=true};var c=function setOutDragLayer(e){e[0]._private.rscratch.inDragLayer=false};var d=function setGrabTarget(e){e[0]._private.rscratch.isGrabTarget=true};var p=function removeGrabTarget(e){e[0]._private.rscratch.isGrabTarget=false};var g=function addToDragList(e,t){var a=t.addToList;var n=a.has(e);if(!n&&e.grabbable()&&!e.locked()){a.merge(e);l(e)}};var y=function addDescendantsToDrag(e,t){if(e.cy().hasCompoundNodes()&&(t.inDragLayer!=null||t.addToList!=null)){var a=e.descendants();if(t.inDragLayer){a.forEach(v);a.connectedEdges().forEach(v)}t.addToList&&g(a,t)}};var m=function addNodesToDrag(t,a){a=a||{};var n=t.cy().hasCompoundNodes();if(a.inDragLayer){t.forEach(v);t.neighborhood().stdFilter((function(e){return!n||e.isEdge()})).forEach(v)}a.addToList&&t.forEach((function(e){g(e,a)}));y(t,a);w(t,{inDragLayer:a.inDragLayer});e.updateCachedGrabbedEles()};var b=m;var x=function freeDraggedElements(t){if(t){e.getCachedZSortedEles().forEach((function(e){u(e);c(e);p(e)}));e.updateCachedGrabbedEles()}};var w=function updateAncestorsInDragLayer(e,t){if((t.inDragLayer!=null||t.addToList!=null)&&e.cy().hasCompoundNodes()){var a=e.ancestors().orphans();if(!a.same(e)){var n=a.descendants().spawnSelf().merge(a).unmerge(e).unmerge(e.descendants());var i=n.connectedEdges();if(t.inDragLayer){i.forEach(v);n.forEach(v)}t.addToList&&n.forEach((function(e){g(e,t)}))}}};var E=function blurActiveDomElement(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()};var T=typeof MutationObserver!=="undefined";var S=typeof ResizeObserver!=="undefined";if(T){e.removeObserver=new MutationObserver((function(t){for(var a=0;a<t.length;a++){var n=t[a];var i=n.removedNodes;if(i)for(var o=0;o<i.length;o++){var s=i[o];if(s===e.container){e.destroy();break}}}}));e.container.parentNode&&e.removeObserver.observe(e.container.parentNode,{childList:true})}else e.registerBinding(e.container,"DOMNodeRemoved",(function(t){e.destroy()}));var k=Ie((function(){e.cy.resize()}),100);if(T){e.styleObserver=new MutationObserver(k);e.styleObserver.observe(e.container,{attributes:true})}e.registerBinding(t,"resize",k);if(S){e.resizeObserver=new ResizeObserver(k);e.resizeObserver.observe(e.container)}var P=function forEachUp(e,t){while(e!=null){t(e);e=e.parentNode}};var _=function invalidateCoords(){e.invalidateContainerClientCoordsCache()};P(e.container,(function(t){e.registerBinding(t,"transitionend",_);e.registerBinding(t,"animationend",_);e.registerBinding(t,"scroll",_)}));e.registerBinding(e.container,"contextmenu",(function(e){e.preventDefault()}));var D=function inBoxSelection(){return e.selection[4]!==0};var I=function eventInContainer(t){var a=e.findContainerClientCoords();var n=a[0];var i=a[1];var o=a[2];var s=a[3];var l=t.touches?t.touches:[t];var u=false;for(var v=0;v<l.length;v++){var c=l[v];if(n<=c.clientX&&c.clientX<=n+o&&i<=c.clientY&&c.clientY<=i+s){u=true;break}}if(!u)return false;var d=e.container;var h=t.target;var p=h.parentNode;var g=false;while(p){if(p===d){g=true;break}p=p.parentNode}return!!g};e.registerBinding(e.container,"mousedown",(function mousedownHandler(t){if(I(t)&&(e.hoverData.which!==1||t.which===1)){t.preventDefault();E();e.hoverData.capture=true;e.hoverData.which=t.which;var a=e.cy;var n=[t.clientX,t.clientY];var o=e.projectIntoViewport(n[0],n[1]);var s=e.selection;var l=e.findNearestElements(o[0],o[1],true,false);var u=l[0];var v=e.dragData.possibleDragElements;e.hoverData.mdownPos=o;e.hoverData.mdownGPos=n;var c=function checkForTaphold(){e.hoverData.tapholdCancelled=false;clearTimeout(e.hoverData.tapholdTimeout);e.hoverData.tapholdTimeout=setTimeout((function(){if(!e.hoverData.tapholdCancelled){var n=e.hoverData.down;n?n.emit({originalEvent:t,type:"taphold",position:{x:o[0],y:o[1]}}):a.emit({originalEvent:t,type:"taphold",position:{x:o[0],y:o[1]}})}}),e.tapholdDuration)};if(t.which==3){e.hoverData.cxtStarted=true;var h={originalEvent:t,type:"cxttapstart",position:{x:o[0],y:o[1]}};if(u){u.activate();u.emit(h);e.hoverData.down=u}else a.emit(h);e.hoverData.downTime=(new Date).getTime();e.hoverData.cxtDragged=false}else if(t.which==1){u&&u.activate();if(u!=null&&e.nodeIsGrabbable(u)){var p=function makeEvent(e){return{originalEvent:t,type:e,position:{x:o[0],y:o[1]}}};var g=function triggerGrab(e){e.emit(p("grab"))};d(u);if(u.selected()){v=e.dragData.possibleDragElements=a.collection();var y=a.$((function(t){return t.isNode()&&t.selected()&&e.nodeIsGrabbable(t)}));m(y,{addToList:v});u.emit(p("grabon"));y.forEach(g)}else{v=e.dragData.possibleDragElements=a.collection();b(u,{addToList:v});u.emit(p("grabon")).emit(p("grab"))}e.redrawHint("eles",true);e.redrawHint("drag",true)}e.hoverData.down=u;e.hoverData.downs=l;e.hoverData.downTime=(new Date).getTime();i(u,["mousedown","tapstart","vmousedown"],t,{x:o[0],y:o[1]});if(u==null){s[4]=1;e.data.bgActivePosistion={x:o[0],y:o[1]};e.redrawHint("select",true);e.redraw()}else u.pannable()&&(s[4]=1);c()}s[0]=s[2]=o[0];s[1]=s[3]=o[1]}}),false);var M=n(e.container);e.registerBinding([t,M],"mousemove",(function mousemoveHandler(t){var a=e.hoverData.capture;if(a||I(t)){var n=false;var l=e.cy;var u=l.zoom();var v=[t.clientX,t.clientY];var c=e.projectIntoViewport(v[0],v[1]);var d=e.hoverData.mdownPos;var p=e.hoverData.mdownGPos;var g=e.selection;var y=null;e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.selecting||(y=e.findNearestElement(c[0],c[1],true,false));var b=e.hoverData.last;var w=e.hoverData.down;var E=[c[0]-g[2],c[1]-g[3]];var T=e.dragData.possibleDragElements;var S;if(p){var k=v[0]-p[0];var P=k*k;var _=v[1]-p[1];var D=_*_;var M=P+D;e.hoverData.isOverThresholdDrag=S=M>=e.desktopTapThreshold2}var R=o(t);S&&(e.hoverData.tapholdCancelled=true);var L=function updateDragDelta(){var t=e.hoverData.dragDelta=e.hoverData.dragDelta||[];if(t.length===0){t.push(E[0]);t.push(E[1])}else{t[0]+=E[0];t[1]+=E[1]}};n=true;i(y,["mousemove","vmousemove","tapdrag"],t,{x:c[0],y:c[1]});var N=function goIntoBoxMode(){e.data.bgActivePosistion=void 0;e.hoverData.selecting||l.emit({originalEvent:t,type:"boxstart",position:{x:c[0],y:c[1]}});g[4]=1;e.hoverData.selecting=true;e.redrawHint("select",true);e.redraw()};if(e.hoverData.which===3){if(S){var O={originalEvent:t,type:"cxtdrag",position:{x:c[0],y:c[1]}};w?w.emit(O):l.emit(O);e.hoverData.cxtDragged=true;if(!e.hoverData.cxtOver||y!==e.hoverData.cxtOver){e.hoverData.cxtOver&&e.hoverData.cxtOver.emit({originalEvent:t,type:"cxtdragout",position:{x:c[0],y:c[1]}});e.hoverData.cxtOver=y;y&&y.emit({originalEvent:t,type:"cxtdragover",position:{x:c[0],y:c[1]}})}}}else if(e.hoverData.dragging){n=true;if(l.panningEnabled()&&l.userPanningEnabled()){var z;if(e.hoverData.justStartedPan){var V=e.hoverData.mdownPos;z={x:(c[0]-V[0])*u,y:(c[1]-V[1])*u};e.hoverData.justStartedPan=false}else z={x:E[0]*u,y:E[1]*u};l.panBy(z);l.emit("dragpan");e.hoverData.dragged=true}c=e.projectIntoViewport(t.clientX,t.clientY)}else if(g[4]!=1||w!=null&&!w.pannable()){w&&w.pannable()&&w.active()&&w.unactivate();if((!w||!w.grabbed())&&y!=b){b&&i(b,["mouseout","tapdragout"],t,{x:c[0],y:c[1]});y&&i(y,["mouseover","tapdragover"],t,{x:c[0],y:c[1]});e.hoverData.last=y}if(w)if(S){if(l.boxSelectionEnabled()&&R){if(w&&w.grabbed()){x(T);w.emit("freeon");T.emit("free");if(e.dragData.didDrag){w.emit("dragfreeon");T.emit("dragfree")}}N()}else if(w&&w.grabbed()&&e.nodeIsDraggable(w)){var q=!e.dragData.didDrag;q&&e.redrawHint("eles",true);e.dragData.didDrag=true;e.hoverData.draggingEles||m(T,{inDragLayer:true});var j={x:0,y:0};if(h(E[0])&&h(E[1])){j.x+=E[0];j.y+=E[1];if(q){var H=e.hoverData.dragDelta;if(H&&h(H[0])&&h(H[1])){j.x+=H[0];j.y+=H[1]}}}e.hoverData.draggingEles=true;T.silentShift(j).emit("position drag");e.redrawHint("drag",true);e.redraw()}}else L();n=true}else if(S){if(e.hoverData.dragging||!l.boxSelectionEnabled()||!R&&l.panningEnabled()&&l.userPanningEnabled()){if(!e.hoverData.selecting&&l.panningEnabled()&&l.userPanningEnabled()){var W=s(w,e.hoverData.downs);if(W){e.hoverData.dragging=true;e.hoverData.justStartedPan=true;g[4]=0;e.data.bgActivePosistion=$t(d);e.redrawHint("select",true);e.redraw()}}}else N();w&&w.pannable()&&w.active()&&w.unactivate()}g[2]=c[0];g[3]=c[1];if(n){t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();return false}}}),false);var R,L,N;e.registerBinding(t,"mouseup",(function mouseupHandler(t){if(e.hoverData.which!==1||t.which===1||!e.hoverData.capture){var n=e.hoverData.capture;if(n){e.hoverData.capture=false;var s=e.cy;var l=e.projectIntoViewport(t.clientX,t.clientY);var u=e.selection;var v=e.findNearestElement(l[0],l[1],true,false);var c=e.dragData.possibleDragElements;var d=e.hoverData.down;var h=o(t);if(e.data.bgActivePosistion){e.redrawHint("select",true);e.redraw()}e.hoverData.tapholdCancelled=true;e.data.bgActivePosistion=void 0;d&&d.unactivate();if(e.hoverData.which===3){var p={originalEvent:t,type:"cxttapend",position:{x:l[0],y:l[1]}};d?d.emit(p):s.emit(p);if(!e.hoverData.cxtDragged){var g={originalEvent:t,type:"cxttap",position:{x:l[0],y:l[1]}};d?d.emit(g):s.emit(g)}e.hoverData.cxtDragged=false;e.hoverData.which=null}else if(e.hoverData.which===1){i(v,["mouseup","tapend","vmouseup"],t,{x:l[0],y:l[1]});if(!e.dragData.didDrag&&!e.hoverData.dragged&&!e.hoverData.selecting&&!e.hoverData.isOverThresholdDrag){i(d,["click","tap","vclick"],t,{x:l[0],y:l[1]});L=false;if(t.timeStamp-N<=s.multiClickDebounceTime()){R&&clearTimeout(R);L=true;N=null;i(d,["dblclick","dbltap","vdblclick"],t,{x:l[0],y:l[1]})}else{R=setTimeout((function(){L||i(d,["oneclick","onetap","voneclick"],t,{x:l[0],y:l[1]})}),s.multiClickDebounceTime());N=t.timeStamp}}if(d==null&&!e.dragData.didDrag&&!e.hoverData.selecting&&!e.hoverData.dragged&&!o(t)){s.$(a).unselect(["tapunselect"]);c.length>0&&e.redrawHint("eles",true);e.dragData.possibleDragElements=c=s.collection()}if(v==d&&!e.dragData.didDrag&&!e.hoverData.selecting&&v!=null&&v._private.selectable){if(e.hoverData.dragging);else if(s.selectionType()==="additive"||h)v.selected()?v.unselect(["tapunselect"]):v.select(["tapselect"]);else if(!h){s.$(a).unmerge(v).unselect(["tapunselect"]);v.select(["tapselect"])}e.redrawHint("eles",true)}if(e.hoverData.selecting){var y=s.collection(e.getAllInBox(u[0],u[1],u[2],u[3]));e.redrawHint("select",true);y.length>0&&e.redrawHint("eles",true);s.emit({type:"boxend",originalEvent:t,position:{x:l[0],y:l[1]}});var m=function eleWouldBeSelected(e){return e.selectable()&&!e.selected()};if(s.selectionType()==="additive")y.emit("box").stdFilter(m).select().emit("boxselect");else{h||s.$(a).unmerge(y).unselect();y.emit("box").stdFilter(m).select().emit("boxselect")}e.redraw()}if(e.hoverData.dragging){e.hoverData.dragging=false;e.redrawHint("select",true);e.redrawHint("eles",true);e.redraw()}if(!u[4]){e.redrawHint("drag",true);e.redrawHint("eles",true);var b=d&&d.grabbed();x(c);if(b){d.emit("freeon");c.emit("free");if(e.dragData.didDrag){d.emit("dragfreeon");c.emit("dragfree")}}}}u[4]=0;e.hoverData.down=null;e.hoverData.cxtStarted=false;e.hoverData.draggingEles=false;e.hoverData.selecting=false;e.hoverData.isOverThresholdDrag=false;e.dragData.didDrag=false;e.hoverData.dragged=false;e.hoverData.dragDelta=[];e.hoverData.mdownPos=null;e.hoverData.mdownGPos=null;e.hoverData.which=null}}}),false);var O=function wheelHandler(t){if(!e.scrollingPage){var a=e.cy;var n=a.zoom();var i=a.pan();var o=e.projectIntoViewport(t.clientX,t.clientY);var s=[o[0]*n+i.x,o[1]*n+i.y];if(e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.cxtStarted||D())t.preventDefault();else if(a.panningEnabled()&&a.userPanningEnabled()&&a.zoomingEnabled()&&a.userZoomingEnabled()){t.preventDefault();e.data.wheelZooming=true;clearTimeout(e.data.wheelTimeout);e.data.wheelTimeout=setTimeout((function(){e.data.wheelZooming=false;e.redrawHint("eles",true);e.redraw()}),150);var l;l=t.deltaY!=null?t.deltaY/-250:t.wheelDeltaY!=null?t.wheelDeltaY/1e3:t.wheelDelta/1e3;l*=e.wheelSensitivity;var u=t.deltaMode===1;u&&(l*=33);var v=a.zoom()*Math.pow(10,l);t.type==="gesturechange"&&(v=e.gestureStartZoom*t.scale);a.zoom({level:v,renderedPosition:{x:s[0],y:s[1]}});a.emit(t.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};e.registerBinding(e.container,"wheel",O,true);e.registerBinding(t,"scroll",(function scrollHandler(t){e.scrollingPage=true;clearTimeout(e.scrollingPageTimeout);e.scrollingPageTimeout=setTimeout((function(){e.scrollingPage=false}),250)}),true);e.registerBinding(e.container,"gesturestart",(function gestureStartHandler(t){e.gestureStartZoom=e.cy.zoom();e.hasTouchStarted||t.preventDefault()}),true);e.registerBinding(e.container,"gesturechange",(function(t){e.hasTouchStarted||O(t)}),true);e.registerBinding(e.container,"mouseout",(function mouseOutHandler(t){var a=e.projectIntoViewport(t.clientX,t.clientY);e.cy.emit({originalEvent:t,type:"mouseout",position:{x:a[0],y:a[1]}})}),false);e.registerBinding(e.container,"mouseover",(function mouseOverHandler(t){var a=e.projectIntoViewport(t.clientX,t.clientY);e.cy.emit({originalEvent:t,type:"mouseover",position:{x:a[0],y:a[1]}})}),false);var z,V,q,j;var H,W;var X,Y;var G,K;var U,Z;var Q;var J=function distance(e,t,a,n){return Math.sqrt((a-e)*(a-e)+(n-t)*(n-t))};var ee=function distanceSq(e,t,a,n){return(a-e)*(a-e)+(n-t)*(n-t)};var te;e.registerBinding(e.container,"touchstart",te=function touchstartHandler(t){e.hasTouchStarted=true;if(I(t)){E();e.touchData.capture=true;e.data.bgActivePosistion=void 0;var a=e.cy;var n=e.touchData.now;var o=e.touchData.earlier;if(t.touches[0]){var s=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);n[0]=s[0];n[1]=s[1]}if(t.touches[1]){s=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);n[2]=s[0];n[3]=s[1]}if(t.touches[2]){s=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);n[4]=s[0];n[5]=s[1]}if(t.touches[1]){e.touchData.singleTouchMoved=true;x(e.dragData.touchDragEles);var l=e.findContainerClientCoords();G=l[0];K=l[1];U=l[2];Z=l[3];z=t.touches[0].clientX-G;V=t.touches[0].clientY-K;q=t.touches[1].clientX-G;j=t.touches[1].clientY-K;Q=0<=z&&z<=U&&0<=q&&q<=U&&0<=V&&V<=Z&&0<=j&&j<=Z;var u=a.pan();var v=a.zoom();H=J(z,V,q,j);W=ee(z,V,q,j);X=[(z+q)/2,(V+j)/2];Y=[(X[0]-u.x)/v,(X[1]-u.y)/v];var c=200;var h=c*c;if(W<h&&!t.touches[2]){var p=e.findNearestElement(n[0],n[1],true,true);var g=e.findNearestElement(n[2],n[3],true,true);if(p&&p.isNode()){p.activate().emit({originalEvent:t,type:"cxttapstart",position:{x:n[0],y:n[1]}});e.touchData.start=p}else if(g&&g.isNode()){g.activate().emit({originalEvent:t,type:"cxttapstart",position:{x:n[0],y:n[1]}});e.touchData.start=g}else a.emit({originalEvent:t,type:"cxttapstart",position:{x:n[0],y:n[1]}});e.touchData.start&&(e.touchData.start._private.grabbed=false);e.touchData.cxt=true;e.touchData.cxtDragged=false;e.data.bgActivePosistion=void 0;e.redraw();return}}if(t.touches[2])a.boxSelectionEnabled()&&t.preventDefault();else if(t.touches[1]);else if(t.touches[0]){var y=e.findNearestElements(n[0],n[1],true,true);var w=y[0];if(w!=null){w.activate();e.touchData.start=w;e.touchData.starts=y;if(e.nodeIsGrabbable(w)){var T=e.dragData.touchDragEles=a.collection();var S=null;e.redrawHint("eles",true);e.redrawHint("drag",true);if(w.selected()){S=a.$((function(t){return t.selected()&&e.nodeIsGrabbable(t)}));m(S,{addToList:T})}else b(w,{addToList:T});d(w);var k=function makeEvent(e){return{originalEvent:t,type:e,position:{x:n[0],y:n[1]}}};w.emit(k("grabon"));S?S.forEach((function(e){e.emit(k("grab"))})):w.emit(k("grab"))}}i(w,["touchstart","tapstart","vmousedown"],t,{x:n[0],y:n[1]});if(w==null){e.data.bgActivePosistion={x:s[0],y:s[1]};e.redrawHint("select",true);e.redraw()}e.touchData.singleTouchMoved=false;e.touchData.singleTouchStartTime=+new Date;clearTimeout(e.touchData.tapholdTimeout);e.touchData.tapholdTimeout=setTimeout((function(){e.touchData.singleTouchMoved!==false||e.pinching||e.touchData.selecting||i(e.touchData.start,["taphold"],t,{x:n[0],y:n[1]})}),e.tapholdDuration)}if(t.touches.length>=1){var P=e.touchData.startPosition=[null,null,null,null,null,null];for(var _=0;_<n.length;_++)P[_]=o[_]=n[_];var D=t.touches[0];e.touchData.startGPosition=[D.clientX,D.clientY]}}},false);var re;e.registerBinding(t,"touchmove",re=function touchmoveHandler(t){var a=e.touchData.capture;if(a||I(t)){var n=e.selection;var o=e.cy;var l=e.touchData.now;var u=e.touchData.earlier;var v=o.zoom();if(t.touches[0]){var c=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);l[0]=c[0];l[1]=c[1]}if(t.touches[1]){c=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);l[2]=c[0];l[3]=c[1]}if(t.touches[2]){c=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);l[4]=c[0];l[5]=c[1]}var d=e.touchData.startGPosition;var p;if(a&&t.touches[0]&&d){var g=[];for(var y=0;y<l.length;y++)g[y]=l[y]-u[y];var b=t.touches[0].clientX-d[0];var w=b*b;var E=t.touches[0].clientY-d[1];var T=E*E;var S=w+T;p=S>=e.touchTapThreshold2}if(a&&e.touchData.cxt){t.preventDefault();var k=t.touches[0].clientX-G,P=t.touches[0].clientY-K;var _=t.touches[1].clientX-G,D=t.touches[1].clientY-K;var M=ee(k,P,_,D);var R=M/W;var L=150;var N=L*L;var O=1.5;var X=O*O;if(R>=X||M>=N){e.touchData.cxt=false;e.data.bgActivePosistion=void 0;e.redrawHint("select",true);var U={originalEvent:t,type:"cxttapend",position:{x:l[0],y:l[1]}};if(e.touchData.start){e.touchData.start.unactivate().emit(U);e.touchData.start=null}else o.emit(U)}}if(a&&e.touchData.cxt){U={originalEvent:t,type:"cxtdrag",position:{x:l[0],y:l[1]}};e.data.bgActivePosistion=void 0;e.redrawHint("select",true);e.touchData.start?e.touchData.start.emit(U):o.emit(U);e.touchData.start&&(e.touchData.start._private.grabbed=false);e.touchData.cxtDragged=true;var Z=e.findNearestElement(l[0],l[1],true,true);if(!e.touchData.cxtOver||Z!==e.touchData.cxtOver){e.touchData.cxtOver&&e.touchData.cxtOver.emit({originalEvent:t,type:"cxtdragout",position:{x:l[0],y:l[1]}});e.touchData.cxtOver=Z;Z&&Z.emit({originalEvent:t,type:"cxtdragover",position:{x:l[0],y:l[1]}})}}else if(a&&t.touches[2]&&o.boxSelectionEnabled()){t.preventDefault();e.data.bgActivePosistion=void 0;this.lastThreeTouch=+new Date;e.touchData.selecting||o.emit({originalEvent:t,type:"boxstart",position:{x:l[0],y:l[1]}});e.touchData.selecting=true;e.touchData.didSelect=true;n[4]=1;if(n&&n.length!==0&&n[0]!==void 0){n[2]=(l[0]+l[2]+l[4])/3;n[3]=(l[1]+l[3]+l[5])/3}else{n[0]=(l[0]+l[2]+l[4])/3;n[1]=(l[1]+l[3]+l[5])/3;n[2]=(l[0]+l[2]+l[4])/3+1;n[3]=(l[1]+l[3]+l[5])/3+1}e.redrawHint("select",true);e.redraw()}else if(a&&t.touches[1]&&!e.touchData.didSelect&&o.zoomingEnabled()&&o.panningEnabled()&&o.userZoomingEnabled()&&o.userPanningEnabled()){t.preventDefault();e.data.bgActivePosistion=void 0;e.redrawHint("select",true);var te=e.dragData.touchDragEles;if(te){e.redrawHint("drag",true);for(var re=0;re<te.length;re++){var ae=te[re]._private;ae.grabbed=false;ae.rscratch.inDragLayer=false}}var ne=e.touchData.start;k=t.touches[0].clientX-G,P=t.touches[0].clientY-K;_=t.touches[1].clientX-G,D=t.touches[1].clientY-K;var ie=J(k,P,_,D);var oe=ie/H;if(Q){var se=k-z;var le=P-V;var ue=_-q;var ve=D-j;var ce=(se+ue)/2;var de=(le+ve)/2;var he=o.zoom();var fe=he*oe;var pe=o.pan();var ge=Y[0]*he+pe.x;var ye=Y[1]*he+pe.y;var me={x:-fe/he*(ge-pe.x-ce)+ge,y:-fe/he*(ye-pe.y-de)+ye};if(ne&&ne.active()){te=e.dragData.touchDragEles;x(te);e.redrawHint("drag",true);e.redrawHint("eles",true);ne.unactivate().emit("freeon");te.emit("free");if(e.dragData.didDrag){ne.emit("dragfreeon");te.emit("dragfree")}}o.viewport({zoom:fe,pan:me,cancelOnFailedZoom:true});o.emit("pinchzoom");H=ie;z=k;V=P;q=_;j=D;e.pinching=true}if(t.touches[0]){c=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);l[0]=c[0];l[1]=c[1]}if(t.touches[1]){c=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);l[2]=c[0];l[3]=c[1]}if(t.touches[2]){c=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);l[4]=c[0];l[5]=c[1]}}else if(t.touches[0]&&!e.touchData.didSelect){var be=e.touchData.start;var xe=e.touchData.last;e.hoverData.draggingEles||e.swipePanning||(Z=e.findNearestElement(l[0],l[1],true,true));a&&be!=null&&t.preventDefault();if(a&&be!=null&&e.nodeIsDraggable(be))if(p){te=e.dragData.touchDragEles;var we=!e.dragData.didDrag;we&&m(te,{inDragLayer:true});e.dragData.didDrag=true;var Ee={x:0,y:0};if(h(g[0])&&h(g[1])){Ee.x+=g[0];Ee.y+=g[1];if(we){e.redrawHint("eles",true);var Ce=e.touchData.dragDelta;if(Ce&&h(Ce[0])&&h(Ce[1])){Ee.x+=Ce[0];Ee.y+=Ce[1]}}}e.hoverData.draggingEles=true;te.silentShift(Ee).emit("position drag");e.redrawHint("drag",true);e.touchData.startPosition[0]==u[0]&&e.touchData.startPosition[1]==u[1]&&e.redrawHint("eles",true);e.redraw()}else{Ce=e.touchData.dragDelta=e.touchData.dragDelta||[];if(Ce.length===0){Ce.push(g[0]);Ce.push(g[1])}else{Ce[0]+=g[0];Ce[1]+=g[1]}}i(be||Z,["touchmove","tapdrag","vmousemove"],t,{x:l[0],y:l[1]});if((!be||!be.grabbed())&&Z!=xe){xe&&xe.emit({originalEvent:t,type:"tapdragout",position:{x:l[0],y:l[1]}});Z&&Z.emit({originalEvent:t,type:"tapdragover",position:{x:l[0],y:l[1]}})}e.touchData.last=Z;if(a)for(re=0;re<l.length;re++)l[re]&&e.touchData.startPosition[re]&&p&&(e.touchData.singleTouchMoved=true);if(a&&(be==null||be.pannable())&&o.panningEnabled()&&o.userPanningEnabled()){var Te=s(be,e.touchData.starts);if(Te){t.preventDefault();e.data.bgActivePosistion||(e.data.bgActivePosistion=$t(e.touchData.startPosition));if(e.swipePanning){o.panBy({x:g[0]*v,y:g[1]*v});o.emit("dragpan")}else if(p){e.swipePanning=true;o.panBy({x:b*v,y:E*v});o.emit("dragpan");if(be){be.unactivate();e.redrawHint("select",true);e.touchData.start=null}}}c=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);l[0]=c[0];l[1]=c[1]}}for(y=0;y<l.length;y++)u[y]=l[y];if(a&&t.touches.length>0&&!e.hoverData.draggingEles&&!e.swipePanning&&e.data.bgActivePosistion!=null){e.data.bgActivePosistion=void 0;e.redrawHint("select",true);e.redraw()}}},false);var ae;e.registerBinding(t,"touchcancel",ae=function touchcancelHandler(t){var a=e.touchData.start;e.touchData.capture=false;a&&a.unactivate()});var ne,ie,oe,se;e.registerBinding(t,"touchend",ne=function touchendHandler(t){var n=e.touchData.start;var o=e.touchData.capture;if(o){t.touches.length===0&&(e.touchData.capture=false);t.preventDefault();var s=e.selection;e.swipePanning=false;e.hoverData.draggingEles=false;var l=e.cy;var u=l.zoom();var v=e.touchData.now;var c=e.touchData.earlier;if(t.touches[0]){var d=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);v[0]=d[0];v[1]=d[1]}if(t.touches[1]){d=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);v[2]=d[0];v[3]=d[1]}if(t.touches[2]){d=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);v[4]=d[0];v[5]=d[1]}n&&n.unactivate();var h;if(e.touchData.cxt){h={originalEvent:t,type:"cxttapend",position:{x:v[0],y:v[1]}};n?n.emit(h):l.emit(h);if(!e.touchData.cxtDragged){var p={originalEvent:t,type:"cxttap",position:{x:v[0],y:v[1]}};n?n.emit(p):l.emit(p)}e.touchData.start&&(e.touchData.start._private.grabbed=false);e.touchData.cxt=false;e.touchData.start=null;e.redraw()}else{if(!t.touches[2]&&l.boxSelectionEnabled()&&e.touchData.selecting){e.touchData.selecting=false;var g=l.collection(e.getAllInBox(s[0],s[1],s[2],s[3]));s[0]=void 0;s[1]=void 0;s[2]=void 0;s[3]=void 0;s[4]=0;e.redrawHint("select",true);l.emit({type:"boxend",originalEvent:t,position:{x:v[0],y:v[1]}});var y=function eleWouldBeSelected(e){return e.selectable()&&!e.selected()};g.emit("box").stdFilter(y).select().emit("boxselect");g.nonempty()&&e.redrawHint("eles",true);e.redraw()}n!=null&&n.unactivate();if(t.touches[2]){e.data.bgActivePosistion=void 0;e.redrawHint("select",true)}else if(t.touches[1]);else if(t.touches[0]);else if(!t.touches[0]){e.data.bgActivePosistion=void 0;e.redrawHint("select",true);var m=e.dragData.touchDragEles;if(n!=null){var b=n._private.grabbed;x(m);e.redrawHint("drag",true);e.redrawHint("eles",true);if(b){n.emit("freeon");m.emit("free");if(e.dragData.didDrag){n.emit("dragfreeon");m.emit("dragfree")}}i(n,["touchend","tapend","vmouseup","tapdragout"],t,{x:v[0],y:v[1]});n.unactivate();e.touchData.start=null}else{var w=e.findNearestElement(v[0],v[1],true,true);i(w,["touchend","tapend","vmouseup","tapdragout"],t,{x:v[0],y:v[1]})}var E=e.touchData.startPosition[0]-v[0];var T=E*E;var S=e.touchData.startPosition[1]-v[1];var k=S*S;var P=T+k;var _=P*u*u;if(!e.touchData.singleTouchMoved){n||l.$(":selected").unselect(["tapunselect"]);i(n,["tap","vclick"],t,{x:v[0],y:v[1]});ie=false;if(t.timeStamp-se<=l.multiClickDebounceTime()){oe&&clearTimeout(oe);ie=true;se=null;i(n,["dbltap","vdblclick"],t,{x:v[0],y:v[1]})}else{oe=setTimeout((function(){ie||i(n,["onetap","voneclick"],t,{x:v[0],y:v[1]})}),l.multiClickDebounceTime());se=t.timeStamp}}if(n!=null&&!e.dragData.didDrag&&n._private.selectable&&_<e.touchTapThreshold2&&!e.pinching){if(l.selectionType()==="single"){l.$(a).unmerge(n).unselect(["tapunselect"]);n.select(["tapselect"])}else n.selected()?n.unselect(["tapunselect"]):n.select(["tapselect"]);e.redrawHint("eles",true)}e.touchData.singleTouchMoved=true}for(var D=0;D<v.length;D++)c[D]=v[D];e.dragData.didDrag=false;if(t.touches.length===0){e.touchData.dragDelta=[];e.touchData.startPosition=[null,null,null,null,null,null];e.touchData.startGPosition=null;e.touchData.didSelect=false}if(t.touches.length<2){t.touches.length===1&&(e.touchData.startGPosition=[t.touches[0].clientX,t.touches[0].clientY]);e.pinching=false;e.redrawHint("eles",true);e.redraw()}}}},false);if(typeof TouchEvent==="undefined"){var le=[];var ue=function makeTouch(e){return{clientX:e.clientX,clientY:e.clientY,force:1,identifier:e.pointerId,pageX:e.pageX,pageY:e.pageY,radiusX:e.width/2,radiusY:e.height/2,screenX:e.screenX,screenY:e.screenY,target:e.target}};var ve=function makePointer(e){return{event:e,touch:ue(e)}};var ce=function addPointer(e){le.push(ve(e))};var de=function removePointer(e){for(var t=0;t<le.length;t++){var a=le[t];if(a.event.pointerId===e.pointerId){le.splice(t,1);return}}};var he=function updatePointer(e){var t=le.filter((function(t){return t.event.pointerId===e.pointerId}))[0];t.event=e;t.touch=ue(e)};var fe=function addTouchesToEvent(e){e.touches=le.map((function(e){return e.touch}))};var pe=function pointerIsMouse(e){return e.pointerType==="mouse"||e.pointerType===4};e.registerBinding(e.container,"pointerdown",(function(e){if(!pe(e)){e.preventDefault();ce(e);fe(e);te(e)}}));e.registerBinding(e.container,"pointerup",(function(e){if(!pe(e)){de(e);fe(e);ne(e)}}));e.registerBinding(e.container,"pointercancel",(function(e){if(!pe(e)){de(e);fe(e);ae(e)}}));e.registerBinding(e.container,"pointermove",(function(e){if(!pe(e)){e.preventDefault();he(e);fe(e);re(e)}}))}};var jv={};jv.generatePolygon=function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,draw:function draw(e,t,a,n,i,o){this.renderer.nodeShapeImpl("polygon",e,t,a,n,i,this.points)},intersectLine:function intersectLine(e,t,a,n,i,o,s,l){return Hr(i,o,this.points,e,t,a/2,n/2,s)},checkPoint:function checkPoint(e,t,a,n,i,o,s,l){return Rr(e,t,this.points,o,s,n,i,[0,-1],a)}}};jv.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function draw(e,t,a,n,i,o){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i)},intersectLine:function intersectLine(e,t,a,n,i,o,s,l){return Fr(i,o,e,t,a/2+s,n/2+s)},checkPoint:function checkPoint(e,t,a,n,i,o,s,l){return zr(e,t,n,i,o,s,a)}}};jv.generateRoundPolygon=function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,getOrCreateCorners:function getOrCreateCorners(e,a,n,i,o,s,l){if(s[l]!==void 0&&s[l+"-cx"]===e&&s[l+"-cy"]===a)return s[l];s[l]=new Array(t.length/2);s[l+"-cx"]=e;s[l+"-cy"]=a;var u=n/2;var v=i/2;o=o==="auto"?Zr(n,i):o;var c=new Array(t.length/2);for(var d=0;d<t.length/2;d++)c[d]={x:e+u*t[d*2],y:a+v*t[d*2+1]};var h,p,g,y,m=c.length;p=c[m-1];for(h=0;h<m;h++){g=c[h%m];y=c[(h+1)%m];s[l][h]=getRoundCorner(p,g,y,o);p=g;g=y}return s[l]},draw:function draw(e,t,a,n,i,o,s){this.renderer.nodeShapeImpl("round-polygon",e,t,a,n,i,this.points,this.getOrCreateCorners(t,a,n,i,o,s,"drawCorners"))},intersectLine:function intersectLine(e,t,a,n,i,o,s,l,u){return Wr(i,o,this.points,e,t,a,n,s,this.getOrCreateCorners(e,t,a,n,l,u,"corners"))},checkPoint:function checkPoint(e,t,a,n,i,o,s,l,u){return Lr(e,t,this.points,o,s,n,i,this.getOrCreateCorners(o,s,n,i,l,u,"corners"))}}};jv.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Yr(4,0),draw:function draw(e,t,a,n,i,o){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i,this.points,o)},intersectLine:function intersectLine(e,t,a,n,i,o,s,l){return kr(i,o,e,t,a,n,s,l)},checkPoint:function checkPoint(e,t,a,n,i,o,s,l){var u=n/2;var v=i/2;l=l==="auto"?Ur(n,i):l;l=Math.min(u,v,l);var c=l*2;return!!Rr(e,t,this.points,o,s,n,i-c,[0,-1],a)||(!!Rr(e,t,this.points,o,s,n-c,i,[0,-1],a)||(!!zr(e,t,c,c,o-u+l,s-v+l,a)||(!!zr(e,t,c,c,o+u-l,s-v+l,a)||(!!zr(e,t,c,c,o+u-l,s+v-l,a)||!!zr(e,t,c,c,o-u+l,s+v-l,a)))))}}};jv.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:$r(),points:Yr(4,0),draw:function draw(e,t,a,n,i,o){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i,null,o)},generateCutTrianglePts:function generateCutTrianglePts(e,t,a,n,i){var o=i==="auto"?this.cornerLength:i;var s=t/2;var l=e/2;var u=a-l;var v=a+l;var c=n-s;var d=n+s;return{topLeft:[u,c+o,u+o,c,u+o,c+o],topRight:[v-o,c,v,c+o,v-o,c+o],bottomRight:[v,d-o,v-o,d,v-o,d-o],bottomLeft:[u+o,d,u,d-o,u+o,d-o]}},intersectLine:function intersectLine(e,t,a,n,i,o,s,l){var u=this.generateCutTrianglePts(a+2*s,n+2*s,e,t,l);var v=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return Hr(i,o,v,e,t)},checkPoint:function checkPoint(e,t,a,n,i,o,s,l){var u=l==="auto"?this.cornerLength:l;if(Rr(e,t,this.points,o,s,n,i-2*u,[0,-1],a))return true;if(Rr(e,t,this.points,o,s,n-2*u,i,[0,-1],a))return true;var v=this.generateCutTrianglePts(n,i,o,s);return Mr(e,t,v.topLeft)||Mr(e,t,v.topRight)||Mr(e,t,v.bottomRight)||Mr(e,t,v.bottomLeft)}}};jv.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Yr(4,0),draw:function draw(e,t,a,n,i,o){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i)},intersectLine:function intersectLine(e,t,a,n,i,o,s,l){var u=.15;var v=.5;var c=.85;var d=this.generateBarrelBezierPts(a+2*s,n+2*s,e,t);var h=function approximateBarrelCurvePts(e){var t=vr({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},u);var a=vr({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},v);var n=vr({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},c);return[e[0],e[1],t.x,t.y,a.x,a.y,n.x,n.y,e[4],e[5]]};var p=[].concat(h(d.topLeft),h(d.topRight),h(d.bottomRight),h(d.bottomLeft));return Hr(i,o,p,e,t)},generateBarrelBezierPts:function generateBarrelBezierPts(e,t,a,n){var i=t/2;var o=e/2;var s=a-o;var l=a+o;var u=n-i;var v=n+i;var c=Jr(e,t);var d=c.heightOffset;var h=c.widthOffset;var p=c.ctrlPtOffsetPct*e;var g={topLeft:[s,u+d,s+p,u,s+h,u],topRight:[l-h,u,l-p,u,l,u+d],bottomRight:[l,v-d,l-p,v,l-h,v],bottomLeft:[s+h,v,s+p,v,s,v-d]};g.topLeft.isTop=true;g.topRight.isTop=true;g.bottomLeft.isBottom=true;g.bottomRight.isBottom=true;return g},checkPoint:function checkPoint(e,t,a,n,i,o,s,l){var u=Jr(n,i);var v=u.heightOffset;var c=u.widthOffset;if(Rr(e,t,this.points,o,s,n,i-2*v,[0,-1],a))return true;if(Rr(e,t,this.points,o,s,n-2*c,i,[0,-1],a))return true;var d=this.generateBarrelBezierPts(n,i,o,s);var h=function getCurveT(e,t,a){var n=a[4];var i=a[2];var o=a[0];var s=a[5];var l=a[1];var u=Math.min(n,o);var v=Math.max(n,o);var c=Math.min(s,l);var d=Math.max(s,l);if(u<=e&&e<=v&&c<=t&&t<=d){var h=Qr(n,i,o);var p=Dr(h[0],h[1],h[2],e);var g=p.filter((function(e){return 0<=e&&e<=1}));if(g.length>0)return g[0]}return null};var p=Object.keys(d);for(var g=0;g<p.length;g++){var y=p[g];var m=d[y];var b=h(e,t,m);if(b!=null){var x=m[5];var w=m[3];var E=m[1];var T=ur(x,w,E,b);if(m.isTop&&T<=t)return true;if(m.isBottom&&t<=T)return true}}return false}}};jv.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Yr(4,0),draw:function draw(e,t,a,n,i,o){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i,this.points,o)},intersectLine:function intersectLine(e,t,a,n,i,o,s,l){var u=e-(a/2+s);var v=t-(n/2+s);var c=v;var d=e+(a/2+s);var h=jr(i,o,e,t,u,v,d,c,false);return h.length>0?h:kr(i,o,e,t,a,n,s,l)},checkPoint:function checkPoint(e,t,a,n,i,o,s,l){l=l==="auto"?Ur(n,i):l;var u=2*l;if(Rr(e,t,this.points,o,s,n,i-u,[0,-1],a))return true;if(Rr(e,t,this.points,o,s,n-u,i,[0,-1],a))return true;var v=n/2+2*a;var c=i/2+2*a;var d=[o-v,s-c,o-v,s,o+v,s,o+v,s-c];return!!Mr(e,t,d)||(!!zr(e,t,u,u,o+n/2-l,s+i/2-l,a)||!!zr(e,t,u,u,o-n/2+l,s+i/2-l,a))}}};jv.registerNodeShapes=function(){var e=this.nodeShapes={};var t=this;this.generateEllipse();this.generatePolygon("triangle",Yr(3,0));this.generateRoundPolygon("round-triangle",Yr(3,0));this.generatePolygon("rectangle",Yr(4,0));e.square=e.rectangle;this.generateRoundRectangle();this.generateCutRectangle();this.generateBarrel();this.generateBottomRoundrectangle();var a=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",a);this.generateRoundPolygon("round-diamond",a);this.generatePolygon("pentagon",Yr(5,0));this.generateRoundPolygon("round-pentagon",Yr(5,0));this.generatePolygon("hexagon",Yr(6,0));this.generateRoundPolygon("round-hexagon",Yr(6,0));this.generatePolygon("heptagon",Yr(7,0));this.generateRoundPolygon("round-heptagon",Yr(7,0));this.generatePolygon("octagon",Yr(8,0));this.generateRoundPolygon("round-octagon",Yr(8,0));var n=new Array(20);var i=Kr(5,0);var o=Kr(5,Math.PI/5);var s=.5*(3-Math.sqrt(5));s*=1.57;for(var l=0;l<o.length/2;l++){o[l*2]*=s;o[l*2+1]*=s}for(l=0;l<5;l++){n[l*4]=i[l*2];n[l*4+1]=i[l*2+1];n[l*4+2]=o[l*2];n[l*4+3]=o[l*2+1]}n=Gr(n);this.generatePolygon("star",n);this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]);this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]);this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]);this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);var u=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",u);this.generateRoundPolygon("round-tag",u);e.makePolygon=function(e){var a=e.join("$");var n="polygon-"+a;var i;return(i=this[n])?i:t.generatePolygon(n,e)}};var Hv={};Hv.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};Hv.redraw=function(e){e=e||ht();var t=this;t.averageRedrawTime===void 0&&(t.averageRedrawTime=0);t.lastRedrawTime===void 0&&(t.lastRedrawTime=0);t.lastDrawTime===void 0&&(t.lastDrawTime=0);t.requestedFrame=true;t.renderOptions=e};Hv.beforeRender=function(e,t){if(!this.destroyed){t==null&&it("Priority is not optional for beforeRender");var a=this.beforeRenderCallbacks;a.push({fn:e,priority:t});a.sort((function(e,t){return t.priority-e.priority}))}};var Wv=function beforeRenderCallbacks(e,t,a){var n=e.beforeRenderCallbacks;for(var i=0;i<n.length;i++)n[i].fn(t,a)};Hv.startRenderLoop=function(){var e=this;var t=e.cy;if(!e.renderLoopStarted){e.renderLoopStarted=true;var a=function renderFn(n){if(!e.destroyed){if(t.batching());else if(e.requestedFrame&&!e.skipFrame){Wv(e,true,n);var i=Oe();e.render(e.renderOptions);var o=e.lastDrawTime=Oe();e.averageRedrawTime===void 0&&(e.averageRedrawTime=o-i);e.redrawCount===void 0&&(e.redrawCount=0);e.redrawCount++;e.redrawTotalTime===void 0&&(e.redrawTotalTime=0);var s=o-i;e.redrawTotalTime+=s;e.lastRedrawTime=s;e.averageRedrawTime=e.averageRedrawTime/2+s/2;e.requestedFrame=false}else Wv(e,false,n);e.skipFrame=false;Ne(a)}};Ne(a)}};var Xv=function BaseRenderer(e){this.init(e)};var Yv=Xv;var Gv=Yv.prototype;Gv.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Gv.init=function(e){var t=this;t.options=e;t.cy=e.cy;var a=t.container=e.cy.container();var n=t.cy.window();if(n){var i=n.document;var o=i.head;var s="__________cytoscape_stylesheet";var l="__________cytoscape_container";var u=i.getElementById(s)!=null;a.className.indexOf(l)<0&&(a.className=(a.className||"")+" "+l);if(!u){var v=i.createElement("style");v.id=s;v.textContent="."+l+" { position: relative; }";o.insertBefore(v,o.children[0])}var c=n.getComputedStyle(a);var d=c.getPropertyValue("position");d==="static"&&st("A Cytoscape container has style position:static and so can not use UI extensions properly")}t.selection=[void 0,void 0,void 0,void 0,0];t.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95];t.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:false,initialPan:[null,null],capture:false};t.dragData={possibleDragElements:[]};t.touchData={start:null,capture:false,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:true,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]};t.redraws=0;t.showFps=e.showFps;t.debug=e.debug;t.webgl=e.webgl;t.hideEdgesOnViewport=e.hideEdgesOnViewport;t.textureOnViewport=e.textureOnViewport;t.wheelSensitivity=e.wheelSensitivity;t.motionBlurEnabled=e.motionBlur;t.forcedPixelRatio=h(e.pixelRatio)?e.pixelRatio:null;t.motionBlur=e.motionBlur;t.motionBlurOpacity=e.motionBlurOpacity;t.motionBlurTransparency=1-t.motionBlurOpacity;t.motionBlurPxRatio=1;t.mbPxRBlurry=1;t.minMbLowQualFrames=4;t.fullQualityMb=false;t.clearedForMotionBlur=[];t.desktopTapThreshold=e.desktopTapThreshold;t.desktopTapThreshold2=e.desktopTapThreshold*e.desktopTapThreshold;t.touchTapThreshold=e.touchTapThreshold;t.touchTapThreshold2=e.touchTapThreshold*e.touchTapThreshold;t.tapholdDuration=500;t.bindings=[];t.beforeRenderCallbacks=[];t.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100};t.registerNodeShapes();t.registerArrowShapes();t.registerCalculationListeners()};Gv.notify=function(e,t){var a=this;var n=a.cy;if(!this.destroyed)if(e!=="init")if(e!=="destroy"){(e==="add"||e==="remove"||e==="move"&&n.hasCompoundNodes()||e==="load"||e==="zorder"||e==="mount")&&a.invalidateCachedZSortedEles();e==="viewport"&&a.redrawHint("select",true);e==="gc"&&a.redrawHint("gc",true);if(e==="load"||e==="resize"||e==="mount"){a.invalidateContainerClientCoordsCache();a.matchCanvasSize(a.container)}a.redrawHint("eles",true);a.redrawHint("drag",true);this.startRenderLoop();this.redraw()}else a.destroy();else a.load()};Gv.destroy=function(){var e=this;e.destroyed=true;e.cy.stopAnimationLoop();for(var t=0;t<e.bindings.length;t++){var a=e.bindings[t];var n=a;var i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}e.bindings=[];e.beforeRenderCallbacks=[];e.onUpdateEleCalcsFns=[];e.removeObserver&&e.removeObserver.disconnect();e.styleObserver&&e.styleObserver.disconnect();e.resizeObserver&&e.resizeObserver.disconnect();if(e.labelCalcDiv)try{document.body.removeChild(e.labelCalcDiv)}catch(e){}};Gv.isHeadless=function(){return false};[ev,zv,Vv,qv,jv,Hv].forEach((function(e){Y(Gv,e)}));var Kv=1e3/60;var Uv={setupDequeueing:function setupDequeueing(e){return function setupDequeueingImpl(){var t=this;var a=this.renderer;if(!t.dequeueingSetup){t.dequeueingSetup=true;var n=Ie((function(){a.redrawHint("eles",true);a.redrawHint("drag",true);a.redraw()}),e.deqRedrawThreshold);var i=function dequeue(i,o){var s=Oe();var l=a.averageRedrawTime;var u=a.lastRedrawTime;var v=[];var c=a.cy.extent();var d=a.getPixelRatio();i||a.flushRenderedStyleQueue();while(true){var h=Oe();var p=h-s;var g=h-o;if(u<Kv){var y=Kv-(i?l:0);if(g>=e.deqFastCost*y)break}else if(i){if(p>=e.deqCost*u||p>=e.deqAvgCost*l)break}else if(g>=e.deqNoDrawCost*Kv)break;var m=e.deq(t,d,c);if(!(m.length>0))break;for(var b=0;b<m.length;b++)v.push(m[b])}if(v.length>0){e.onDeqd(t,v);!i&&e.shouldRedraw(t,v,d,c)&&n()}};var o=e.priority||nt;a.beforeRender(i,o(t))}}}};var Zv=function(){function ElementTextureCacheLookup(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rt;_classCallCheck(this,ElementTextureCacheLookup);this.idsByKey=new wt;this.keyForId=new wt;this.cachesByLvl=new wt;this.lvls=[];this.getKey=e;this.doesEleInvalidateKey=t}return _createClass(ElementTextureCacheLookup,[{key:"getIdsFor",value:function getIdsFor(e){e==null&&it("Can not get id list for null key");var t=this.idsByKey;var a=this.idsByKey.get(e);if(!a){a=new Tt;t.set(e,a)}return a}},{key:"addIdForKey",value:function addIdForKey(e,t){e!=null&&this.getIdsFor(e).add(t)}},{key:"deleteIdForKey",value:function deleteIdForKey(e,t){e!=null&&this.getIdsFor(e).delete(t)}},{key:"getNumberOfIdsForKey",value:function getNumberOfIdsForKey(e){return e==null?0:this.getIdsFor(e).size}},{key:"updateKeyMappingFor",value:function updateKeyMappingFor(e){var t=e.id();var a=this.keyForId.get(t);var n=this.getKey(e);this.deleteIdForKey(a,t);this.addIdForKey(n,t);this.keyForId.set(t,n)}},{key:"deleteKeyMappingFor",value:function deleteKeyMappingFor(e){var t=e.id();var a=this.keyForId.get(t);this.deleteIdForKey(a,t);this.keyForId.delete(t)}},{key:"keyHasChangedFor",value:function keyHasChangedFor(e){var t=e.id();var a=this.keyForId.get(t);var n=this.getKey(e);return a!==n}},{key:"isInvalid",value:function isInvalid(e){return this.keyHasChangedFor(e)||this.doesEleInvalidateKey(e)}},{key:"getCachesAt",value:function getCachesAt(e){var t=this.cachesByLvl,a=this.lvls;var n=t.get(e);if(!n){n=new wt;t.set(e,n);a.push(e)}return n}},{key:"getCache",value:function getCache(e,t){return this.getCachesAt(t).get(e)}},{key:"get",value:function get(e,t){var a=this.getKey(e);var n=this.getCache(a,t);n!=null&&this.updateKeyMappingFor(e);return n}},{key:"getForCachedKey",value:function getForCachedKey(e,t){var a=this.keyForId.get(e.id());var n=this.getCache(a,t);return n}},{key:"hasCache",value:function hasCache(e,t){return this.getCachesAt(t).has(e)}},{key:"has",value:function has(e,t){var a=this.getKey(e);return this.hasCache(a,t)}},{key:"setCache",value:function setCache(e,t,a){a.key=e;this.getCachesAt(t).set(e,a)}},{key:"set",value:function set(e,t,a){var n=this.getKey(e);this.setCache(n,t,a);this.updateKeyMappingFor(e)}},{key:"deleteCache",value:function deleteCache(e,t){this.getCachesAt(t).delete(e)}},{key:"delete",value:function _delete(e,t){var a=this.getKey(e);this.deleteCache(a,t)}},{key:"invalidateKey",value:function invalidateKey(e){var t=this;this.lvls.forEach((function(a){return t.deleteCache(e,a)}))}},{key:"invalidate",value:function invalidate(e){var t=e.id();var a=this.keyForId.get(t);this.deleteKeyMappingFor(e);var n=this.doesEleInvalidateKey(e);n&&this.invalidateKey(a);return n||this.getNumberOfIdsForKey(a)===0}}])}();var $v=25;var Qv=50;var Jv=-4;var ec=3;var tc=7.99;var rc=8;var ac=1024;var nc=1024;var ic=1024;var oc=.2;var sc=.8;var lc=10;var uc=.15;var vc=.1;var cc=.9;var dc=.9;var hc=100;var fc=1;var pc={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"};var yc=ft({getKey:null,doesEleInvalidateKey:rt,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:tt,allowEdgeTxrCaching:true,allowParentTxrCaching:true});var mc=function ElementTextureCache(e,t){var a=this;a.renderer=e;a.onDequeues=[];var n=yc(t);Y(a,n);a.lookup=new Zv(n.getKey,n.doesEleInvalidateKey);a.setupDequeueing()};var bc=mc.prototype;bc.reasons=pc;bc.getTextureQueue=function(e){var t=this;t.eleImgCaches=t.eleImgCaches||{};return t.eleImgCaches[e]=t.eleImgCaches[e]||[]};bc.getRetiredTextureQueue=function(e){var t=this;var a=t.eleImgCaches.retired=t.eleImgCaches.retired||{};var n=a[e]=a[e]||[];return n};bc.getElementQueue=function(){var e=this;var t=e.eleCacheQueue=e.eleCacheQueue||new Rt((function(e,t){return t.reqs-e.reqs}));return t};bc.getElementKeyToQueue=function(){var e=this;var t=e.eleKeyToCacheQueue=e.eleKeyToCacheQueue||{};return t};bc.getElement=function(e,t,a,n,i){var o=this;var s=this.renderer;var l=s.cy.zoom();var u=this.lookup;if(!t||t.w===0||t.h===0||isNaN(t.w)||isNaN(t.h)||!e.visible()||e.removed())return null;if(!o.allowEdgeTxrCaching&&e.isEdge()||!o.allowParentTxrCaching&&e.isParent())return null;n==null&&(n=Math.ceil(nr(l*a)));if(n<Jv)n=Jv;else if(l>=tc||n>ec)return null;var v=Math.pow(2,n);var c=t.h*v;var d=t.w*v;var h=s.eleTextBiggerThanMin(e,v);if(!this.isVisible(e,h))return null;var p=u.get(e,n);if(p&&p.invalidated){p.invalidated=false;p.texture.invalidatedWidth-=p.width}if(p)return p;var g;g=c<=$v?$v:c<=Qv?Qv:Math.ceil(c/Qv)*Qv;if(c>ic||d>nc)return null;var y=o.getTextureQueue(g);var m=y[y.length-2];var b=function addNewTxr(){return o.recycleTexture(g,d)||o.addTexture(g,d)};m||(m=y[y.length-1]);m||(m=b());m.width-m.usedWidth<d&&(m=b());var x=function scalableFrom(e){return e&&e.scaledLabelShown===h};var w=i&&i===pc.dequeue;var E=i&&i===pc.highQuality;var T=i&&i===pc.downscale;var S;for(var k=n+1;k<=ec;k++){var P=u.get(e,k);if(P){S=P;break}}var _=S&&S.level===n+1?S:null;var D=function downscale(){m.context.drawImage(_.texture.canvas,_.x,0,_.width,_.height,m.usedWidth,0,d,c)};m.context.setTransform(1,0,0,1,0,0);m.context.clearRect(m.usedWidth,0,d,g);if(x(_))D();else if(x(S)){if(!E){o.queueElement(e,S.level-1);return S}for(var I=S.level;I>n;I--)_=o.getElement(e,t,a,I,pc.downscale);D()}else{var M;if(!w&&!E&&!T)for(var R=n-1;R>=Jv;R--){var L=u.get(e,R);if(L){M=L;break}}if(x(M)){o.queueElement(e,n);return M}m.context.translate(m.usedWidth,0);m.context.scale(v,v);this.drawElement(m.context,e,t,h,false);m.context.scale(1/v,1/v);m.context.translate(-m.usedWidth,0)}p={x:m.usedWidth,texture:m,level:n,scale:v,width:d,height:c,scaledLabelShown:h};m.usedWidth+=Math.ceil(d+rc);m.eleCaches.push(p);u.set(e,n,p);o.checkTextureFullness(m);return p};bc.invalidateElements=function(e){for(var t=0;t<e.length;t++)this.invalidateElement(e[t])};bc.invalidateElement=function(e){var t=this;var a=t.lookup;var n=[];var i=a.isInvalid(e);if(i){for(var o=Jv;o<=ec;o++){var s=a.getForCachedKey(e,o);s&&n.push(s)}var l=a.invalidate(e);if(l)for(var u=0;u<n.length;u++){var v=n[u];var c=v.texture;c.invalidatedWidth+=v.width;v.invalidated=true;t.checkTextureUtility(c)}t.removeFromQueue(e)}};bc.checkTextureUtility=function(e){e.invalidatedWidth>=oc*e.width&&this.retireTexture(e)};bc.checkTextureFullness=function(e){var t=this;var a=t.getTextureQueue(e.height);e.usedWidth/e.width>sc&&e.fullnessChecks>=lc?pt(a,e):e.fullnessChecks++};bc.retireTexture=function(e){var t=this;var a=e.height;var n=t.getTextureQueue(a);var i=this.lookup;pt(n,e);e.retired=true;var o=e.eleCaches;for(var s=0;s<o.length;s++){var l=o[s];i.deleteCache(l.key,l.level)}gt(o);var u=t.getRetiredTextureQueue(a);u.push(e)};bc.addTexture=function(e,t){var a=this;var n=a.getTextureQueue(e);var i={};n.push(i);i.eleCaches=[];i.height=e;i.width=Math.max(ac,t);i.usedWidth=0;i.invalidatedWidth=0;i.fullnessChecks=0;i.canvas=a.renderer.makeOffscreenCanvas(i.width,i.height);i.context=i.canvas.getContext("2d");return i};bc.recycleTexture=function(e,t){var a=this;var n=a.getTextureQueue(e);var i=a.getRetiredTextureQueue(e);for(var o=0;o<i.length;o++){var s=i[o];if(s.width>=t){s.retired=false;s.usedWidth=0;s.invalidatedWidth=0;s.fullnessChecks=0;gt(s.eleCaches);s.context.setTransform(1,0,0,1,0,0);s.context.clearRect(0,0,s.width,s.height);pt(i,s);n.push(s);return s}}};bc.queueElement=function(e,t){var a=this;var n=a.getElementQueue();var i=a.getElementKeyToQueue();var o=this.getKey(e);var s=i[o];if(s){s.level=Math.max(s.level,t);s.eles.merge(e);s.reqs++;n.updateItem(s)}else{var l={eles:e.spawn().merge(e),level:t,reqs:1,key:o};n.push(l);i[o]=l}};bc.dequeue=function(e){var t=this;var a=t.getElementQueue();var n=t.getElementKeyToQueue();var i=[];var o=t.lookup;for(var s=0;s<fc;s++){if(!(a.size()>0))break;var l=a.pop();var u=l.key;var v=l.eles[0];var c=o.hasCache(v,l.level);n[u]=null;if(!c){i.push(l);var d=t.getBoundingBox(v);t.getElement(v,d,e,l.level,pc.dequeue)}}return i};bc.removeFromQueue=function(e){var t=this;var a=t.getElementQueue();var n=t.getElementKeyToQueue();var i=this.getKey(e);var o=n[i];if(o!=null)if(o.eles.length===1){o.reqs=et;a.updateItem(o);a.pop();n[i]=null}else o.eles.unmerge(e)};bc.onDequeue=function(e){this.onDequeues.push(e)};bc.offDequeue=function(e){pt(this.onDequeues,e)};bc.setupDequeueing=Uv.setupDequeueing({deqRedrawThreshold:hc,deqCost:uc,deqAvgCost:vc,deqNoDrawCost:cc,deqFastCost:dc,deq:function deq(e,t,a){return e.dequeue(t,a)},onDeqd:function onDeqd(e,t){for(var a=0;a<e.onDequeues.length;a++){var n=e.onDequeues[a];n(t)}},shouldRedraw:function shouldRedraw(e,t,a,n){for(var i=0;i<t.length;i++){var o=t[i].eles;for(var s=0;s<o.length;s++){var l=o[s].boundingBox();if(Er(l,n))return true}}return false},priority:function priority(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var xc=1;var wc=-4;var Ec=2;var Cc=3.99;var Tc=50;var Sc=50;var kc=.15;var Pc=.1;var _c=.9;var Dc=.9;var Ac=1;var Bc=250;var Ic=16e6;var Mc=32767;var Rc=true;var Lc=function LayeredTextureCache(e){var t=this;var a=t.renderer=e;var n=a.cy;t.layersByLevel={};t.firstGet=true;t.lastInvalidationTime=Oe()-2*Bc;t.skipping=false;t.eleTxrDeqs=n.collection();t.scheduleElementRefinement=Ie((function(){t.refineElementTextures(t.eleTxrDeqs);t.eleTxrDeqs.unmerge(t.eleTxrDeqs)}),Sc);a.beforeRender((function(e,a){a-t.lastInvalidationTime<=Bc?t.skipping=true:t.skipping=false}),a.beforeRenderPriorities.lyrTxrSkip);var i=function qSort(e,t){return t.reqs-e.reqs};t.layersQueue=new Rt(i);t.setupDequeueing()};var Nc=Lc.prototype;var Oc=0;var Fc=Math.pow(2,53)-1;Nc.makeLayer=function(e,t){var a=Math.pow(2,t);var n=Math.ceil(e.w*a);var i=Math.ceil(e.h*a);var o=this.renderer.makeOffscreenCanvas(n,i);var s={id:Oc=++Oc%Fc,bb:e,level:t,width:n,height:i,canvas:o,context:o.getContext("2d"),eles:[],elesQueue:[],reqs:0};var l=s.context;var u=-s.bb.x1;var v=-s.bb.y1;l.scale(a,a);l.translate(u,v);return s};Nc.getLayers=function(e,t,a){var n=this;var i=n.renderer;var o=i.cy;var s=o.zoom();var l=n.firstGet;n.firstGet=false;if(a==null){a=Math.ceil(nr(s*t));if(a<wc)a=wc;else if(s>=Cc||a>Ec)return null}n.validateLayersElesOrdering(a,e);var u=n.layersByLevel;var v=Math.pow(2,a);var c=u[a]=u[a]||[];var d;var h=n.levelIsComplete(a,e);var p;var g=function checkTempLevels(){var t=function canUseAsTmpLvl(t){n.validateLayersElesOrdering(t,e);if(n.levelIsComplete(t,e)){p=u[t];return true}};var i=function checkLvls(e){if(!p)for(var n=a+e;wc<=n&&n<=Ec;n+=e)if(t(n))break};i(1);i(-1);for(var o=c.length-1;o>=0;o--){var s=c[o];s.invalid&&pt(c,s)}};if(h)return c;g();var y=function getBb(){if(!d){d=hr();for(var t=0;t<e.length;t++)yr(d,e[t].boundingBox())}return d};var m=function makeLayer(e){e=e||{};var t=e.after;y();var i=Math.ceil(d.w*v);var o=Math.ceil(d.h*v);if(i>Mc||o>Mc)return null;var s=i*o;if(s>Ic)return null;var l=n.makeLayer(d,a);if(t!=null){var u=c.indexOf(t)+1;c.splice(u,0,l)}else(e.insert===void 0||e.insert)&&c.unshift(l);return l};if(n.skipping&&!l)return null;var b=null;var x=e.length/xc;var w=!l;for(var E=0;E<e.length;E++){var T=e[E];var S=T._private.rscratch;var k=S.imgLayerCaches=S.imgLayerCaches||{};var P=k[a];if(P)b=P;else{if(!b||b.eles.length>=x||!Sr(b.bb,T.boundingBox())){b=m({insert:true,after:b});if(!b)return null}p||w?n.queueLayer(b,T):n.drawEleInLayer(b,T,a,t);b.eles.push(T);k[a]=b}}return p||(w?null:c)};Nc.getEleLevelForLayerLevel=function(e,t){return e};Nc.drawEleInLayer=function(e,t,a,n){var i=this;var o=this.renderer;var s=e.context;var l=t.boundingBox();if(l.w!==0&&l.h!==0&&t.visible()){a=i.getEleLevelForLayerLevel(a,n);o.setImgSmoothing(s,false);o.drawCachedElement(s,t,null,null,a,Rc);o.setImgSmoothing(s,true)}};Nc.levelIsComplete=function(e,t){var a=this;var n=a.layersByLevel[e];if(!n||n.length===0)return false;var i=0;for(var o=0;o<n.length;o++){var s=n[o];if(s.reqs>0)return false;if(s.invalid)return false;i+=s.eles.length}return i===t.length};Nc.validateLayersElesOrdering=function(e,t){var a=this.layersByLevel[e];if(a)for(var n=0;n<a.length;n++){var i=a[n];var o=-1;for(var s=0;s<t.length;s++)if(i.eles[0]===t[s]){o=s;break}if(o<0)this.invalidateLayer(i);else{var l=o;for(s=0;s<i.eles.length;s++)if(i.eles[s]!==t[l+s]){this.invalidateLayer(i);break}}}};Nc.updateElementsInLayers=function(e,t){var a=this;var n=m(e[0]);for(var i=0;i<e.length;i++){var o=n?null:e[i];var s=n?e[i]:e[i].ele;var l=s._private.rscratch;var u=l.imgLayerCaches=l.imgLayerCaches||{};for(var v=wc;v<=Ec;v++){var c=u[v];c&&(o&&a.getEleLevelForLayerLevel(c.level)!==o.level||t(c,s,o))}}};Nc.haveLayers=function(){var e=this;var t=false;for(var a=wc;a<=Ec;a++){var n=e.layersByLevel[a];if(n&&n.length>0){t=true;break}}return t};Nc.invalidateElements=function(e){var t=this;if(e.length!==0){t.lastInvalidationTime=Oe();e.length!==0&&t.haveLayers()&&t.updateElementsInLayers(e,(function invalAssocLayers(e,a,n){t.invalidateLayer(e)}))}};Nc.invalidateLayer=function(e){this.lastInvalidationTime=Oe();if(!e.invalid){var t=e.level;var a=e.eles;var n=this.layersByLevel[t];pt(n,e);e.elesQueue=[];e.invalid=true;e.replacement&&(e.replacement.invalid=true);for(var i=0;i<a.length;i++){var o=a[i]._private.rscratch.imgLayerCaches;o&&(o[t]=null)}}};Nc.refineElementTextures=function(e){var t=this;t.updateElementsInLayers(e,(function refineEachEle(e,a,n){var i=e.replacement;if(!i){i=e.replacement=t.makeLayer(e.bb,e.level);i.replaces=e;i.eles=e.eles}if(!i.reqs)for(var o=0;o<i.eles.length;o++)t.queueLayer(i,i.eles[o])}))};Nc.enqueueElementRefinement=function(e){this.eleTxrDeqs.merge(e);this.scheduleElementRefinement()};Nc.queueLayer=function(e,t){var a=this;var n=a.layersQueue;var i=e.elesQueue;var o=i.hasId=i.hasId||{};if(!e.replacement){if(t){if(o[t.id()])return;i.push(t);o[t.id()]=true}if(e.reqs){e.reqs++;n.updateItem(e)}else{e.reqs=1;n.push(e)}}};Nc.dequeue=function(e){var t=this;var a=t.layersQueue;var n=[];var i=0;while(i<Ac){if(a.size()===0)break;var o=a.peek();if(o.replacement)a.pop();else if(o.replaces&&o!==o.replaces.replacement)a.pop();else if(o.invalid)a.pop();else{var s=o.elesQueue.shift();if(s){t.drawEleInLayer(o,s,o.level,e);i++}n.length===0&&n.push(true);if(o.elesQueue.length===0){a.pop();o.reqs=0;o.replaces&&t.applyLayerReplacement(o);t.requestRedraw()}}}return n};Nc.applyLayerReplacement=function(e){var t=this;var a=t.layersByLevel[e.level];var n=e.replaces;var i=a.indexOf(n);if(!(i<0||n.invalid)){a[i]=e;for(var o=0;o<e.eles.length;o++){var s=e.eles[o]._private;var l=s.imgLayerCaches=s.imgLayerCaches||{};l&&(l[e.level]=e)}t.requestRedraw()}};Nc.requestRedraw=Ie((function(){var e=this.renderer;e.redrawHint("eles",true);e.redrawHint("drag",true);e.redraw()}),100);Nc.setupDequeueing=Uv.setupDequeueing({deqRedrawThreshold:Tc,deqCost:kc,deqAvgCost:Pc,deqNoDrawCost:_c,deqFastCost:Dc,deq:function deq(e,t){return e.dequeue(t)},onDeqd:nt,shouldRedraw:tt,priority:function priority(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var zc={};var Vc;function polygon(e,t){for(var a=0;a<t.length;a++){var n=t[a];e.lineTo(n.x,n.y)}}function triangleBackcurve(e,t,a){var n;for(var i=0;i<t.length;i++){var o=t[i];i===0&&(n=o);e.lineTo(o.x,o.y)}e.quadraticCurveTo(a.x,a.y,n.x,n.y)}function triangleTee(e,t,a){e.beginPath&&e.beginPath();var n=t;for(var i=0;i<n.length;i++){var o=n[i];e.lineTo(o.x,o.y)}var s=a;var l=a[0];e.moveTo(l.x,l.y);for(i=1;i<s.length;i++){o=s[i];e.lineTo(o.x,o.y)}e.closePath&&e.closePath()}function circleTriangle(e,t,a,n,i){e.beginPath&&e.beginPath();e.arc(a,n,i,0,Math.PI*2,false);var o=t;var s=o[0];e.moveTo(s.x,s.y);for(var l=0;l<o.length;l++){var u=o[l];e.lineTo(u.x,u.y)}e.closePath&&e.closePath()}function circle(e,t,a,n){e.arc(t,a,n,0,Math.PI*2,false)}zc.arrowShapeImpl=function(e){return(Vc||(Vc={polygon:polygon,"triangle-backcurve":triangleBackcurve,"triangle-tee":triangleTee,"circle-triangle":circleTriangle,"triangle-cross":triangleTee,circle:circle}))[e]};var qc={};qc.drawElement=function(e,t,a,n,i,o){var s=this;t.isNode()?s.drawNode(e,t,a,n,i,o):s.drawEdge(e,t,a,n,i,o)};qc.drawElementOverlay=function(e,t){var a=this;t.isNode()?a.drawNodeOverlay(e,t):a.drawEdgeOverlay(e,t)};qc.drawElementUnderlay=function(e,t){var a=this;t.isNode()?a.drawNodeUnderlay(e,t):a.drawEdgeUnderlay(e,t)};qc.drawCachedElementPortion=function(e,t,a,n,i,o,s,l){var u=this;var v=a.getBoundingBox(t);if(v.w!==0&&v.h!==0){var c=a.getElement(t,v,n,i,o);if(c!=null){var d=l(u,t);if(d===0)return;var h=s(u,t);var p=v.x1,g=v.y1,y=v.w,m=v.h;var b,x,w,E,T;if(h!==0){var S=a.getRotationPoint(t);w=S.x;E=S.y;e.translate(w,E);e.rotate(h);T=u.getImgSmoothing(e);T||u.setImgSmoothing(e,true);var k=a.getRotationOffset(t);b=k.x;x=k.y}else{b=p;x=g}var P;if(d!==1){P=e.globalAlpha;e.globalAlpha=P*d}e.drawImage(c.texture.canvas,c.x,0,c.width,c.height,b,x,y,m);d!==1&&(e.globalAlpha=P);if(h!==0){e.rotate(-h);e.translate(-w,-E);T||u.setImgSmoothing(e,false)}}else a.drawElement(e,t)}};var jc=function getZeroRotation(){return 0};var Hc=function getLabelRotation(e,t){return e.getTextAngle(t,null)};var Wc=function getSourceLabelRotation(e,t){return e.getTextAngle(t,"source")};var Xc=function getTargetLabelRotation(e,t){return e.getTextAngle(t,"target")};var Yc=function getOpacity(e,t){return t.effectiveOpacity()};var Gc=function getTextOpacity(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};qc.drawCachedElement=function(e,t,a,n,i,o){var s=this;var l=s.data,u=l.eleTxrCache,v=l.lblTxrCache,c=l.slbTxrCache,d=l.tlbTxrCache;var h=t.boundingBox();var p=o===true?u.reasons.highQuality:null;if(h.w!==0&&h.h!==0&&t.visible()&&(!n||Er(h,n))){var g=t.isEdge();var y=t.element()._private.rscratch.badLine;s.drawElementUnderlay(e,t);s.drawCachedElementPortion(e,t,u,a,i,p,jc,Yc);g&&y||s.drawCachedElementPortion(e,t,v,a,i,p,Hc,Gc);if(g&&!y){s.drawCachedElementPortion(e,t,c,a,i,p,Wc,Gc);s.drawCachedElementPortion(e,t,d,a,i,p,Xc,Gc)}s.drawElementOverlay(e,t)}};qc.drawElements=function(e,t){var a=this;for(var n=0;n<t.length;n++){var i=t[n];a.drawElement(e,i)}};qc.drawCachedElements=function(e,t,a,n){var i=this;for(var o=0;o<t.length;o++){var s=t[o];i.drawCachedElement(e,s,a,n)}};qc.drawCachedNodes=function(e,t,a,n){var i=this;for(var o=0;o<t.length;o++){var s=t[o];s.isNode()&&i.drawCachedElement(e,s,a,n)}};qc.drawLayeredElements=function(e,t,a,n){var i=this;var o=i.data.lyrTxrCache.getLayers(t,a);if(o)for(var s=0;s<o.length;s++){var l=o[s];var u=l.bb;u.w!==0&&u.h!==0&&e.drawImage(l.canvas,u.x1,u.y1,u.w,u.h)}else i.drawCachedElements(e,t,a,n)};var Kc={};Kc.drawEdge=function(e,t,a){var n=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];var i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];var o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];var s=this;var l=t._private.rscratch;if((!o||t.visible())&&!l.badLine&&l.allpts!=null&&!isNaN(l.allpts[0])){var u;if(a){u=a;e.translate(-u.x1,-u.y1)}var v=o?t.pstyle("opacity").value:1;var c=o?t.pstyle("line-opacity").value:1;var d=t.pstyle("curve-style").value;var h=t.pstyle("line-style").value;var p=t.pstyle("width").pfValue;var g=t.pstyle("line-cap").value;var y=t.pstyle("line-outline-width").value;var m=t.pstyle("line-outline-color").value;var b=v*c;var x=v*c;var w=function drawLine(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;if(d==="straight-triangle"){s.eleStrokeStyle(e,t,a);s.drawEdgeTrianglePath(t,e,l.allpts)}else{e.lineWidth=p;e.lineCap=g;s.eleStrokeStyle(e,t,a);s.drawEdgePath(t,e,l.allpts,h);e.lineCap="butt"}};var E=function drawLineOutline(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;e.lineWidth=p+y;e.lineCap=g;if(y>0){s.colorStrokeStyle(e,m[0],m[1],m[2],a);if(d==="straight-triangle")s.drawEdgeTrianglePath(t,e,l.allpts);else{s.drawEdgePath(t,e,l.allpts,h);e.lineCap="butt"}}else e.lineCap="butt"};var T=function drawOverlay(){i&&s.drawEdgeOverlay(e,t)};var S=function drawUnderlay(){i&&s.drawEdgeUnderlay(e,t)};var k=function drawArrows(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x;s.drawArrowheads(e,t,a)};var P=function drawText(){s.drawElementText(e,t,null,n)};e.lineJoin="round";var _=t.pstyle("ghost").value==="yes";if(_){var D=t.pstyle("ghost-offset-x").pfValue;var I=t.pstyle("ghost-offset-y").pfValue;var M=t.pstyle("ghost-opacity").value;var R=b*M;e.translate(D,I);w(R);k(R);e.translate(-D,-I)}else E();S();w();k();T();P();a&&e.translate(u.x1,u.y1)}};var Uc=function drawEdgeOverlayUnderlay(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,a){if(a.visible()){var n=a.pstyle("".concat(e,"-opacity")).value;if(n!==0){var i=this;var o=i.usePaths();var s=a._private.rscratch;var l=a.pstyle("".concat(e,"-padding")).pfValue;var u=2*l;var v=a.pstyle("".concat(e,"-color")).value;t.lineWidth=u;s.edgeType!=="self"||o?t.lineCap="round":t.lineCap="butt";i.colorStrokeStyle(t,v[0],v[1],v[2],n);i.drawEdgePath(a,t,s.allpts,"solid")}}}};Kc.drawEdgeOverlay=Uc("overlay");Kc.drawEdgeUnderlay=Uc("underlay");Kc.drawEdgePath=function(e,t,a,n){var i=e._private.rscratch;var o=t;var s;var l=false;var u=this.usePaths();var v=e.pstyle("line-dash-pattern").pfValue;var c=e.pstyle("line-dash-offset").pfValue;if(u){var d=a.join("$");var h=i.pathCacheKey&&i.pathCacheKey===d;if(h){s=t=i.pathCache;l=true}else{s=t=new Path2D;i.pathCacheKey=d;i.pathCache=s}}if(o.setLineDash)switch(n){case"dotted":o.setLineDash([1,1]);break;case"dashed":o.setLineDash(v);o.lineDashOffset=c;break;case"solid":o.setLineDash([]);break}if(!l&&!i.badLine){t.beginPath&&t.beginPath();t.moveTo(a[0],a[1]);switch(i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var p=2;p+3<a.length;p+=4)t.quadraticCurveTo(a[p],a[p+1],a[p+2],a[p+3]);break;case"straight":case"haystack":for(var g=2;g+1<a.length;g+=2)t.lineTo(a[g],a[g+1]);break;case"segments":if(i.isRound){var y,m=_createForOfIteratorHelper(i.roundCorners);try{for(m.s();!(y=m.n()).done;){var b=y.value;drawPreparedRoundCorner(t,b)}}catch(e){m.e(e)}finally{m.f()}t.lineTo(a[a.length-2],a[a.length-1])}else for(var x=2;x+1<a.length;x+=2)t.lineTo(a[x],a[x+1]);break}}t=o;u?t.stroke(s):t.stroke();t.setLineDash&&t.setLineDash([])};Kc.drawEdgeTrianglePath=function(e,t,a){t.fillStyle=t.strokeStyle;var n=e.pstyle("width").pfValue;for(var i=0;i+1<a.length;i+=2){var o=[a[i+2]-a[i],a[i+3]-a[i+1]];var s=Math.sqrt(o[0]*o[0]+o[1]*o[1]);var l=[o[1]/s,-o[0]/s];var u=[l[0]*n/2,l[1]*n/2];t.beginPath();t.moveTo(a[i]-u[0],a[i+1]-u[1]);t.lineTo(a[i]+u[0],a[i+1]+u[1]);t.lineTo(a[i+2],a[i+3]);t.closePath();t.fill()}};Kc.drawArrowheads=function(e,t,a){var n=t._private.rscratch;var i=n.edgeType==="haystack";i||this.drawArrowhead(e,t,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,a);this.drawArrowhead(e,t,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,a);this.drawArrowhead(e,t,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,a);i||this.drawArrowhead(e,t,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,a)};Kc.drawArrowhead=function(e,t,a,n,i,o,s){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(o)||o==null)){var l=this;var u=t.pstyle(a+"-arrow-shape").value;if(u!=="none"){var v=t.pstyle(a+"-arrow-fill").value==="hollow"?"both":"filled";var c=t.pstyle(a+"-arrow-fill").value;var d=t.pstyle("width").pfValue;var h=t.pstyle(a+"-arrow-width");var p=h.value==="match-line"?d:h.pfValue;h.units==="%"&&(p*=d);var g=t.pstyle("opacity").value;s===void 0&&(s=g);var y=e.globalCompositeOperation;if(s!==1||c==="hollow"){e.globalCompositeOperation="destination-out";l.colorFillStyle(e,255,255,255,1);l.colorStrokeStyle(e,255,255,255,1);l.drawArrowShape(t,e,v,d,u,p,n,i,o);e.globalCompositeOperation=y}var m=t.pstyle(a+"-arrow-color").value;l.colorFillStyle(e,m[0],m[1],m[2],s);l.colorStrokeStyle(e,m[0],m[1],m[2],s);l.drawArrowShape(t,e,c,d,u,p,n,i,o)}}};Kc.drawArrowShape=function(e,t,a,n,i,o,s,l,u){var v=this;var c=this.usePaths()&&i!=="triangle-cross";var d=false;var h;var p=t;var g={x:s,y:l};var y=e.pstyle("arrow-scale").value;var m=this.getArrowWidth(n,y);var b=v.arrowShapes[i];if(c){var x=v.arrowPathCache=v.arrowPathCache||[];var w=Ke(i);var E=x[w];if(E!=null){h=t=E;d=true}else{h=t=new Path2D;x[w]=h}}if(!d){t.beginPath&&t.beginPath();c?b.draw(t,1,0,{x:0,y:0},1):b.draw(t,m,u,g,n);t.closePath&&t.closePath()}t=p;if(c){t.translate(s,l);t.rotate(u);t.scale(m,m)}a!=="filled"&&a!=="both"||(c?t.fill(h):t.fill());if(a==="hollow"||a==="both"){t.lineWidth=o/(c?m:1);t.lineJoin="miter";c?t.stroke(h):t.stroke()}if(c){t.scale(1/m,1/m);t.rotate(-u);t.translate(-s,-l)}};var Zc={};Zc.safeDrawImage=function(e,t,a,n,i,o,s,l,u,v){if(!(i<=0||o<=0||u<=0||v<=0))try{e.drawImage(t,a,n,i,o,s,l,u,v)}catch(e){st(e)}};Zc.drawInscribedImage=function(e,t,a,n,i){var o=this;var s=a.position();var l=s.x;var u=s.y;var v=a.cy().style();var c=v.getIndexedStyle.bind(v);var d=c(a,"background-fit","value",n);var h=c(a,"background-repeat","value",n);var p=a.width();var g=a.height();var y=a.padding()*2;var m=p+(c(a,"background-width-relative-to","value",n)==="inner"?0:y);var b=g+(c(a,"background-height-relative-to","value",n)==="inner"?0:y);var x=a._private.rscratch;var w=c(a,"background-clip","value",n);var E=w==="node";var T=c(a,"background-image-opacity","value",n)*i;var S=c(a,"background-image-smoothing","value",n);var k=a.pstyle("corner-radius").value;k!=="auto"&&(k=a.pstyle("corner-radius").pfValue);var P=t.width||t.cachedW;var _=t.height||t.cachedH;if(null==P||null==_){document.body.appendChild(t);P=t.cachedW=t.width||t.offsetWidth;_=t.cachedH=t.height||t.offsetHeight;document.body.removeChild(t)}var D=P;var I=_;c(a,"background-width","value",n)!=="auto"&&(D=c(a,"background-width","units",n)==="%"?c(a,"background-width","pfValue",n)*m:c(a,"background-width","pfValue",n));c(a,"background-height","value",n)!=="auto"&&(I=c(a,"background-height","units",n)==="%"?c(a,"background-height","pfValue",n)*b:c(a,"background-height","pfValue",n));if(D!==0&&I!==0){if(d==="contain"){var M=Math.min(m/D,b/I);D*=M;I*=M}else if(d==="cover"){M=Math.max(m/D,b/I);D*=M;I*=M}var R=l-m/2;var L=c(a,"background-position-x","units",n);var N=c(a,"background-position-x","pfValue",n);R+=L==="%"?(m-D)*N:N;var O=c(a,"background-offset-x","units",n);var z=c(a,"background-offset-x","pfValue",n);R+=O==="%"?(m-D)*z:z;var V=u-b/2;var q=c(a,"background-position-y","units",n);var j=c(a,"background-position-y","pfValue",n);V+=q==="%"?(b-I)*j:j;var H=c(a,"background-offset-y","units",n);var W=c(a,"background-offset-y","pfValue",n);V+=H==="%"?(b-I)*W:W;if(x.pathCache){R-=l;V-=u;l=0;u=0}var X=e.globalAlpha;e.globalAlpha=T;var Y=o.getImgSmoothing(e);var G=false;if(S==="no"&&Y){o.setImgSmoothing(e,false);G=true}else if(S==="yes"&&!Y){o.setImgSmoothing(e,true);G=true}if(h==="no-repeat"){if(E){e.save();if(x.pathCache)e.clip(x.pathCache);else{o.nodeShapes[o.getNodeShape(a)].draw(e,l,u,m,b,k,x);e.clip()}}o.safeDrawImage(e,t,0,0,P,_,R,V,D,I);E&&e.restore()}else{var K=e.createPattern(t,h);e.fillStyle=K;o.nodeShapes[o.getNodeShape(a)].draw(e,l,u,m,b,k,x);e.translate(R,V);e.fill();e.translate(-R,-V)}e.globalAlpha=X;G&&o.setImgSmoothing(e,Y)}};var $c={};$c.eleTextBiggerThanMin=function(e,t){if(!t){var a=e.cy().zoom();var n=this.getPixelRatio();var i=Math.ceil(nr(a*n));t=Math.pow(2,i)}var o=e.pstyle("font-size").pfValue*t;var s=e.pstyle("min-zoomed-font-size").pfValue;return!(o<s)};$c.drawElementText=function(e,t,a,n,i){var o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];var s=this;if(n==null){if(o&&!s.eleTextBiggerThanMin(t))return}else if(n===false)return;if(t.isNode()){var l=t.pstyle("label");if(!l||!l.value)return;var u=s.getLabelJustification(t);e.textAlign=u;e.textBaseline="bottom"}else{var v=t.element()._private.rscratch.badLine;var c=t.pstyle("label");var d=t.pstyle("source-label");var h=t.pstyle("target-label");if(v||(!c||!c.value)&&(!d||!d.value)&&(!h||!h.value))return;e.textAlign="center";e.textBaseline="bottom"}var p=!a;var g;if(a){g=a;e.translate(-g.x1,-g.y1)}if(i==null){s.drawText(e,t,null,p,o);if(t.isEdge()){s.drawText(e,t,"source",p,o);s.drawText(e,t,"target",p,o)}}else s.drawText(e,t,i,p,o);a&&e.translate(g.x1,g.y1)};$c.getFontCache=function(e){var t;this.fontCaches=this.fontCaches||[];for(var a=0;a<this.fontCaches.length;a++){t=this.fontCaches[a];if(t.context===e)return t}t={context:e};this.fontCaches.push(t);return t};$c.setupTextStyle=function(e,t){var a=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];var n=t.pstyle("font-style").strValue;var i=t.pstyle("font-size").pfValue+"px";var o=t.pstyle("font-family").strValue;var s=t.pstyle("font-weight").strValue;var l=a?t.effectiveOpacity()*t.pstyle("text-opacity").value:1;var u=t.pstyle("text-outline-opacity").value*l;var v=t.pstyle("color").value;var c=t.pstyle("text-outline-color").value;e.font=n+" "+s+" "+i+" "+o;e.lineJoin="round";this.colorFillStyle(e,v[0],v[1],v[2],l);this.colorStrokeStyle(e,c[0],c[1],c[2],u)};function roundRect(e,t,a,n,i){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5;var s=arguments.length>6?arguments[6]:void 0;e.beginPath();e.moveTo(t+o,a);e.lineTo(t+n-o,a);e.quadraticCurveTo(t+n,a,t+n,a+o);e.lineTo(t+n,a+i-o);e.quadraticCurveTo(t+n,a+i,t+n-o,a+i);e.lineTo(t+o,a+i);e.quadraticCurveTo(t,a+i,t,a+i-o);e.lineTo(t,a+o);e.quadraticCurveTo(t,a,t+o,a);e.closePath();s?e.stroke():e.fill()}$c.getTextAngle=function(e,t){var a;var n=e._private;var i=n.rscratch;var o=t?t+"-":"";var s=e.pstyle(o+"text-rotation");if(s.strValue==="autorotate"){var l=mt(i,"labelAngle",t);a=e.isEdge()?l:0}else a=s.strValue==="none"?0:s.pfValue;return a};$c.drawText=function(e,t,a){var n=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];var i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];var o=t._private;var s=o.rscratch;var l=i?t.effectiveOpacity():1;if(!i||l!==0&&t.pstyle("text-opacity").value!==0){a==="main"&&(a=null);var u=mt(s,"labelX",a);var v=mt(s,"labelY",a);var c,d;var h=this.getLabelText(t,a);if(h!=null&&h!==""&&!isNaN(u)&&!isNaN(v)){this.setupTextStyle(e,t,i);var p=a?a+"-":"";var g=mt(s,"labelWidth",a);var y=mt(s,"labelHeight",a);var m=t.pstyle(p+"text-margin-x").pfValue;var b=t.pstyle(p+"text-margin-y").pfValue;var x=t.isEdge();var w=t.pstyle("text-halign").value;var E=t.pstyle("text-valign").value;if(x){w="center";E="center"}u+=m;v+=b;var T;T=n?this.getTextAngle(t,a):0;if(T!==0){c=u;d=v;e.translate(c,d);e.rotate(T);u=0;v=0}switch(E){case"top":break;case"center":v+=y/2;break;case"bottom":v+=y;break}var S=t.pstyle("text-background-opacity").value;var k=t.pstyle("text-border-opacity").value;var P=t.pstyle("text-border-width").pfValue;var _=t.pstyle("text-background-padding").pfValue;var D=t.pstyle("text-background-shape").strValue;var I=D.indexOf("round")===0;var M=2;if(S>0||P>0&&k>0){var R=u-_;switch(w){case"left":R-=g;break;case"center":R-=g/2;break}var L=v-y-_;var N=g+2*_;var O=y+2*_;if(S>0){var z=e.fillStyle;var V=t.pstyle("text-background-color").value;e.fillStyle="rgba("+V[0]+","+V[1]+","+V[2]+","+S*l+")";I?roundRect(e,R,L,N,O,M):e.fillRect(R,L,N,O);e.fillStyle=z}if(P>0&&k>0){var q=e.strokeStyle;var j=e.lineWidth;var H=t.pstyle("text-border-color").value;var W=t.pstyle("text-border-style").value;e.strokeStyle="rgba("+H[0]+","+H[1]+","+H[2]+","+k*l+")";e.lineWidth=P;if(e.setLineDash)switch(W){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"double":e.lineWidth=P/4;e.setLineDash([]);break;case"solid":e.setLineDash([]);break}I?roundRect(e,R,L,N,O,M,"stroke"):e.strokeRect(R,L,N,O);if(W==="double"){var X=P/2;I?roundRect(e,R+X,L+X,N-X*2,O-X*2,M,"stroke"):e.strokeRect(R+X,L+X,N-X*2,O-X*2)}e.setLineDash&&e.setLineDash([]);e.lineWidth=j;e.strokeStyle=q}}var Y=2*t.pstyle("text-outline-width").pfValue;Y>0&&(e.lineWidth=Y);if(t.pstyle("text-wrap").value==="wrap"){var G=mt(s,"labelWrapCachedLines",a);var K=mt(s,"labelLineHeight",a);var U=g/2;var Z=this.getLabelJustification(t);Z==="auto"||(w==="left"?Z==="left"?u+=-g:Z==="center"&&(u+=-U):w==="center"?Z==="left"?u+=-U:Z==="right"&&(u+=U):w==="right"&&(Z==="center"?u+=U:Z==="right"&&(u+=g)));switch(E){case"top":v-=(G.length-1)*K;break;case"center":case"bottom":v-=(G.length-1)*K;break}for(var Q=0;Q<G.length;Q++){Y>0&&e.strokeText(G[Q],u,v);e.fillText(G[Q],u,v);v+=K}}else{Y>0&&e.strokeText(h,u,v);e.fillText(h,u,v)}if(T!==0){e.rotate(-T);e.translate(-c,-d)}}}};var Qc={};Qc.drawNode=function(e,t,a){var n=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];var i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];var o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];var s=this;var l,u;var v=t._private;var c=v.rscratch;var d=t.position();if(h(d.x)&&h(d.y)&&(!o||t.visible())){var p=o?t.effectiveOpacity():1;var g=s.usePaths();var y;var m=false;var b=t.padding();l=t.width()+2*b;u=t.height()+2*b;var x;if(a){x=a;e.translate(-x.x1,-x.y1)}var w=t.pstyle("background-image");var E=w.value;var T=new Array(E.length);var S=new Array(E.length);var k=0;for(var P=0;P<E.length;P++){var _=E[P];var D=T[P]=_!=null&&_!=="none";if(D){var I=t.cy().style().getIndexedStyle(t,"background-image-crossorigin","value",P);k++;S[P]=s.getCachedImage(_,I,(function(){v.backgroundTimestamp=Date.now();t.emitAndNotify("background")}))}}var M=t.pstyle("background-blacken").value;var R=t.pstyle("border-width").pfValue;var L=t.pstyle("background-opacity").value*p;var N=t.pstyle("border-color").value;var O=t.pstyle("border-style").value;var z=t.pstyle("border-join").value;var V=t.pstyle("border-cap").value;var q=t.pstyle("border-position").value;var j=t.pstyle("border-dash-pattern").pfValue;var H=t.pstyle("border-dash-offset").pfValue;var W=t.pstyle("border-opacity").value*p;var X=t.pstyle("outline-width").pfValue;var Y=t.pstyle("outline-color").value;var G=t.pstyle("outline-style").value;var K=t.pstyle("outline-opacity").value*p;var U=t.pstyle("outline-offset").value;var Z=t.pstyle("corner-radius").value;Z!=="auto"&&(Z=t.pstyle("corner-radius").pfValue);var Q=function setupShapeColor(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L;s.eleFillStyle(e,t,a)};var J=function setupBorderColor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:W;s.colorStrokeStyle(e,N[0],N[1],N[2],t)};var ee=function setupOutlineColor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:K;s.colorStrokeStyle(e,Y[0],Y[1],Y[2],t)};var te=function getPath(e,t,a,n){var i=s.nodePathCache=s.nodePathCache||[];var o=Ue(a==="polygon"?a+","+n.join(","):a,""+t,""+e,""+Z);var l=i[o];var u;var v=false;if(l!=null){u=l;v=true;c.pathCache=u}else{u=new Path2D;i[o]=c.pathCache=u}return{path:u,cacheHit:v}};var re=t.pstyle("shape").strValue;var ae=t.pstyle("shape-polygon-points").pfValue;if(g){e.translate(d.x,d.y);var ne=te(l,u,re,ae);y=ne.path;m=ne.cacheHit}var ie=function drawShape(){if(!m){var a=d;g&&(a={x:0,y:0});s.nodeShapes[s.getNodeShape(t)].draw(y||e,a.x,a.y,l,u,Z,c)}g?e.fill(y):e.fill()};var oe=function drawImages(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p;var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var i=v.backgrounding;var o=0;for(var l=0;l<S.length;l++){var u=t.cy().style().getIndexedStyle(t,"background-image-containment","value",l);if(n&&u==="over"||!n&&u==="inside")o++;else if(T[l]&&S[l].complete&&!S[l].error){o++;s.drawInscribedImage(e,S[l],t,l,a)}}v.backgrounding=!(o===k);i!==v.backgrounding&&t.updateStyle(false)};var se=function drawPie(){var a=arguments.length>0&&arguments[0]!==void 0&&arguments[0];var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p;if(s.hasPie(t)){s.drawPie(e,t,n);a&&(g||s.nodeShapes[s.getNodeShape(t)].draw(e,d.x,d.y,l,u,Z,c))}};var le=function darken(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p;var a=(M>0?M:-M)*t;var n=M>0?0:255;if(M!==0){s.colorFillStyle(e,n,n,n,a);g?e.fill(y):e.fill()}};var ue=function drawBorder(){if(R>0){e.lineWidth=R;e.lineCap=V;e.lineJoin=z;if(e.setLineDash)switch(O){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash(j);e.lineDashOffset=H;break;case"solid":case"double":e.setLineDash([]);break}if(q!=="center"){e.save();e.lineWidth*=2;if(q==="inside")g?e.clip(y):e.clip();else{var t=new Path2D;t.rect(-l/2-R,-u/2-R,l+2*R,u+2*R);t.addPath(y);e.clip(t,"evenodd")}g?e.stroke(y):e.stroke();e.restore()}else g?e.stroke(y):e.stroke();if(O==="double"){e.lineWidth=R/3;var a=e.globalCompositeOperation;e.globalCompositeOperation="destination-out";g?e.stroke(y):e.stroke();e.globalCompositeOperation=a}e.setLineDash&&e.setLineDash([])}};var ve=function drawOutline(){if(X>0){e.lineWidth=X;e.lineCap="butt";if(e.setLineDash)switch(G){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"solid":case"double":e.setLineDash([]);break}var a=d;g&&(a={x:0,y:0});var n=s.getNodeShape(t);var i=R;q==="inside"&&(i=0);q==="outside"&&(i*=2);var o=(l+i+(X+U))/l;var v=(u+i+(X+U))/u;var c=l*o;var h=u*v;var p=s.nodeShapes[n].points;var y;if(g){var m=te(c,h,n,p);y=m.path}if(n==="ellipse")s.drawEllipsePath(y||e,a.x,a.y,c,h);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(n)){var b=0;var x=0;var w=0;if(n==="round-diamond")b=(i+U+X)*1.4;else if(n==="round-heptagon"){b=(i+U+X)*1.075;w=-(i/2+U+X)/35}else if(n==="round-hexagon")b=(i+U+X)*1.12;else if(n==="round-pentagon"){b=(i+U+X)*1.13;w=-(i/2+U+X)/15}else if(n==="round-tag"){b=(i+U+X)*1.12;x=(i/2+X+U)*.07}else if(n==="round-triangle"){b=(i+U+X)*(Math.PI/2);w=-(i+U/2+X)/Math.PI}if(b!==0){o=(l+b)/l;c=l*o;if(!["round-hexagon","round-tag"].includes(n)){v=(u+b)/u;h=u*v}}Z=Z==="auto"?Zr(c,h):Z;var E=c/2;var T=h/2;var S=Z+(i+X+U)/2;var k=new Array(p.length/2);var P=new Array(p.length/2);for(var _=0;_<p.length/2;_++)k[_]={x:a.x+x+E*p[_*2],y:a.y+w+T*p[_*2+1]};var D,I,M,L,N=k.length;I=k[N-1];for(D=0;D<N;D++){M=k[D%N];L=k[(D+1)%N];P[D]=getRoundCorner(I,M,L,S);I=M;M=L}s.drawRoundPolygonPath(y||e,a.x+x,a.y+w,l*o,u*v,p,P)}else if(["roundrectangle","round-rectangle"].includes(n)){Z=Z==="auto"?Ur(c,h):Z;s.drawRoundRectanglePath(y||e,a.x,a.y,c,h,Z+(i+X+U)/2)}else if(["cutrectangle","cut-rectangle"].includes(n)){Z=Z==="auto"?$r():Z;s.drawCutRectanglePath(y||e,a.x,a.y,c,h,null,Z+(i+X+U)/4)}else if(["bottomroundrectangle","bottom-round-rectangle"].includes(n)){Z=Z==="auto"?Ur(c,h):Z;s.drawBottomRoundRectanglePath(y||e,a.x,a.y,c,h,Z+(i+X+U)/2)}else if(n==="barrel")s.drawBarrelPath(y||e,a.x,a.y,c,h);else if(n.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(n)){var O=(i+X+U)/l;p=Nr(Or(p,O));s.drawPolygonPath(y||e,a.x,a.y,l,u,p)}else{var z=(i+X+U)/l;p=Nr(Or(p,-z));s.drawPolygonPath(y||e,a.x,a.y,l,u,p)}g?e.stroke(y):e.stroke();if(G==="double"){e.lineWidth=i/3;var V=e.globalCompositeOperation;e.globalCompositeOperation="destination-out";g?e.stroke(y):e.stroke();e.globalCompositeOperation=V}e.setLineDash&&e.setLineDash([])}};var ce=function drawOverlay(){i&&s.drawNodeOverlay(e,t,d,l,u)};var de=function drawUnderlay(){i&&s.drawNodeUnderlay(e,t,d,l,u)};var he=function drawText(){s.drawElementText(e,t,null,n)};var fe=t.pstyle("ghost").value==="yes";if(fe){var pe=t.pstyle("ghost-offset-x").pfValue;var ge=t.pstyle("ghost-offset-y").pfValue;var ye=t.pstyle("ghost-opacity").value;var me=ye*p;e.translate(pe,ge);ee();ve();Q(ye*L);ie();oe(me,true);J(ye*W);ue();se(M!==0||R!==0);oe(me,false);le(me);e.translate(-pe,-ge)}g&&e.translate(-d.x,-d.y);de();g&&e.translate(d.x,d.y);ee();ve();Q();ie();oe(p,true);J();ue();se(M!==0||R!==0);oe(p,false);le();g&&e.translate(-d.x,-d.y);he();ce();a&&e.translate(x.x1,x.y1)}};var Jc=function drawNodeOverlayUnderlay(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,a,n,i,o){var s=this;if(a.visible()){var l=a.pstyle("".concat(e,"-padding")).pfValue;var u=a.pstyle("".concat(e,"-opacity")).value;var v=a.pstyle("".concat(e,"-color")).value;var c=a.pstyle("".concat(e,"-shape")).value;var d=a.pstyle("".concat(e,"-corner-radius")).value;if(u>0){n=n||a.position();if(i==null||o==null){var h=a.padding();i=a.width()+2*h;o=a.height()+2*h}s.colorFillStyle(t,v[0],v[1],v[2],u);s.nodeShapes[c].draw(t,n.x,n.y,i+l*2,o+l*2,d);t.fill()}}}};Qc.drawNodeOverlay=Jc("overlay");Qc.drawNodeUnderlay=Jc("underlay");Qc.hasPie=function(e){e=e[0];return e._private.hasPie};Qc.drawPie=function(e,t,a,n){t=t[0];n=n||t.position();var i=t.cy().style();var o=t.pstyle("pie-size");var s=n.x;var l=n.y;var u=t.width();var v=t.height();var c=Math.min(u,v)/2;var d=0;var h=this.usePaths();if(h){s=0;l=0}o.units==="%"?c*=o.pfValue:o.pfValue!==void 0&&(c=o.pfValue/2);for(var p=1;p<=i.pieBackgroundN;p++){var g=t.pstyle("pie-"+p+"-background-size").value;var y=t.pstyle("pie-"+p+"-background-color").value;var m=t.pstyle("pie-"+p+"-background-opacity").value*a;var b=g/100;b+d>1&&(b=1-d);var x=1.5*Math.PI+2*Math.PI*d;var w=2*Math.PI*b;var E=x+w;if(!(g===0||d>=1||d+b>1)){e.beginPath();e.moveTo(s,l);e.arc(s,l,c,x,E);e.closePath();this.colorFillStyle(e,y[0],y[1],y[2],m);e.fill();d+=b}}};var ed={};var td=100;ed.getPixelRatio=function(){var e=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var t=this.cy.window();var a=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(t.devicePixelRatio||1)/a};ed.paintCache=function(e){var t=this.paintCaches=this.paintCaches||[];var a=true;var n;for(var i=0;i<t.length;i++){n=t[i];if(n.context===e){a=false;break}}if(a){n={context:e};t.push(n)}return n};ed.createGradientStyleFor=function(e,t,a,n,i){var o;var s=this.usePaths();var l=a.pstyle(t+"-gradient-stop-colors").value,u=a.pstyle(t+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(a.isEdge()){var v=a.sourceEndpoint(),c=a.targetEndpoint(),d=a.midpoint();var h=or(v,d);var p=or(c,d);o=e.createRadialGradient(d.x,d.y,0,d.x,d.y,Math.max(h,p))}else{var g=s?{x:0,y:0}:a.position(),y=a.paddedWidth(),m=a.paddedHeight();o=e.createRadialGradient(g.x,g.y,0,g.x,g.y,Math.max(y,m))}else if(a.isEdge()){var b=a.sourceEndpoint(),x=a.targetEndpoint();o=e.createLinearGradient(b.x,b.y,x.x,x.y)}else{var w=s?{x:0,y:0}:a.position(),E=a.paddedWidth(),T=a.paddedHeight(),S=E/2,k=T/2;var P=a.pstyle("background-gradient-direction").value;switch(P){case"to-bottom":o=e.createLinearGradient(w.x,w.y-k,w.x,w.y+k);break;case"to-top":o=e.createLinearGradient(w.x,w.y+k,w.x,w.y-k);break;case"to-left":o=e.createLinearGradient(w.x+S,w.y,w.x-S,w.y);break;case"to-right":o=e.createLinearGradient(w.x-S,w.y,w.x+S,w.y);break;case"to-bottom-right":case"to-right-bottom":o=e.createLinearGradient(w.x-S,w.y-k,w.x+S,w.y+k);break;case"to-top-right":case"to-right-top":o=e.createLinearGradient(w.x-S,w.y+k,w.x+S,w.y-k);break;case"to-bottom-left":case"to-left-bottom":o=e.createLinearGradient(w.x+S,w.y-k,w.x-S,w.y+k);break;case"to-top-left":case"to-left-top":o=e.createLinearGradient(w.x+S,w.y+k,w.x-S,w.y-k);break}}if(!o)return null;var _=u.length===l.length;var D=l.length;for(var I=0;I<D;I++)o.addColorStop(_?u[I]:I/(D-1),"rgba("+l[I][0]+","+l[I][1]+","+l[I][2]+","+i+")");return o};ed.gradientFillStyle=function(e,t,a,n){var i=this.createGradientStyleFor(e,"background",t,a,n);if(!i)return null;e.fillStyle=i};ed.colorFillStyle=function(e,t,a,n,i){e.fillStyle="rgba("+t+","+a+","+n+","+i+")"};ed.eleFillStyle=function(e,t,a){var n=t.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(e,t,n,a);else{var i=t.pstyle("background-color").value;this.colorFillStyle(e,i[0],i[1],i[2],a)}};ed.gradientStrokeStyle=function(e,t,a,n){var i=this.createGradientStyleFor(e,"line",t,a,n);if(!i)return null;e.strokeStyle=i};ed.colorStrokeStyle=function(e,t,a,n,i){e.strokeStyle="rgba("+t+","+a+","+n+","+i+")"};ed.eleStrokeStyle=function(e,t,a){var n=t.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(e,t,n,a);else{var i=t.pstyle("line-color").value;this.colorStrokeStyle(e,i[0],i[1],i[2],a)}};ed.matchCanvasSize=function(e){var t=this;var a=t.data;var n=t.findContainerClientCoords();var i=n[2];var o=n[3];var s=t.getPixelRatio();var l=t.motionBlurPxRatio;e!==t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]&&e!==t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG]||(s=l);var u=i*s;var v=o*s;var c;if(u!==t.canvasWidth||v!==t.canvasHeight){t.fontCaches=null;var d=a.canvasContainer;d.style.width=i+"px";d.style.height=o+"px";for(var h=0;h<t.CANVAS_LAYERS;h++){c=a.canvases[h];c.width=u;c.height=v;c.style.width=i+"px";c.style.height=o+"px"}for(h=0;h<t.BUFFER_COUNT;h++){c=a.bufferCanvases[h];c.width=u;c.height=v;c.style.width=i+"px";c.style.height=o+"px"}t.textureMult=1;if(s<=1){c=a.bufferCanvases[t.TEXTURE_BUFFER];t.textureMult=2;c.width=u*t.textureMult;c.height=v*t.textureMult}t.canvasWidth=u;t.canvasHeight=v;t.pixelRatio=s}};ed.renderTo=function(e,t,a,n){this.render({forcedContext:e,forcedZoom:t,forcedPan:a,drawAllLayers:true,forcedPxRatio:n})};ed.clearCanvas=function(){var e=this;var t=e.data;function clear(t){t.clearRect(0,0,e.canvasWidth,e.canvasHeight)}clear(t.contexts[e.NODE]);clear(t.contexts[e.DRAG])};ed.render=function(e){var t=this;e=e||ht();var a=t.cy;var n=e.forcedContext;var i=e.drawAllLayers;var o=e.drawOnlyNodeLayer;var s=e.forcedZoom;var l=e.forcedPan;var u=e.forcedPxRatio===void 0?this.getPixelRatio():e.forcedPxRatio;var v=t.data;var c=v.canvasNeedsRedraw;var d=t.textureOnViewport&&!n&&(t.pinching||t.hoverData.dragging||t.swipePanning||t.data.wheelZooming);var h=e.motionBlur!==void 0?e.motionBlur:t.motionBlur;var p=t.motionBlurPxRatio;var g=a.hasCompoundNodes();var y=t.hoverData.draggingEles;var m=!(!t.hoverData.selecting&&!t.touchData.selecting);h=h&&!n&&t.motionBlurEnabled&&!m;var b=h;if(!n){if(t.prevPxRatio!==u){t.invalidateContainerClientCoordsCache();t.matchCanvasSize(t.container);t.redrawHint("eles",true);t.redrawHint("drag",true)}t.prevPxRatio=u}!n&&t.motionBlurTimeout&&clearTimeout(t.motionBlurTimeout);if(h){t.mbFrames==null&&(t.mbFrames=0);t.mbFrames++;t.mbFrames<3&&(b=false);t.mbFrames>t.minMbLowQualFrames&&(t.motionBlurPxRatio=t.mbPxRBlurry)}t.clearingMotionBlur&&(t.motionBlurPxRatio=1);if(t.textureDrawLastFrame&&!d){c[t.NODE]=true;c[t.SELECT_BOX]=true}var x=a.style();var w=a.zoom();var E=s!==void 0?s:w;var T=a.pan();var S={x:T.x,y:T.y};var k={zoom:w,pan:{x:T.x,y:T.y}};var P=t.prevViewport;var _=P===void 0||k.zoom!==P.zoom||k.pan.x!==P.pan.x||k.pan.y!==P.pan.y;_||y&&!g||(t.motionBlurPxRatio=1);l&&(S=l);E*=u;S.x*=u;S.y*=u;var D=t.getCachedZSortedEles();function mbclear(e,a,n,i,o){var s=e.globalCompositeOperation;e.globalCompositeOperation="destination-out";t.colorFillStyle(e,255,255,255,t.motionBlurTransparency);e.fillRect(a,n,i,o);e.globalCompositeOperation=s}function setContextTransform(e,a){var o,u,c,d;if(t.clearingMotionBlur||e!==v.bufferContexts[t.MOTIONBLUR_BUFFER_NODE]&&e!==v.bufferContexts[t.MOTIONBLUR_BUFFER_DRAG]){o=S;u=E;c=t.canvasWidth;d=t.canvasHeight}else{o={x:T.x*p,y:T.y*p};u=w*p;c=t.canvasWidth*p;d=t.canvasHeight*p}e.setTransform(1,0,0,1,0,0);a==="motionBlur"?mbclear(e,0,0,c,d):n||a!==void 0&&!a||e.clearRect(0,0,c,d);if(!i){e.translate(o.x,o.y);e.scale(u,u)}l&&e.translate(l.x,l.y);s&&e.scale(s,s)}d||(t.textureDrawLastFrame=false);if(d){t.textureDrawLastFrame=true;if(!t.textureCache){t.textureCache={};t.textureCache.bb=a.mutableElements().boundingBox();t.textureCache.texture=t.data.bufferCanvases[t.TEXTURE_BUFFER];var I=t.data.bufferContexts[t.TEXTURE_BUFFER];I.setTransform(1,0,0,1,0,0);I.clearRect(0,0,t.canvasWidth*t.textureMult,t.canvasHeight*t.textureMult);t.render({forcedContext:I,drawOnlyNodeLayer:true,forcedPxRatio:u*t.textureMult});k=t.textureCache.viewport={zoom:a.zoom(),pan:a.pan(),width:t.canvasWidth,height:t.canvasHeight};k.mpan={x:(0-k.pan.x)/k.zoom,y:(0-k.pan.y)/k.zoom}}c[t.DRAG]=false;c[t.NODE]=false;var M=v.contexts[t.NODE];var R=t.textureCache.texture;k=t.textureCache.viewport;M.setTransform(1,0,0,1,0,0);h?mbclear(M,0,0,k.width,k.height):M.clearRect(0,0,k.width,k.height);var L=x.core("outside-texture-bg-color").value;var N=x.core("outside-texture-bg-opacity").value;t.colorFillStyle(M,L[0],L[1],L[2],N);M.fillRect(0,0,k.width,k.height);w=a.zoom();setContextTransform(M,false);M.clearRect(k.mpan.x,k.mpan.y,k.width/k.zoom/u,k.height/k.zoom/u);M.drawImage(R,k.mpan.x,k.mpan.y,k.width/k.zoom/u,k.height/k.zoom/u)}else t.textureOnViewport&&!n&&(t.textureCache=null);var O=a.extent();var z=t.pinching||t.hoverData.dragging||t.swipePanning||t.data.wheelZooming||t.hoverData.draggingEles||t.cy.animated();var V=t.hideEdgesOnViewport&&z;var q=[];q[t.NODE]=!c[t.NODE]&&h&&!t.clearedForMotionBlur[t.NODE]||t.clearingMotionBlur;q[t.NODE]&&(t.clearedForMotionBlur[t.NODE]=true);q[t.DRAG]=!c[t.DRAG]&&h&&!t.clearedForMotionBlur[t.DRAG]||t.clearingMotionBlur;q[t.DRAG]&&(t.clearedForMotionBlur[t.DRAG]=true);if(c[t.NODE]||i||o||q[t.NODE]){var j=h&&!q[t.NODE]&&p!==1;M=n||(j?t.data.bufferContexts[t.MOTIONBLUR_BUFFER_NODE]:v.contexts[t.NODE]);var H=h&&!j?"motionBlur":void 0;setContextTransform(M,H);V?t.drawCachedNodes(M,D.nondrag,u,O):t.drawLayeredElements(M,D.nondrag,u,O);t.debug&&t.drawDebugPoints(M,D.nondrag);i||h||(c[t.NODE]=false)}if(!o&&(c[t.DRAG]||i||q[t.DRAG])){j=h&&!q[t.DRAG]&&p!==1;M=n||(j?t.data.bufferContexts[t.MOTIONBLUR_BUFFER_DRAG]:v.contexts[t.DRAG]);setContextTransform(M,h&&!j?"motionBlur":void 0);V?t.drawCachedNodes(M,D.drag,u,O):t.drawCachedElements(M,D.drag,u,O);t.debug&&t.drawDebugPoints(M,D.drag);i||h||(c[t.DRAG]=false)}this.drawSelectionRectangle(e,setContextTransform);if(h&&p!==1){var W=v.contexts[t.NODE];var X=t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE];var Y=v.contexts[t.DRAG];var G=t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG];var K=function drawMotionBlur(e,a,n){e.setTransform(1,0,0,1,0,0);n||!b?e.clearRect(0,0,t.canvasWidth,t.canvasHeight):mbclear(e,0,0,t.canvasWidth,t.canvasHeight);var i=p;e.drawImage(a,0,0,t.canvasWidth*i,t.canvasHeight*i,0,0,t.canvasWidth,t.canvasHeight)};if(c[t.NODE]||q[t.NODE]){K(W,X,q[t.NODE]);c[t.NODE]=false}if(c[t.DRAG]||q[t.DRAG]){K(Y,G,q[t.DRAG]);c[t.DRAG]=false}}t.prevViewport=k;if(t.clearingMotionBlur){t.clearingMotionBlur=false;t.motionBlurCleared=true;t.motionBlur=true}h&&(t.motionBlurTimeout=setTimeout((function(){t.motionBlurTimeout=null;t.clearedForMotionBlur[t.NODE]=false;t.clearedForMotionBlur[t.DRAG]=false;t.motionBlur=false;t.clearingMotionBlur=!d;t.mbFrames=0;c[t.NODE]=true;c[t.DRAG]=true;t.redraw()}),td));n||a.emit("render")};var rd;ed.drawSelectionRectangle=function(e,t){var a=this;var n=a.cy;var i=a.data;var o=n.style();var s=e.drawOnlyNodeLayer;var l=e.drawAllLayers;var u=i.canvasNeedsRedraw;var v=e.forcedContext;if(a.showFps||!s&&u[a.SELECT_BOX]&&!l){var c=v||i.contexts[a.SELECT_BOX];t(c);if(a.selection[4]==1&&(a.hoverData.selecting||a.touchData.selecting)){var d=a.cy.zoom();var h=o.core("selection-box-border-width").value/d;c.lineWidth=h;c.fillStyle="rgba("+o.core("selection-box-color").value[0]+","+o.core("selection-box-color").value[1]+","+o.core("selection-box-color").value[2]+","+o.core("selection-box-opacity").value+")";c.fillRect(a.selection[0],a.selection[1],a.selection[2]-a.selection[0],a.selection[3]-a.selection[1]);if(h>0){c.strokeStyle="rgba("+o.core("selection-box-border-color").value[0]+","+o.core("selection-box-border-color").value[1]+","+o.core("selection-box-border-color").value[2]+","+o.core("selection-box-opacity").value+")";c.strokeRect(a.selection[0],a.selection[1],a.selection[2]-a.selection[0],a.selection[3]-a.selection[1])}}if(i.bgActivePosistion&&!a.hoverData.selecting){d=a.cy.zoom();var p=i.bgActivePosistion;c.fillStyle="rgba("+o.core("active-bg-color").value[0]+","+o.core("active-bg-color").value[1]+","+o.core("active-bg-color").value[2]+","+o.core("active-bg-opacity").value+")";c.beginPath();c.arc(p.x,p.y,o.core("active-bg-size").pfValue/d,0,2*Math.PI);c.fill()}var g=a.lastRedrawTime;if(a.showFps&&g){g=Math.round(g);var y=Math.round(1e3/g);var m="1 frame = "+g+" ms = "+y+" fps";c.setTransform(1,0,0,1,0,0);c.fillStyle="rgba(255, 0, 0, 0.75)";c.strokeStyle="rgba(255, 0, 0, 0.75)";c.font="30px Arial";if(!rd){var b=c.measureText(m);rd=b.actualBoundingBoxAscent}c.fillText(m,0,rd);var x=60;c.strokeRect(0,rd+10,250,20);c.fillRect(0,rd+10,250*Math.min(y/x,1),20)}l||(u[a.SELECT_BOX]=false)}};function compileShader(e,t,a){var n=e.createShader(t);e.shaderSource(n,a);e.compileShader(n);if(!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(n));return n}function createProgram(e,t,a){var n=compileShader(e,e.VERTEX_SHADER,t);var i=compileShader(e,e.FRAGMENT_SHADER,a);var o=e.createProgram();e.attachShader(o,n);e.attachShader(o,i);e.linkProgram(o);if(!e.getProgramParameter(o,e.LINK_STATUS))throw new Error("Could not initialize shaders");return o}function createTextureCanvas(e,t,a){a===void 0&&(a=t);var n=e.makeOffscreenCanvas(t,a);var i=n.context=n.getContext("2d");n.clear=function(){return i.clearRect(0,0,n.width,n.height)};n.clear();return n}function getEffectivePanZoom(e){var t=e.pixelRatio;var a=e.cy.zoom();var n=e.cy.pan();return{zoom:a*t,pan:{x:n.x*t,y:n.y*t}}}function modelToRenderedPosition(e,t,a,n,i){var o=n*a+t.x;var s=i*a+t.y;s=Math.round(e.canvasHeight-s);return[o,s]}function toWebGLColor(e,t,a){var n=e[0]/255;var i=e[1]/255;var o=e[2]/255;var s=t;var l=a||new Array(4);l[0]=n*s;l[1]=i*s;l[2]=o*s;l[3]=s;return l}function indexToVec4(e,t){var a=t||new Array(4);a[0]=(e&255)/255;a[1]=(e>>8&255)/255;a[2]=(e>>16&255)/255;a[3]=(e>>24&255)/255;return a}function vec4ToIndex(e){return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)}function createTexture(e,t){var a=e.createTexture();a.buffer=function(t){e.bindTexture(e.TEXTURE_2D,a);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);e.generateMipmap(e.TEXTURE_2D);e.bindTexture(e.TEXTURE_2D,null)};a.deleteTexture=function(){e.deleteTexture(a)};return a}function getTypeInfo(e,t){switch(t){case"float":return[1,e.FLOAT,4];case"vec2":return[2,e.FLOAT,4];case"vec3":return[3,e.FLOAT,4];case"vec4":return[4,e.FLOAT,4];case"int":return[1,e.INT,4];case"ivec2":return[2,e.INT,4]}}function createTypedArray(e,t,a){switch(t){case e.FLOAT:return new Float32Array(a);case e.INT:return new Int32Array(a)}}function createTypedArrayView(e,t,a,n,i,o){switch(t){case e.FLOAT:return new Float32Array(a.buffer,o*n,i);case e.INT:return new Int32Array(a.buffer,o*n,i)}}
/** @param {WebGLRenderingContext} gl */function createBufferStaticDraw(e,t,a,n){var i=getTypeInfo(e,t),o=_slicedToArray(i,2),s=o[0],l=o[1];var u=createTypedArray(e,l,n);var v=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,v);e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW);l===e.FLOAT?e.vertexAttribPointer(a,s,l,false,0,0):l===e.INT&&e.vertexAttribIPointer(a,s,l,0,0);e.enableVertexAttribArray(a);e.bindBuffer(e.ARRAY_BUFFER,null);return v}
/** 
 * Creates a float buffer with gl.DYNAMIC_DRAW.
 * The returned buffer object contains functions to easily set instance data and buffer the data before a draw call.
 * @param {WebGLRenderingContext} gl 
 */function createBufferDynamicDraw(e,t,a,n){var i=getTypeInfo(e,a),o=_slicedToArray(i,3),s=o[0],l=o[1],u=o[2];var v=createTypedArray(e,l,t*s);var c=s*u;var d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d);e.bufferData(e.ARRAY_BUFFER,t*c,e.DYNAMIC_DRAW);e.enableVertexAttribArray(n);l===e.FLOAT?e.vertexAttribPointer(n,s,l,false,c,0):l===e.INT&&e.vertexAttribIPointer(n,s,l,c,0);e.vertexAttribDivisor(n,1);e.bindBuffer(e.ARRAY_BUFFER,null);var h=new Array(t);for(var p=0;p<t;p++)h[p]=createTypedArrayView(e,l,v,c,s,p);d.dataArray=v;d.stride=c;d.size=s;d.getView=function(e){return h[e]};d.setPoint=function(e,t,a){var n=h[e];n[0]=t;n[1]=a};d.bufferSubData=function(t){e.bindBuffer(e.ARRAY_BUFFER,d);t?e.bufferSubData(e.ARRAY_BUFFER,0,v,0,t*s):e.bufferSubData(e.ARRAY_BUFFER,0,v)};return d}
/** 
 * Creates a buffer of 3x3 matrix data for use as attribute data.
 * @param {WebGLRenderingContext} gl 
 */function create3x3MatrixBufferDynamicDraw(e,t,a){var n=9;var i=new Float32Array(t*n);var o=new Array(t);for(var s=0;s<t;s++){var l=s*n*4;o[s]=new Float32Array(i.buffer,l,n)}var u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u);e.bufferData(e.ARRAY_BUFFER,i.byteLength,e.DYNAMIC_DRAW);for(var v=0;v<3;v++){var c=a+v;e.enableVertexAttribArray(c);e.vertexAttribPointer(c,3,e.FLOAT,false,36,v*12);e.vertexAttribDivisor(c,1)}e.bindBuffer(e.ARRAY_BUFFER,null);u.getMatrixView=function(e){return o[e]};u.setData=function(e,t){o[t].set(e,0)};u.bufferSubData=function(){e.bindBuffer(e.ARRAY_BUFFER,u);e.bufferSubData(e.ARRAY_BUFFER,0,i)};return u}
/** 
 * Creates a Frame Buffer to use for offscreen rendering.
 * @param {WebGLRenderingContext} gl 
 */function createPickingFrameBuffer(e){var t=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);var a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0);e.bindFramebuffer(e.FRAMEBUFFER,null);t.setFramebufferAttachmentSizes=function(t,n){e.bindTexture(e.TEXTURE_2D,a);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null)};return t}var ad=typeof Float32Array!=="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){var e=0,t=arguments.length;while(t--)e+=arguments[t]*arguments[t];return Math.sqrt(e)})
/**
 * Creates a new identity mat3
 *
 * @returns {mat3} a new 3x3 matrix
 */;function create(){var e=new ad(9);if(ad!=Float32Array){e[1]=0;e[2]=0;e[3]=0;e[5]=0;e[6]=0;e[7]=0}e[0]=1;e[4]=1;e[8]=1;return e}
/**
 * Set a mat3 to the identity matrix
 *
 * @param {mat3} out the receiving matrix
 * @returns {mat3} out
 */function identity(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}
/**
 * Multiplies two mat3's
 *
 * @param {mat3} out the receiving matrix
 * @param {ReadonlyMat3} a the first operand
 * @param {ReadonlyMat3} b the second operand
 * @returns {mat3} out
 */function multiply(e,t,a){var n=t[0],i=t[1],o=t[2];var s=t[3],l=t[4],u=t[5];var v=t[6],c=t[7],d=t[8];var h=a[0],p=a[1],g=a[2];var y=a[3],m=a[4],b=a[5];var x=a[6],w=a[7],E=a[8];e[0]=h*n+p*s+g*v;e[1]=h*i+p*l+g*c;e[2]=h*o+p*u+g*d;e[3]=y*n+m*s+b*v;e[4]=y*i+m*l+b*c;e[5]=y*o+m*u+b*d;e[6]=x*n+w*s+E*v;e[7]=x*i+w*l+E*c;e[8]=x*o+w*u+E*d;return e}
/**
 * Translate a mat3 by the given vector
 *
 * @param {mat3} out the receiving matrix
 * @param {ReadonlyMat3} a the matrix to translate
 * @param {ReadonlyVec2} v vector to translate by
 * @returns {mat3} out
 */function translate(e,t,a){var n=t[0],i=t[1],o=t[2],s=t[3],l=t[4],u=t[5],v=t[6],c=t[7],d=t[8],h=a[0],p=a[1];e[0]=n;e[1]=i;e[2]=o;e[3]=s;e[4]=l;e[5]=u;e[6]=h*n+p*s+v;e[7]=h*i+p*l+c;e[8]=h*o+p*u+d;return e}
/**
 * Rotates a mat3 by the given angle
 *
 * @param {mat3} out the receiving matrix
 * @param {ReadonlyMat3} a the matrix to rotate
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat3} out
 */function rotate(e,t,a){var n=t[0],i=t[1],o=t[2],s=t[3],l=t[4],u=t[5],v=t[6],c=t[7],d=t[8],h=Math.sin(a),p=Math.cos(a);e[0]=p*n+h*s;e[1]=p*i+h*l;e[2]=p*o+h*u;e[3]=p*s-h*n;e[4]=p*l-h*i;e[5]=p*u-h*o;e[6]=v;e[7]=c;e[8]=d;return e}
/**
 * Scales the mat3 by the dimensions in the given vec2
 *
 * @param {mat3} out the receiving matrix
 * @param {ReadonlyMat3} a the matrix to rotate
 * @param {ReadonlyVec2} v the vec2 to scale the matrix by
 * @returns {mat3} out
 **/function scale(e,t,a){var n=a[0],i=a[1];e[0]=n*t[0];e[1]=n*t[1];e[2]=n*t[2];e[3]=i*t[3];e[4]=i*t[4];e[5]=i*t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];return e}
/**
 * Generates a 2D projection matrix with the given bounds
 *
 * @param {mat3} out mat3 frustum matrix will be written into
 * @param {number} width Width of your gl context
 * @param {number} height Height of gl context
 * @returns {mat3} out
 */function projection(e,t,a){e[0]=2/t;e[1]=0;e[2]=0;e[3]=0;e[4]=-2/a;e[5]=0;e[6]=-1;e[7]=1;e[8]=1;return e}var nd={SCREEN:{name:"screen",screen:true},PICKING:{name:"picking",picking:true}};var od=ft({texRows:24});var sd=ft({collection:"default",getKey:null,drawElement:null,getBoundingBox:null,getRotation:null,getRotationPoint:null,getRotationOffset:null,isVisible:function isVisible(){return true},getPadding:0});var ld=function(){function Atlas(e,t,a,n){_classCallCheck(this,Atlas);this.debugID=Math.floor(Math.random()*1e4);this.r=e;this.texSize=t;this.texRows=a;this.texHeight=Math.floor(t/a);this.enableWrapping=true;this.locked=false;this.texture=null;this.needsBuffer=true;this.freePointer={x:0,row:0};this.keyToLocation=new Map;this.canvas=n(e,t,t);this.scratch=n(e,t,this.texHeight,"scratch")}return _createClass(Atlas,[{key:"lock",value:function lock(){this.locked=true}},{key:"getKeys",value:function getKeys(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function getScale(e){var t=e.w,a=e.h;var n=this.texHeight,i=this.texSize;var o=n/a;var s=t*o;var l=a*o;if(s>i){o=i/t;s=t*o;l=a*o}return{scale:o,texW:s,texH:l}}},{key:"draw",value:function draw(e,t,a){var n=this;if(this.locked)throw new Error("can't draw, atlas is locked");var i=this.texSize,o=this.texRows,s=this.texHeight;var l=this.getScale(t),u=l.scale,v=l.texW,c=l.texH;var d=[null,null];var h=function drawAt(e,n){if(a&&n){var i=n.context;var o=e.x,l=e.row;var v=o;var c=s*l;i.save();i.translate(v,c);i.scale(u,u);a(i,t);i.restore()}};var p=function drawNormal(){h(n.freePointer,n.canvas);d[0]={x:n.freePointer.x,y:n.freePointer.row*s,w:v,h:c};d[1]={x:n.freePointer.x+v,y:n.freePointer.row*s,w:0,h:c};n.freePointer.x+=v;if(n.freePointer.x==i){n.freePointer.x=0;n.freePointer.row++}};var g=function drawWrapped(){var e=n.scratch,t=n.canvas;e.clear();h({x:0,row:0},e);var a=i-n.freePointer.x;var o=v-a;var l=s;var u=n.freePointer.x;var p=n.freePointer.row*s;var g=a;t.context.drawImage(e,0,0,g,l,u,p,g,l);d[0]={x:u,y:p,w:g,h:c};var y=a;var m=(n.freePointer.row+1)*s;var b=o;t&&t.context.drawImage(e,y,0,b,l,0,m,b,l);d[1]={x:0,y:m,w:b,h:c};n.freePointer.x=o;n.freePointer.row++};var y=function moveToStartOfNextRow(){n.freePointer.x=0;n.freePointer.row++};if(this.freePointer.x+v<=i)p();else{if(this.freePointer.row>=o-1)return false;if(this.freePointer.x===i){y();p()}else if(this.enableWrapping)g();else{y();p()}}this.keyToLocation.set(e,d);this.needsBuffer=true;return d}},{key:"getOffsets",value:function getOffsets(e){return this.keyToLocation.get(e)}},{key:"isEmpty",value:function isEmpty(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function canFit(e){if(this.locked)return false;var t=this.texSize,a=this.texRows;var n=this.getScale(e),i=n.texW;return!(this.freePointer.x+i>t)||this.freePointer.row<a-1}},{key:"bufferIfNeeded",value:function bufferIfNeeded(e){this.texture||(this.texture=createTexture(e,this.debugID));if(this.needsBuffer){this.texture.buffer(this.canvas);this.needsBuffer=false;if(this.locked){this.canvas=null;this.scratch=null}}}},{key:"dispose",value:function dispose(){if(this.texture){this.texture.deleteTexture();this.texture=null}this.canvas=null;this.scratch=null;this.locked=true}}])}();var ud=function(){function AtlasCollection(e,t,a,n){_classCallCheck(this,AtlasCollection);this.r=e;this.texSize=t;this.texRows=a;this.createTextureCanvas=n;this.atlases=[];this.styleKeyToAtlas=new Map;this.markedKeys=new Set}return _createClass(AtlasCollection,[{key:"getKeys",value:function getKeys(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function _createAtlas(){var e=this.r,t=this.texSize,a=this.texRows,n=this.createTextureCanvas;return new ld(e,t,a,n)}},{key:"_getScratchCanvas",value:function _getScratchCanvas(){if(!this.scratch){var e=this.r,t=this.texSize,a=this.texRows,n=this.createTextureCanvas;var i=Math.floor(t/a);this.scratch=n(e,t,i,"scratch")}return this.scratch}},{key:"draw",value:function draw(e,t,a){var n=this.styleKeyToAtlas.get(e);if(!n){n=this.atlases[this.atlases.length-1];if(!n||!n.canFit(t)){n&&n.lock();n=this._createAtlas();this.atlases.push(n)}n.draw(e,t,a);this.styleKeyToAtlas.set(e,n)}return n}},{key:"getAtlas",value:function getAtlas(e){return this.styleKeyToAtlas.get(e)}},{key:"hasAtlas",value:function hasAtlas(e){return this.styleKeyToAtlas.has(e)}},{key:"markKeyForGC",value:function markKeyForGC(e){this.markedKeys.add(e)}},{key:"gc",value:function gc(){var e=this;var t=this.markedKeys;if(t.size!==0){var a=[];var n=new Map;var i=null;var o,s=_createForOfIteratorHelper(this.atlases);try{var l=function _loop(){var s=o.value;var l=s.getKeys();var u=intersection(t,l);if(u.size===0){a.push(s);l.forEach((function(e){return n.set(e,s)}));return 1}if(!i){i=e._createAtlas();a.push(i)}var v,c=_createForOfIteratorHelper(l);try{for(c.s();!(v=c.n()).done;){var d=v.value;if(!u.has(d)){var h=s.getOffsets(d),p=_slicedToArray(h,2),g=p[0],y=p[1];if(!i.canFit({w:g.w+y.w,h:g.h})){i.lock();i=e._createAtlas();a.push(i)}e._copyTextureToNewAtlas(d,s,i);n.set(d,i)}}}catch(e){c.e(e)}finally{c.f()}s.dispose()};for(s.s();!(o=s.n()).done;)!l()}catch(e){s.e(e)}finally{s.f()}this.atlases=a;this.styleKeyToAtlas=n;this.markedKeys=new Set}else console.log("nothing to garbage collect")}},{key:"_copyTextureToNewAtlas",value:function _copyTextureToNewAtlas(e,t,a){var n=t.getOffsets(e),i=_slicedToArray(n,2),o=i[0],s=i[1];if(s.w===0)a.draw(e,o,(function(e){e.drawImage(t.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h)}));else{var l=this._getScratchCanvas();l.clear();l.context.drawImage(t.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h);l.context.drawImage(t.canvas,s.x,s.y,s.w,s.h,o.w,0,s.w,s.h);var u=o.w+s.w;var v=o.h;a.draw(e,{w:u,h:v},(function(e){e.drawImage(l,0,0,u,v,0,0,u,v)}))}}},{key:"getCounts",value:function getCounts(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])}();function intersection(e,t){return e.intersection?e.intersection(t):new Set(_toConsumableArray(e).filter((function(e){return t.has(e)})))}var vd=function(){function AtlasManager(e,t){_classCallCheck(this,AtlasManager);this.r=e;this.globalOptions=t;this.atlasSize=t.webglTexSize;this.maxAtlasesPerBatch=t.webglTexPerBatch;this.renderTypes=new Map;this.collections=new Map;this.typeAndIdToKey=new Map;this.batchAtlases=[]}return _createClass(AtlasManager,[{key:"getAtlasSize",value:function getAtlasSize(){return this.atlasSize}},{key:"getMaxAtlasesPerBatch",value:function getMaxAtlasesPerBatch(){return this.maxAtlasesPerBatch}},{key:"addAtlasCollection",value:function addAtlasCollection(e,t){var a=this.globalOptions,n=a.webglTexSize,i=a.createTextureCanvas;var o=t.texRows;var s=this._cacheScratchCanvas(i);var l=new ud(this.r,n,o,s);this.collections.set(e,l)}},{key:"addRenderType",value:function addRenderType(e,t){var a=t.collection;if(!this.collections.has(a))throw new Error("invalid atlas collection name '".concat(a,"'"));var n=this.collections.get(a);var i=Y({type:e,atlasCollection:n},t);this.renderTypes.set(e,i)}},{key:"getRenderTypeOpts",value:function getRenderTypeOpts(e){return this.renderTypes.get(e)}},{key:"getAtlasCollection",value:function getAtlasCollection(e){return this.collections.get(e)}},{key:"_cacheScratchCanvas",value:function _cacheScratchCanvas(e){var t=-1;var a=-1;var n=null;return function(i,o,s,l){if(l){if(!n||o!=t||s!=a){t=o;a=s;n=e(i,o,s)}return n}return e(i,o,s)}}},{key:"_key",value:function _key(e,t){return"".concat(e,"-").concat(t)}},{key:"invalidate",value:function invalidate(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=t.forceRedraw,n=a!==void 0&&a,i=t.filterEle,o=i===void 0?function(){return true}:i,s=t.filterType,l=s===void 0?function(){return true}:s;var u=false;var v=false;var c,d=_createForOfIteratorHelper(e);try{for(d.s();!(c=d.n()).done;){var h=c.value;if(o(h)){var p,g=_createForOfIteratorHelper(this.renderTypes.values());try{for(g.s();!(p=g.n()).done;){var y=p.value;var m=y.type;if(l(m)){var b=y.getKey(h);var x=this.collections.get(y.collection);if(n){x.markKeyForGC(b);v=true}else{var w=y.getID?y.getID(h):h.id();var E=this._key(m,w);var T=this.typeAndIdToKey.get(E);if(T!==void 0&&T!==b){this.typeAndIdToKey.delete(E);x.markKeyForGC(T);u=true}}}}}catch(e){g.e(e)}finally{g.f()}}}}catch(e){d.e(e)}finally{d.f()}if(v){this.gc();u=false}return u}},{key:"gc",value:function gc(){var e,t=_createForOfIteratorHelper(this.collections.values());try{for(t.s();!(e=t.n()).done;){var a=e.value;a.gc()}}catch(e){t.e(e)}finally{t.f()}}},{key:"getOrCreateAtlas",value:function getOrCreateAtlas(e,t,a){var n=this.renderTypes.get(t);var i=n.getKey(e);a||(a=n.getBoundingBox(e));var o=this.collections.get(n.collection);var s=false;var l=o.draw(i,a,(function(t){n.drawElement(t,e,a,true,true);s=true}));if(s){var u=n.getID?n.getID(e):e.id();var v=this._key(t,u);this.typeAndIdToKey.set(v,i)}return l}},{key:"startBatch",value:function startBatch(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function getAtlasCount(){return this.batchAtlases.length}},{key:"getAtlases",value:function getAtlases(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function canAddToCurrentBatch(e,t){if(this.batchAtlases.length===this.maxAtlasesPerBatch){var a=this.renderTypes.get(t);var n=a.getKey(e);var i=this.collections.get(a.collection);var o=i.getAtlas(n);return Boolean(o)&&this.batchAtlases.includes(o)}return true}},{key:"getAtlasIndexForBatch",value:function getAtlasIndexForBatch(e){var t=this.batchAtlases.indexOf(e);if(t<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)return;this.batchAtlases.push(e);t=this.batchAtlases.length-1}return t}},{key:"getIndexArray",value:function getIndexArray(){return Array.from({length:this.maxAtlasesPerBatch},(function(e,t){return t}))}},{key:"getAtlasInfo",value:function getAtlasInfo(e,t){var a=this.renderTypes.get(t);var n=a.getBoundingBox(e);var i=this.getOrCreateAtlas(e,t,n);var o=this.getAtlasIndexForBatch(i);if(o!==void 0){var s=a.getKey(e);var l=i.getOffsets(s),u=_slicedToArray(l,2),v=u[0],c=u[1];return{index:o,tex1:v,tex2:c,bb:n}}}},{key:"setTransformMatrix",value:function setTransformMatrix(e,t,a,n){var i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];var o=this.getRenderTypeOpts(a);var s=o.getPadding?o.getPadding(e):0;if(n){var l=n.bb,u=n.tex1,v=n.tex2;var c=u.w/(u.w+v.w);i||(c=1-c);var d=this.getAdjustedBB(l,s,i,c);this._applyTransformMatrix(t,d,o,e)}else{var h=o.getBoundingBox(e);var p=this.getAdjustedBB(h,s,true,1);this._applyTransformMatrix(t,p,o,e)}}},{key:"_applyTransformMatrix",value:function _applyTransformMatrix(e,t,a,n){var i,o;identity(e);var s=a.getRotation?a.getRotation(n):0;if(s!==0){var l=a.getRotationPoint(n),u=l.x,v=l.y;translate(e,e,[u,v]);rotate(e,e,s);var c=a.getRotationOffset(n);i=c.x+t.xOffset;o=c.y}else{i=t.x1;o=t.y1}translate(e,e,[i,o]);scale(e,e,[t.w,t.h])}
/**
     * Adjusts a node or label BB to accomodate padding and split for wrapped textures.
     * @param bb - the original bounding box
     * @param padding - the padding to add to the bounding box
     * @param first - whether this is the first part of a wrapped texture
     * @param ratio - the ratio of the texture width of part of the text to the entire texture
     */},{key:"getAdjustedBB",value:function getAdjustedBB(e,t,a,n){var i=e.x1,o=e.y1,s=e.w,l=e.h;if(t){i-=t;o-=t;s+=2*t;l+=2*t}var u=0;var v=s*n;if(a&&n<1)s=v;else if(!a&&n<1){u=s-v;i+=u;s=v}return{x1:i,y1:o,w:s,h:l,xOffset:u}}},{key:"getDebugInfo",value:function getDebugInfo(){var e=[];var t,a=_createForOfIteratorHelper(this.collections);try{for(a.s();!(t=a.n()).done;){var n=_slicedToArray(t.value,2),i=n[0],o=n[1];var s=o.getCounts(),l=s.keyCount,u=s.atlasCount;e.push({type:i,keyCount:l,atlasCount:u})}}catch(e){a.e(e)}finally{a.f()}return e}}])}();var cd=0;var dd=1;var hd=2;var fd=3;var pd=4;var gd=function(){
/** 
   * @param {WebGLRenderingContext} gl 
   */
function ElementDrawingWebGL(e,t,a){_classCallCheck(this,ElementDrawingWebGL);this.r=e;this.gl=t;this.maxInstances=a.webglBatchSize;this.atlasSize=a.webglTexSize;this.bgColor=a.bgColor;this.debug=a.webglDebug;this.batchDebugInfo=[];a.enableWrapping=true;a.createTextureCanvas=createTextureCanvas;this.atlasManager=new vd(e,a);this.program=this.createShaderProgram(nd.SCREEN);this.pickingProgram=this.createShaderProgram(nd.PICKING);this.vao=this.createVAO()}return _createClass(ElementDrawingWebGL,[{key:"addAtlasCollection",value:function addAtlasCollection(e,t){this.atlasManager.addAtlasCollection(e,t)}},{key:"addAtlasRenderType",value:function addAtlasRenderType(e,t){this.atlasManager.addRenderType(e,t)}},{key:"invalidate",value:function invalidate(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=t.type;var n=this.atlasManager;return a?n.invalidate(e,{filterType:function filterType(e){return e===a},forceRedraw:true}):n.invalidate(e)}},{key:"gc",value:function gc(){this.atlasManager.gc()}},{key:"createShaderProgram",value:function createShaderProgram(e){var t=this.gl;var a="#version 300 es\n      precision highp float;\n\n      uniform mat3 uPanZoomMatrix;\n      uniform int  uAtlasSize;\n      \n      // instanced\n      in vec2 aPosition; \n\n      in mat3 aTransform;\n\n      // what are we rendering?\n      in int aVertType;\n\n      // for picking\n      in vec4 aIndex;\n      \n      // For textures\n      in int aAtlasId; // which shader unit/atlas to use\n      in vec4 aTex; // x/y/w/h of texture in atlas\n\n      // for edges\n      in vec4 aPointAPointB;\n      in vec4 aPointCPointD;\n      in float aLineWidth;\n      in vec4 aColor;\n\n      out vec2 vTexCoord;\n      out vec4 vColor;\n      flat out int vAtlasId;\n      flat out vec4 vIndex;\n      flat out int vVertType;\n\n      void main(void) {\n        int vid = gl_VertexID;\n        vec2 position = aPosition;\n\n        if(aVertType == ".concat(cd,") {\n          float texX = aTex.x;\n          float texY = aTex.y;\n          float texW = aTex.z;\n          float texH = aTex.w;\n\n          int vid = gl_VertexID;\n\n          if(vid == 1 || vid == 2 || vid == 4) {\n            texX += texW;\n          }\n          if(vid == 2 || vid == 4 || vid == 5) {\n            texY += texH;\n          }\n\n          float d = float(uAtlasSize);\n          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1\n\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n        }\n        else if(aVertType == ").concat(pd,") {\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n          vColor = aColor;\n        }\n        else if(aVertType == ").concat(dd,") {\n          vec2 source = aPointAPointB.xy;\n          vec2 target = aPointAPointB.zw;\n\n          // adjust the geometry so that the line is centered on the edge\n          position.y = position.y - 0.5;\n\n          vec2 xBasis = target - source;\n          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n          vec2 point = source + xBasis * position.x + yBasis * aLineWidth * position.y;\n\n          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);\n          vColor = aColor;\n        } \n        else if(aVertType == ").concat(hd,") {\n          vec2 pointA = aPointAPointB.xy;\n          vec2 pointB = aPointAPointB.zw;\n          vec2 pointC = aPointCPointD.xy;\n          vec2 pointD = aPointCPointD.zw;\n\n          // adjust the geometry so that the line is centered on the edge\n          position.y = position.y - 0.5;\n\n          vec2 p0 = pointA;\n          vec2 p1 = pointB;\n          vec2 p2 = pointC;\n          vec2 pos = position;\n          if(position.x == 1.0) {\n            p0 = pointD;\n            p1 = pointC;\n            p2 = pointB;\n            pos = vec2(0.0, -position.y);\n          }\n\n          vec2 p01 = p1 - p0;\n          vec2 p12 = p2 - p1;\n          vec2 p21 = p1 - p2;\n\n          // Find the normal vector.\n          vec2 tangent = normalize(normalize(p12) + normalize(p01));\n          vec2 normal = vec2(-tangent.y, tangent.x);\n\n          // Find the vector perpendicular to p0 -> p1.\n          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));\n\n          // Determine the bend direction.\n          float sigma = sign(dot(p01 + p21, normal));\n          float width = aLineWidth;\n\n          if(sign(pos.y) == -sigma) {\n            // This is an intersecting vertex. Adjust the position so that there's no overlap.\n            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);\n            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);\n          } else {\n            // This is a non-intersecting vertex. Treat it like a mitre join.\n            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);\n            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);\n          }\n\n          vColor = aColor;\n        } \n        else if(aVertType == ").concat(fd," && vid < 3) {\n          // massage the first triangle into an edge arrow\n          if(vid == 0)\n            position = vec2(-0.15, -0.3);\n          if(vid == 1)\n            position = vec2( 0.0,   0.0);\n          if(vid == 2)\n            position = vec2( 0.15, -0.3);\n\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n          vColor = aColor;\n        }\n        else {\n          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space\n        }\n\n        vAtlasId = aAtlasId;\n        vIndex = aIndex;\n        vVertType = aVertType;\n      }\n    ");var n=this.atlasManager.getIndexArray();var i="#version 300 es\n      precision highp float;\n\n      // define texture unit for each node in the batch\n      ".concat(n.map((function(e){return"uniform sampler2D uTexture".concat(e,";")})).join("\n\t"),"\n\n      uniform vec4 uBGColor;\n\n      in vec2 vTexCoord;\n      in vec4 vColor;\n      flat in int vAtlasId;\n      flat in vec4 vIndex;\n      flat in int vVertType;\n\n      out vec4 outColor;\n\n      void main(void) {\n        if(vVertType == ").concat(cd,") {\n          ").concat(n.map((function(e){return"if(vAtlasId == ".concat(e,") outColor = texture(uTexture").concat(e,", vTexCoord);")})).join("\n\telse "),"\n        } else if(vVertType == ").concat(fd,") {\n          // blend arrow color with background (using premultiplied alpha)\n          outColor.rgb = vColor.rgb + (uBGColor.rgb * (1.0 - vColor.a)); \n          outColor.a = 1.0; // make opaque, masks out line under arrow\n        } else {\n          outColor = vColor;\n        }\n\n        ").concat(e.picking?"if(outColor.a == 0.0) discard;\n             else outColor = vIndex;":"","\n      }\n    ");var o=createProgram(t,a,i);o.aPosition=t.getAttribLocation(o,"aPosition");o.aIndex=t.getAttribLocation(o,"aIndex");o.aVertType=t.getAttribLocation(o,"aVertType");o.aTransform=t.getAttribLocation(o,"aTransform");o.aAtlasId=t.getAttribLocation(o,"aAtlasId");o.aTex=t.getAttribLocation(o,"aTex");o.aPointAPointB=t.getAttribLocation(o,"aPointAPointB");o.aPointCPointD=t.getAttribLocation(o,"aPointCPointD");o.aLineWidth=t.getAttribLocation(o,"aLineWidth");o.aColor=t.getAttribLocation(o,"aColor");o.uPanZoomMatrix=t.getUniformLocation(o,"uPanZoomMatrix");o.uAtlasSize=t.getUniformLocation(o,"uAtlasSize");o.uBGColor=t.getUniformLocation(o,"uBGColor");o.uTextures=[];for(var s=0;s<this.atlasManager.getMaxAtlasesPerBatch();s++)o.uTextures.push(t.getUniformLocation(o,"uTexture".concat(s)));return o}},{key:"createVAO",value:function createVAO(){var e=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=e.length/2;var t=this.maxInstances;var a=this.gl,n=this.program;var i=a.createVertexArray();a.bindVertexArray(i);createBufferStaticDraw(a,"vec2",n.aPosition,e);this.transformBuffer=create3x3MatrixBufferDynamicDraw(a,t,n.aTransform);this.indexBuffer=createBufferDynamicDraw(a,t,"vec4",n.aIndex);this.vertTypeBuffer=createBufferDynamicDraw(a,t,"int",n.aVertType);this.atlasIdBuffer=createBufferDynamicDraw(a,t,"int",n.aAtlasId);this.texBuffer=createBufferDynamicDraw(a,t,"vec4",n.aTex);this.pointAPointBBuffer=createBufferDynamicDraw(a,t,"vec4",n.aPointAPointB);this.pointCPointDBuffer=createBufferDynamicDraw(a,t,"vec4",n.aPointCPointD);this.lineWidthBuffer=createBufferDynamicDraw(a,t,"float",n.aLineWidth);this.colorBuffer=createBufferDynamicDraw(a,t,"vec4",n.aColor);a.bindVertexArray(null);return i}},{key:"buffers",get:function get(){var e=this;this._buffers||(this._buffers=Object.keys(this).filter((function(e){return e.endsWith("Buffer")})).map((function(t){return e[t]})));return this._buffers}},{key:"startFrame",value:function startFrame(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:nd.SCREEN;this.panZoomMatrix=e;this.renderTarget=t;this.batchDebugInfo=[];this.wrappedCount=0;this.rectangleCount=0;this.startBatch()}},{key:"startBatch",value:function startBatch(){this.instanceCount=0;this.atlasManager.startBatch()}},{key:"endFrame",value:function endFrame(){this.endBatch()}},{key:"getTempMatrix",value:function getTempMatrix(){return this.tempMatrix=this.tempMatrix||create()}},{key:"drawTexture",value:function drawTexture(e,t,a){var n=this.atlasManager;if(e.visible()&&n.getRenderTypeOpts(a).isVisible(e)){n.canAddToCurrentBatch(e,a)||this.endBatch();this.instanceCount+1>=this.maxInstances&&this.endBatch();var i=this.instanceCount;this.vertTypeBuffer.getView(i)[0]=cd;var o=this.indexBuffer.getView(i);indexToVec4(t,o);var s=n.getAtlasInfo(e,a);var l=s.index,u=s.tex1,v=s.tex2;v.w>0&&this.wrappedCount++;var c=true;for(var d=0,h=[u,v];d<h.length;d++){var p=h[d];if(p.w!=0){var g=this.instanceCount;this.vertTypeBuffer.getView(g)[0]=cd;var y=this.indexBuffer.getView(g);indexToVec4(t,y);var m=this.atlasIdBuffer.getView(g);m[0]=l;var b=this.texBuffer.getView(g);b[0]=p.x;b[1]=p.y;b[2]=p.w;b[3]=p.h;var x=this.transformBuffer.getMatrixView(g);n.setTransformMatrix(e,x,a,s,c);this.instanceCount++}c=false}this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"drawSimpleRectangle",value:function drawSimpleRectangle(e,t,a){if(e.visible()){var n=this.atlasManager;var i=this.instanceCount;this.vertTypeBuffer.getView(i)[0]=pd;var o=this.indexBuffer.getView(i);indexToVec4(t,o);var s=e.pstyle("background-color").value;var l=e.pstyle("background-opacity").value;var u=this.colorBuffer.getView(i);toWebGLColor(s,l,u);var v=this.transformBuffer.getMatrixView(i);n.setTransformMatrix(e,v,a);this.rectangleCount++;this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"drawEdgeArrow",value:function drawEdgeArrow(e,t,a){if(e.visible()){var n=e._private.rscratch;var i,o,s;if(a==="source"){i=n.arrowStartX;o=n.arrowStartY;s=n.srcArrowAngle}else{i=n.arrowEndX;o=n.arrowEndY;s=n.tgtArrowAngle}if(!(isNaN(i)||i==null||isNaN(o)||o==null||isNaN(s)||s==null)){var l=e.pstyle(a+"-arrow-shape").value;if(l!=="none"){var u=e.pstyle(a+"-arrow-color").value;var v=e.pstyle("opacity").value;var c=e.pstyle("line-opacity").value;var d=v*c;var h=e.pstyle("width").pfValue;var p=e.pstyle("arrow-scale").value;var g=this.r.getArrowWidth(h,p);var y=this.instanceCount;var m=this.transformBuffer.getMatrixView(y);identity(m);translate(m,m,[i,o]);scale(m,m,[g,g]);rotate(m,m,s);this.vertTypeBuffer.getView(y)[0]=fd;var b=this.indexBuffer.getView(y);indexToVec4(t,b);var x=this.colorBuffer.getView(y);toWebGLColor(u,d,x);this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function drawEdgeLine(e,t){if(e.visible()){var a=this.getEdgePoints(e);if(a){var n=e.pstyle("opacity").value;var i=e.pstyle("line-opacity").value;var o=e.pstyle("width").pfValue;var s=e.pstyle("line-color").value;var l=n*i;a.length/2+this.instanceCount>this.maxInstances&&this.endBatch();if(a.length==4){var u=this.instanceCount;this.vertTypeBuffer.getView(u)[0]=dd;var v=this.indexBuffer.getView(u);indexToVec4(t,v);var c=this.colorBuffer.getView(u);toWebGLColor(s,l,c);var d=this.lineWidthBuffer.getView(u);d[0]=o;var h=this.pointAPointBBuffer.getView(u);h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var p=0;p<a.length-2;p+=2){var g=this.instanceCount;this.vertTypeBuffer.getView(g)[0]=hd;var y=this.indexBuffer.getView(g);indexToVec4(t,y);var m=this.colorBuffer.getView(g);toWebGLColor(s,l,m);var b=this.lineWidthBuffer.getView(g);b[0]=o;var x=a[p-2],w=a[p-1];var E=a[p],T=a[p+1];var S=a[p+2],k=a[p+3];var P=a[p+4],_=a[p+5];if(p==0){x=2*E-S+.001;w=2*T-k+.001}if(p==a.length-4){P=2*S-E+.001;_=2*k-T+.001}var D=this.pointAPointBBuffer.getView(g);D[0]=x;D[1]=w;D[2]=E;D[3]=T;var I=this.pointCPointDBuffer.getView(g);I[0]=S;I[1]=k;I[2]=P;I[3]=_;this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"getEdgePoints",value:function getEdgePoints(e){var t=e._private.rscratch;if(!t.badLine&&t.allpts!=null&&!isNaN(t.allpts[0])){var a=t.allpts;if(a.length==4)return a;var n=this.getNumSegments(e);return this.getCurveSegmentPoints(a,n)}}},{key:"getNumSegments",value:function getNumSegments(e){var t=15;return Math.min(Math.max(t,5),this.maxInstances)}},{key:"getCurveSegmentPoints",value:function getCurveSegmentPoints(e,t){if(e.length==4)return e;var a=Array((t+1)*2);for(var n=0;n<=t;n++)if(n==0){a[0]=e[0];a[1]=e[1]}else if(n==t){a[n*2]=e[e.length-2];a[n*2+1]=e[e.length-1]}else{var i=n/t;this.setCurvePoint(e,i,a,n*2)}return a}},{key:"setCurvePoint",value:function setCurvePoint(e,t,a,n){if(!(e.length<=2)){var i=Array(e.length-2);for(var o=0;o<i.length;o+=2){var s=(1-t)*e[o]+t*e[o+2];var l=(1-t)*e[o+1]+t*e[o+3];i[o]=s;i[o+1]=l}return this.setCurvePoint(i,t,a,n)}a[n]=e[0];a[n+1]=e[1]}},{key:"endBatch",value:function endBatch(){var e=this.gl,t=this.vao,a=this.vertexCount,n=this.instanceCount;if(n!==0){var i=this.renderTarget.picking?this.pickingProgram:this.program;e.useProgram(i);e.bindVertexArray(t);var o,s=_createForOfIteratorHelper(this.buffers);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.bufferSubData(n)}}catch(e){s.e(e)}finally{s.f()}var u=this.atlasManager.getAtlases();for(var v=0;v<u.length;v++)u[v].bufferIfNeeded(e);for(var c=0;c<u.length;c++){e.activeTexture(e.TEXTURE0+c);e.bindTexture(e.TEXTURE_2D,u[c].texture);e.uniform1i(i.uTextures[c],c)}e.uniformMatrix3fv(i.uPanZoomMatrix,false,this.panZoomMatrix);e.uniform1i(i.uAtlasSize,this.atlasManager.getAtlasSize());var d=toWebGLColor(this.bgColor,1);e.uniform4fv(i.uBGColor,d);e.drawArraysInstanced(e.TRIANGLES,0,a,n);e.bindVertexArray(null);e.bindTexture(e.TEXTURE_2D,null);this.debug&&this.batchDebugInfo.push({count:n,atlasCount:u.length});this.startBatch()}}},{key:"getDebugInfo",value:function getDebugInfo(){var e=this.atlasManager.getDebugInfo();var t=e.reduce((function(e,t){return e+t.atlasCount}),0);var a=this.batchDebugInfo;var n=a.reduce((function(e,t){return e+t.count}),0);return{atlasInfo:e,totalAtlases:t,wrappedCount:this.wrappedCount,rectangleCount:this.rectangleCount,batchCount:a.length,batchInfo:a,totalInstances:n}}}])}();function fillStyle(e,t){return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(t,")")}var yd=function(){function OverlayUnderlayRenderer(e){_classCallCheck(this,OverlayUnderlayRenderer);this.r=e}return _createClass(OverlayUnderlayRenderer,[{key:"getStyleKey",value:function getStyleKey(e,t){var a=this.getStyle(e,t),n=a.shape,i=a.opacity,o=a.color;if(!n)return null;var s=t.width();var l=t.height();var u=fillStyle(o,i);return Ke("".concat(n,"-").concat(s,"-").concat(l,"-").concat(u))}},{key:"isVisible",value:function isVisible(e,t){var a=t.pstyle("".concat(e,"-opacity")).value;return a>0}},{key:"getStyle",value:function getStyle(e,t){var a=t.pstyle("".concat(e,"-opacity")).value;var n=t.pstyle("".concat(e,"-color")).value;var i=t.pstyle("".concat(e,"-shape")).value;return{opacity:a,color:n,shape:i}}},{key:"getPadding",value:function getPadding(e,t){return t.pstyle("".concat(e,"-padding")).pfValue}},{key:"draw",value:function draw(e,t,a,n){if(this.isVisible(e,a)){var i=this.r;var o=n.w;var s=n.h;var l=o/2;var u=s/2;var v=this.getStyle(e,a),c=v.shape,d=v.color,h=v.opacity;t.save();t.fillStyle=fillStyle(d,h);c==="round-rectangle"||c==="roundrectangle"?i.drawRoundRectanglePath(t,l,u,o,s,"auto"):c==="ellipse"&&i.drawEllipsePath(t,l,u,o,s);t.fill();t.restore()}}}])}();var md={};md.initWebgl=function(e,t){var a=this;var n=a.data.contexts[a.WEBGL];e.bgColor=getBGColor(a);e.webglTexSize=Math.min(e.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE));e.webglTexRows=Math.min(e.webglTexRows,54);e.webglTexRowsNodes=Math.min(e.webglTexRowsNodes,54);e.webglBatchSize=Math.min(e.webglBatchSize,16384);e.webglTexPerBatch=Math.min(e.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS));a.webglDebug=e.webglDebug;a.webglDebugShowAtlases=e.webglDebugShowAtlases;a.pickingFrameBuffer=createPickingFrameBuffer(n);a.pickingFrameBuffer.needsDraw=true;var i=function getLabelRotation(e){return function(t){return a.getTextAngle(t,e)}};var o=function isLabelVisible(e){return function(t){var a=t.pstyle(e);return a&&a.value}};a.drawing=new gd(a,n,e);var s=new yd(a);a.drawing.addAtlasCollection("node",od({texRows:e.webglTexRowsNodes}));a.drawing.addAtlasCollection("label",od({texRows:e.webglTexRows}));a.drawing.addAtlasRenderType("node-body",sd({collection:"node",getKey:t.getStyleKey,getBoundingBox:t.getElementBox,drawElement:t.drawElement}));a.drawing.addAtlasRenderType("label",sd({collection:"label",getKey:t.getLabelKey,getBoundingBox:t.getLabelBox,drawElement:t.drawLabel,getRotation:i(null),getRotationPoint:t.getLabelRotationPoint,getRotationOffset:t.getLabelRotationOffset,isVisible:o("label")}));a.drawing.addAtlasRenderType("node-overlay",sd({collection:"node",getBoundingBox:t.getElementBox,getKey:function getKey(e){return s.getStyleKey("overlay",e)},drawElement:function drawElement(e,t,a){return s.draw("overlay",e,t,a)},isVisible:function isVisible(e){return s.isVisible("overlay",e)},getPadding:function getPadding(e){return s.getPadding("overlay",e)}}));a.drawing.addAtlasRenderType("node-underlay",sd({collection:"node",getBoundingBox:t.getElementBox,getKey:function getKey(e){return s.getStyleKey("underlay",e)},drawElement:function drawElement(e,t,a){return s.draw("underlay",e,t,a)},isVisible:function isVisible(e){return s.isVisible("underlay",e)},getPadding:function getPadding(e){return s.getPadding("underlay",e)}}));a.drawing.addAtlasRenderType("edge-source-label",sd({collection:"label",getKey:t.getSourceLabelKey,getBoundingBox:t.getSourceLabelBox,drawElement:t.drawSourceLabel,getRotation:i("source"),getRotationPoint:t.getSourceLabelRotationPoint,getRotationOffset:t.getSourceLabelRotationOffset,isVisible:o("source-label")}));a.drawing.addAtlasRenderType("edge-target-label",sd({collection:"label",getKey:t.getTargetLabelKey,getBoundingBox:t.getTargetLabelBox,drawElement:t.drawTargetLabel,getRotation:i("target"),getRotationPoint:t.getTargetLabelRotationPoint,getRotationOffset:t.getTargetLabelRotationOffset,isVisible:o("target-label")}));var l=Ie((function(){console.log("garbage collect flag set");a.data.gc=true}),1e4);a.onUpdateEleCalcs((function(e,t){var n=false;t&&t.length>0&&(n|=a.drawing.invalidate(t));n&&l()}));overrideCanvasRendererFunctions(a)};function getBGColor(e){var t=e.cy.container();var a=t&&t.style&&t.style.backgroundColor||"white";return Q(a)}function overrideCanvasRendererFunctions(e){var t=e.render;e.render=function(a){a=a||{};var n=e.cy;if(e.webgl)if(n.zoom()>tc){clearWebgl(e);t.call(e,a)}else{clearCanvas(e);renderWebgl(e,a,nd.SCREEN)}};var a=e.matchCanvasSize;e.matchCanvasSize=function(t){a.call(e,t);e.pickingFrameBuffer.setFramebufferAttachmentSizes(e.canvasWidth,e.canvasHeight);e.pickingFrameBuffer.needsDraw=true};e.findNearestElements=function(t,a,n,i){return findNearestElementsWebgl(e,t,a)};var n=e.invalidateCachedZSortedEles;e.invalidateCachedZSortedEles=function(){n.call(e);e.pickingFrameBuffer.needsDraw=true};var i=e.notify;e.notify=function(t,a){i.call(e,t,a);t==="viewport"||t==="bounds"?e.pickingFrameBuffer.needsDraw=true:t==="background"&&e.drawing.invalidate(a,{type:"node-body"})}}function clearWebgl(e){var t=e.data.contexts[e.WEBGL];t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}function clearCanvas(e){var t=function clear(t){t.save();t.setTransform(1,0,0,1,0,0);t.clearRect(0,0,e.canvasWidth,e.canvasHeight);t.restore()};t(e.data.contexts[e.NODE]);t(e.data.contexts[e.DRAG])}function createPanZoomMatrix(e){var t=e.canvasWidth;var a=e.canvasHeight;var n=getEffectivePanZoom(e),i=n.pan,o=n.zoom;var s=create();translate(s,s,[i.x,i.y]);scale(s,s,[o,o]);var l=create();projection(l,t,a);var u=create();multiply(u,l,s);return u}function setContextTransform(e,t){var a=e.canvasWidth;var n=e.canvasHeight;var i=getEffectivePanZoom(e),o=i.pan,s=i.zoom;t.setTransform(1,0,0,1,0,0);t.clearRect(0,0,a,n);t.translate(o.x,o.y);t.scale(s,s)}function drawSelectionRectangle(e,t){e.drawSelectionRectangle(t,(function(t){return setContextTransform(e,t)}))}function drawAxes(e){var t=e.data.contexts[e.NODE];t.save();setContextTransform(e,t);t.strokeStyle="rgba(0, 0, 0, 0.3)";t.beginPath();t.moveTo(-1e3,0);t.lineTo(1e3,0);t.stroke();t.beginPath();t.moveTo(0,-1e3);t.lineTo(0,1e3);t.stroke();t.restore()}function drawAtlases(e){var t=function draw(t,a,n){var i=t.atlasManager.getAtlasCollection(a);var o=e.data.contexts[e.NODE];var s=.125;var l=i.atlases;for(var u=0;u<l.length;u++){var v=l[u];var c=v.canvas;if(c){var d=c.width;var h=c.height;var p=d*u;var g=c.height*n;o.save();o.scale(s,s);o.drawImage(c,p,g);o.strokeStyle="black";o.rect(p,g,d,h);o.stroke();o.restore()}}};var a=0;t(e.drawing,"node",a++);t(e.drawing,"label",a++)}function getPickingIndexes(e,t,a,n,i){var o,s,l,u;var v=getEffectivePanZoom(e),c=v.pan,d=v.zoom;var h=modelToRenderedPosition(e,c,d,t,a),p=_slicedToArray(h,2),g=p[0],y=p[1];var m=6;o=g-m/2;s=y-m/2;l=m;u=m;if(l===0||u===0)return[];var b=e.data.contexts[e.WEBGL];b.bindFramebuffer(b.FRAMEBUFFER,e.pickingFrameBuffer);if(e.pickingFrameBuffer.needsDraw){b.viewport(0,0,b.canvas.width,b.canvas.height);renderWebgl(e,null,nd.PICKING);e.pickingFrameBuffer.needsDraw=false}var x=l*u;var w=new Uint8Array(x*4);b.readPixels(o,s,l,u,b.RGBA,b.UNSIGNED_BYTE,w);b.bindFramebuffer(b.FRAMEBUFFER,null);var E=new Set;for(var T=0;T<x;T++){var S=w.slice(T*4,T*4+4);var k=vec4ToIndex(S)-1;k>=0&&E.add(k)}return E}function findNearestElementsWebgl(e,t,a){var n=getPickingIndexes(e,t,a);var i=e.getCachedZSortedEles();var o,s;var l,u=_createForOfIteratorHelper(n);try{for(u.s();!(l=u.n()).done;){var v=l.value;var c=i[v];!o&&c.isNode()&&(o=c);!s&&c.isEdge()&&(s=c);if(o&&s)break}}catch(e){u.e(e)}finally{u.f()}return[o,s].filter(Boolean)}function isSimpleRectangle(e){return e.pstyle("shape").value==="rectangle"&&e.pstyle("background-fill").value==="solid"&&e.pstyle("border-width").pfValue===0&&e.pstyle("background-image").strValue==="none"}function drawEle(e,t,a){var n=e.drawing;t+=1;if(a.isNode()){n.drawTexture(a,t,"node-underlay");isSimpleRectangle(a)?n.drawSimpleRectangle(a,t,"node-body"):n.drawTexture(a,t,"node-body");n.drawTexture(a,t,"label");n.drawTexture(a,t,"node-overlay")}else{n.drawEdgeLine(a,t);n.drawEdgeArrow(a,t,"source");n.drawEdgeArrow(a,t,"target");n.drawTexture(a,t,"label");n.drawTexture(a,t,"edge-source-label");n.drawTexture(a,t,"edge-target-label")}}function renderWebgl(e,t,a){var n;e.webglDebug&&(n=performance.now());var i=e.drawing;var o=0;a.screen&&e.data.canvasNeedsRedraw[e.SELECT_BOX]&&drawSelectionRectangle(e,t);if(e.data.canvasNeedsRedraw[e.NODE]||a.picking){var s=e.data.contexts[e.WEBGL];if(a.screen){s.clearColor(0,0,0,0);s.enable(s.BLEND);s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA)}else s.disable(s.BLEND);s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);s.viewport(0,0,s.canvas.width,s.canvas.height);var l=createPanZoomMatrix(e);var u=e.getCachedZSortedEles();o=u.length;i.startFrame(l,a);if(a.screen){for(var v=0;v<u.nondrag.length;v++)drawEle(e,v,u.nondrag[v]);for(var c=0;c<u.drag.length;c++)drawEle(e,c,u.drag[c])}else if(a.picking)for(var d=0;d<u.length;d++)drawEle(e,d,u[d]);i.endFrame();if(a.screen&&e.webglDebugShowAtlases){drawAxes(e);drawAtlases(e)}e.data.canvasNeedsRedraw[e.NODE]=false;e.data.canvasNeedsRedraw[e.DRAG]=false}if(e.webglDebug){var h=performance.now();var p=false;var g=Math.ceil(h-n);var y=i.getDebugInfo();var m=["".concat(o," elements"),"".concat(y.totalInstances," instances"),"".concat(y.batchCount," batches"),"".concat(y.totalAtlases," atlases"),"".concat(y.wrappedCount," wrapped textures"),"".concat(y.rectangleCount," simple rectangles")].join(", ");if(p)console.log("WebGL (".concat(a.name,") - time ").concat(g,"ms, ").concat(m));else{console.log("WebGL (".concat(a.name,") - frame time ").concat(g,"ms"));console.log("Totals:");console.log("  ".concat(m));console.log("Texture Atlases Used:");var b=y.atlasInfo;var x,w=_createForOfIteratorHelper(b);try{for(w.s();!(x=w.n()).done;){var E=x.value;console.log("  ".concat(E.type,": ").concat(E.keyCount," keys, ").concat(E.atlasCount," atlases"))}}catch(e){w.e(e)}finally{w.f()}console.log("")}}if(e.data.gc){console.log("Garbage Collect!");e.data.gc=false;i.gc()}}var bd={};bd.drawPolygonPath=function(e,t,a,n,i,o){var s=n/2;var l=i/2;e.beginPath&&e.beginPath();e.moveTo(t+s*o[0],a+l*o[1]);for(var u=1;u<o.length/2;u++)e.lineTo(t+s*o[u*2],a+l*o[u*2+1]);e.closePath()};bd.drawRoundPolygonPath=function(e,t,a,n,i,o,s){s.forEach((function(t){return drawPreparedRoundCorner(e,t)}));e.closePath()};bd.drawRoundRectanglePath=function(e,t,a,n,i,o){var s=n/2;var l=i/2;var u=o==="auto"?Ur(n,i):Math.min(o,l,s);e.beginPath&&e.beginPath();e.moveTo(t,a-l);e.arcTo(t+s,a-l,t+s,a,u);e.arcTo(t+s,a+l,t,a+l,u);e.arcTo(t-s,a+l,t-s,a,u);e.arcTo(t-s,a-l,t,a-l,u);e.lineTo(t,a-l);e.closePath()};bd.drawBottomRoundRectanglePath=function(e,t,a,n,i,o){var s=n/2;var l=i/2;var u=o==="auto"?Ur(n,i):o;e.beginPath&&e.beginPath();e.moveTo(t,a-l);e.lineTo(t+s,a-l);e.lineTo(t+s,a);e.arcTo(t+s,a+l,t,a+l,u);e.arcTo(t-s,a+l,t-s,a,u);e.lineTo(t-s,a-l);e.lineTo(t,a-l);e.closePath()};bd.drawCutRectanglePath=function(e,t,a,n,i,o,s){var l=n/2;var u=i/2;var v=s==="auto"?$r():s;e.beginPath&&e.beginPath();e.moveTo(t-l+v,a-u);e.lineTo(t+l-v,a-u);e.lineTo(t+l,a-u+v);e.lineTo(t+l,a+u-v);e.lineTo(t+l-v,a+u);e.lineTo(t-l+v,a+u);e.lineTo(t-l,a+u-v);e.lineTo(t-l,a-u+v);e.closePath()};bd.drawBarrelPath=function(e,t,a,n,i){var o=n/2;var s=i/2;var l=t-o;var u=t+o;var v=a-s;var c=a+s;var d=Jr(n,i);var h=d.widthOffset;var p=d.heightOffset;var g=d.ctrlPtOffsetPct*h;e.beginPath&&e.beginPath();e.moveTo(l,v+p);e.lineTo(l,c-p);e.quadraticCurveTo(l+g,c,l+h,c);e.lineTo(u-h,c);e.quadraticCurveTo(u-g,c,u,c-p);e.lineTo(u,v+p);e.quadraticCurveTo(u-g,v,u-h,v);e.lineTo(l+h,v);e.quadraticCurveTo(l+g,v,l,v+p);e.closePath()};var xd=Math.sin(0);var wd=Math.cos(0);var Ed={};var Cd={};var Td=Math.PI/40;for(var Sd=0*Math.PI;Sd<2*Math.PI;Sd+=Td){Ed[Sd]=Math.sin(Sd);Cd[Sd]=Math.cos(Sd)}bd.drawEllipsePath=function(e,t,a,n,i){e.beginPath&&e.beginPath();if(e.ellipse)e.ellipse(t,a,n/2,i/2,0,0,2*Math.PI);else{var o,s;var l=n/2;var u=i/2;for(var v=0*Math.PI;v<2*Math.PI;v+=Td){o=t-l*Ed[v]*xd+l*Cd[v]*wd;s=a+u*Cd[v]*xd+u*Ed[v]*wd;v===0?e.moveTo(o,s):e.lineTo(o,s)}}e.closePath()};var kd={};kd.createBuffer=function(e,t){var a=document.createElement("canvas");a.width=e;a.height=t;return[a,a.getContext("2d")]};kd.bufferCanvasImage=function(e){var t=this.cy;var a=t.mutableElements();var n=a.boundingBox();var i=this.findContainerClientCoords();var o=e.full?Math.ceil(n.w):i[2];var s=e.full?Math.ceil(n.h):i[3];var l=h(e.maxWidth)||h(e.maxHeight);var u=this.getPixelRatio();var v=1;if(e.scale!==void 0){o*=e.scale;s*=e.scale;v=e.scale}else if(l){var c=Infinity;var d=Infinity;h(e.maxWidth)&&(c=v*e.maxWidth/o);h(e.maxHeight)&&(d=v*e.maxHeight/s);v=Math.min(c,d);o*=v;s*=v}if(!l){o*=u;s*=u;v*=u}var p=document.createElement("canvas");p.width=o;p.height=s;p.style.width=o+"px";p.style.height=s+"px";var g=p.getContext("2d");if(o>0&&s>0){g.clearRect(0,0,o,s);g.globalCompositeOperation="source-over";var y=this.getCachedZSortedEles();if(e.full){g.translate(-n.x1*v,-n.y1*v);g.scale(v,v);this.drawElements(g,y);g.scale(1/v,1/v);g.translate(n.x1*v,n.y1*v)}else{var m=t.pan();var b={x:m.x*v,y:m.y*v};v*=t.zoom();g.translate(b.x,b.y);g.scale(v,v);this.drawElements(g,y);g.scale(1/v,1/v);g.translate(-b.x,-b.y)}if(e.bg){g.globalCompositeOperation="destination-over";g.fillStyle=e.bg;g.rect(0,0,o,s);g.fill()}}return p};function b64ToBlob(e,t){var a=atob(e);var n=new ArrayBuffer(a.length);var i=new Uint8Array(n);for(var o=0;o<a.length;o++)i[o]=a.charCodeAt(o);return new Blob([n],{type:t})}function b64UriToB64(e){var t=e.indexOf(",");return e.substr(t+1)}function output(e,t,a){var n=function getB64Uri(){return t.toDataURL(a,e.quality)};switch(e.output){case"blob-promise":return new Bn((function(n,i){try{t.toBlob((function(e){e!=null?n(e):i(new Error("`canvas.toBlob()` sent a null value in its callback"))}),a,e.quality)}catch(e){i(e)}}));case"blob":return b64ToBlob(b64UriToB64(n()),a);case"base64":return b64UriToB64(n());case"base64uri":default:return n()}}kd.png=function(e){return output(e,this.bufferCanvasImage(e),"image/png")};kd.jpg=function(e){return output(e,this.bufferCanvasImage(e),"image/jpeg")};var Pd={};Pd.nodeShapeImpl=function(e,t,a,n,i,o,s,l){switch(e){case"ellipse":return this.drawEllipsePath(t,a,n,i,o);case"polygon":return this.drawPolygonPath(t,a,n,i,o,s);case"round-polygon":return this.drawRoundPolygonPath(t,a,n,i,o,s,l);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,a,n,i,o,l);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,a,n,i,o,s,l);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,a,n,i,o,l);case"barrel":return this.drawBarrelPath(t,a,n,i,o)}};var _d=CanvasRenderer;var Dd=CanvasRenderer.prototype;Dd.CANVAS_LAYERS=3;Dd.SELECT_BOX=0;Dd.DRAG=1;Dd.NODE=2;Dd.WEBGL=3;Dd.CANVAS_TYPES=["2d","2d","2d","webgl2"];Dd.BUFFER_COUNT=3;Dd.TEXTURE_BUFFER=0;Dd.MOTIONBLUR_BUFFER_NODE=1;Dd.MOTIONBLUR_BUFFER_DRAG=2;function CanvasRenderer(e){var t=this;var a=t.cy.window();var n=a.document;if(e.webgl){Dd.CANVAS_LAYERS=t.CANVAS_LAYERS=4;console.log("webgl rendering enabled")}t.data={canvases:new Array(Dd.CANVAS_LAYERS),contexts:new Array(Dd.CANVAS_LAYERS),canvasNeedsRedraw:new Array(Dd.CANVAS_LAYERS),bufferCanvases:new Array(Dd.BUFFER_COUNT),bufferContexts:new Array(Dd.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color";var o="rgba(0,0,0,0)";t.data.canvasContainer=n.createElement("div");var s=t.data.canvasContainer.style;t.data.canvasContainer.style[i]=o;s.position="relative";s.zIndex="0";s.overflow="hidden";var l=e.cy.container();l.appendChild(t.data.canvasContainer);l.style[i]=o;var u={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};if(_()){u["-ms-touch-action"]="none";u["touch-action"]="none"}for(var v=0;v<Dd.CANVAS_LAYERS;v++){var c=t.data.canvases[v]=n.createElement("canvas");var d=Dd.CANVAS_TYPES[v];t.data.contexts[v]=c.getContext(d);t.data.contexts[v]||it("Could not create canvas of type "+d);Object.keys(u).forEach((function(e){c.style[e]=u[e]}));c.style.position="absolute";c.setAttribute("data-id","layer"+v);c.style.zIndex=String(Dd.CANVAS_LAYERS-v);t.data.canvasContainer.appendChild(c);t.data.canvasNeedsRedraw[v]=false}t.data.topCanvas=t.data.canvases[0];t.data.canvases[Dd.NODE].setAttribute("data-id","layer"+Dd.NODE+"-node");t.data.canvases[Dd.SELECT_BOX].setAttribute("data-id","layer"+Dd.SELECT_BOX+"-selectbox");t.data.canvases[Dd.DRAG].setAttribute("data-id","layer"+Dd.DRAG+"-drag");t.data.canvases[Dd.WEBGL]&&t.data.canvases[Dd.WEBGL].setAttribute("data-id","layer"+Dd.WEBGL+"-webgl");for(v=0;v<Dd.BUFFER_COUNT;v++){t.data.bufferCanvases[v]=n.createElement("canvas");t.data.bufferContexts[v]=t.data.bufferCanvases[v].getContext("2d");t.data.bufferCanvases[v].style.position="absolute";t.data.bufferCanvases[v].setAttribute("data-id","buffer"+v);t.data.bufferCanvases[v].style.zIndex=String(-v-1);t.data.bufferCanvases[v].style.visibility="hidden"}t.pathsEnabled=true;var h=hr();var p=function getBoxCenter(e){return{x:(e.x1+e.x2)/2,y:(e.y1+e.y2)/2}};var g=function getCenterOffset(e){return{x:-e.w/2,y:-e.h/2}};var y=function backgroundTimestampHasChanged(e){var t=e[0]._private;var a=t.oldBackgroundTimestamp===t.backgroundTimestamp;return!a};var m=function getStyleKey(e){return e[0]._private.nodeKey};var b=function getLabelKey(e){return e[0]._private.labelStyleKey};var x=function getSourceLabelKey(e){return e[0]._private.sourceLabelStyleKey};var w=function getTargetLabelKey(e){return e[0]._private.targetLabelStyleKey};var E=function drawElement(e,a,n,i,o){return t.drawElement(e,a,n,false,false,o)};var T=function drawLabel(e,a,n,i,o){return t.drawElementText(e,a,n,i,"main",o)};var S=function drawSourceLabel(e,a,n,i,o){return t.drawElementText(e,a,n,i,"source",o)};var k=function drawTargetLabel(e,a,n,i,o){return t.drawElementText(e,a,n,i,"target",o)};var P=function getElementBox(e){e.boundingBox();return e[0]._private.bodyBounds};var D=function getLabelBox(e){e.boundingBox();return e[0]._private.labelBounds.main||h};var I=function getSourceLabelBox(e){e.boundingBox();return e[0]._private.labelBounds.source||h};var M=function getTargetLabelBox(e){e.boundingBox();return e[0]._private.labelBounds.target||h};var R=function isLabelVisibleAtScale(e,t){return t};var L=function getElementRotationPoint(e){return p(P(e))};var N=function addTextMargin(e,t,a){var n=e?e+"-":"";return{x:t.x+a.pstyle(n+"text-margin-x").pfValue,y:t.y+a.pstyle(n+"text-margin-y").pfValue}};var O=function getRsPt(e,t,a){var n=e[0]._private.rscratch;return{x:n[t],y:n[a]}};var z=function getLabelRotationPoint(e){return N("",O(e,"labelX","labelY"),e)};var V=function getSourceLabelRotationPoint(e){return N("source",O(e,"sourceLabelX","sourceLabelY"),e)};var q=function getTargetLabelRotationPoint(e){return N("target",O(e,"targetLabelX","targetLabelY"),e)};var j=function getElementRotationOffset(e){return g(P(e))};var H=function getSourceLabelRotationOffset(e){return g(I(e))};var W=function getTargetLabelRotationOffset(e){return g(M(e))};var X=function getLabelRotationOffset(e){var t=D(e);var a=g(D(e));if(e.isNode()){switch(e.pstyle("text-halign").value){case"left":a.x=-t.w-(t.leftPad||0);break;case"right":a.x=-(t.rightPad||0);break}switch(e.pstyle("text-valign").value){case"top":a.y=-t.h-(t.topPad||0);break;case"bottom":a.y=-(t.botPad||0);break}}return a};var Y=t.data.eleTxrCache=new mc(t,{getKey:m,doesEleInvalidateKey:y,drawElement:E,getBoundingBox:P,getRotationPoint:L,getRotationOffset:j,allowEdgeTxrCaching:false,allowParentTxrCaching:false});var G=t.data.lblTxrCache=new mc(t,{getKey:b,drawElement:T,getBoundingBox:D,getRotationPoint:z,getRotationOffset:X,isVisible:R});var K=t.data.slbTxrCache=new mc(t,{getKey:x,drawElement:S,getBoundingBox:I,getRotationPoint:V,getRotationOffset:H,isVisible:R});var U=t.data.tlbTxrCache=new mc(t,{getKey:w,drawElement:k,getBoundingBox:M,getRotationPoint:q,getRotationOffset:W,isVisible:R});var Z=t.data.lyrTxrCache=new Lc(t);t.onUpdateEleCalcs((function invalidateTextureCaches(e,t){Y.invalidateElements(t);G.invalidateElements(t);K.invalidateElements(t);U.invalidateElements(t);Z.invalidateElements(t);for(var a=0;a<t.length;a++){var n=t[a]._private;n.oldBackgroundTimestamp=n.backgroundTimestamp}}));var Q=function refineInLayers(e){for(var t=0;t<e.length;t++)Z.enqueueElementRefinement(e[t].ele)};Y.onDequeue(Q);G.onDequeue(Q);K.onDequeue(Q);U.onDequeue(Q);e.webgl&&t.initWebgl(e,{getStyleKey:m,getLabelKey:b,getSourceLabelKey:x,getTargetLabelKey:w,drawElement:E,drawLabel:T,drawSourceLabel:S,drawTargetLabel:k,getElementBox:P,getLabelBox:D,getSourceLabelBox:I,getTargetLabelBox:M,getElementRotationPoint:L,getElementRotationOffset:j,getLabelRotationPoint:z,getSourceLabelRotationPoint:V,getTargetLabelRotationPoint:q,getLabelRotationOffset:X,getSourceLabelRotationOffset:H,getTargetLabelRotationOffset:W})}Dd.redrawHint=function(e,t){var a=this;switch(e){case"eles":a.data.canvasNeedsRedraw[Dd.NODE]=t;break;case"drag":a.data.canvasNeedsRedraw[Dd.DRAG]=t;break;case"select":a.data.canvasNeedsRedraw[Dd.SELECT_BOX]=t;break;case"gc":a.data.gc=true;break}};var Ad=typeof Path2D!=="undefined";Dd.path2dEnabled=function(e){if(e===void 0)return this.pathsEnabled;this.pathsEnabled=!!e};Dd.usePaths=function(){return Ad&&this.pathsEnabled};Dd.setImgSmoothing=function(e,t){if(e.imageSmoothingEnabled!=null)e.imageSmoothingEnabled=t;else{e.webkitImageSmoothingEnabled=t;e.mozImageSmoothingEnabled=t;e.msImageSmoothingEnabled=t}};Dd.getImgSmoothing=function(e){return e.imageSmoothingEnabled!=null?e.imageSmoothingEnabled:e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled};Dd.makeOffscreenCanvas=function(e,t){var a;if((typeof OffscreenCanvas==="undefined"?"undefined":_typeof(OffscreenCanvas))!=="undefined")a=new OffscreenCanvas(e,t);else{var n=this.cy.window();var i=n.document;a=i.createElement("canvas");a.width=e;a.height=t}return a};[zc,qc,Kc,Zc,$c,Qc,ed,md,bd,kd,Pd].forEach((function(e){Y(Dd,e)}));var Bd=[{name:"null",impl:NullRenderer},{name:"base",impl:Yv},{name:"canvas",impl:_d}];var Id=[{type:"layout",extensions:$u},{type:"renderer",extensions:Bd}];var Md={};var Rd={};function setExtension(e,t,a){var n=a;var i=function overrideErr(a){st("Can not register `"+t+"` for `"+e+"` since `"+a+"` already exists in the prototype and can not be overridden")};if(e==="core"){if(yu.prototype[t])return i(t);yu.prototype[t]=a}else if(e==="collection"){if(zl.prototype[t])return i(t);zl.prototype[t]=a}else if(e==="layout"){var o=function Layout(e){this.options=e;a.call(this,e);c(this._private)||(this._private={});this._private.cy=e.cy;this._private.listeners=[];this.createEmitter()};var s=o.prototype=Object.create(a.prototype);var l=[];for(var u=0;u<l.length;u++){var v=l[u];s[v]=s[v]||function(){return this}}s.start&&!s.run?s.run=function(){this.start();return this}:!s.start&&s.run&&(s.start=function(){this.run();return this});var d=a.prototype.stop;s.stop=function(){var e=this.options;if(e&&e.animate){var t=this.animations;if(t)for(var a=0;a<t.length;a++)t[a].stop()}d?d.call(this):this.emit("layoutstop");return this};s.destroy||(s.destroy=function(){return this});s.cy=function(){return this._private.cy};var h=function getCy(e){return e._private.cy};var p={addEventFields:function addEventFields(e,t){t.layout=e;t.cy=h(e);t.target=e},bubble:function bubble(){return true},parent:function parent(e){return h(e)}};Y(s,{createEmitter:function createEmitter(){this._private.emitter=new Emitter(p,this);return this},emitter:function emitter(){return this._private.emitter},on:function on(e,t){this.emitter().on(e,t);return this},one:function one(e,t){this.emitter().one(e,t);return this},once:function once(e,t){this.emitter().one(e,t);return this},removeListener:function removeListener(e,t){this.emitter().removeListener(e,t);return this},removeAllListeners:function removeAllListeners(){this.emitter().removeAllListeners();return this},emit:function emit(e,t){this.emitter().emit(e,t);return this}});Fo.eventAliasesOn(s);n=o}else if(e==="renderer"&&t!=="null"&&t!=="base"){var g=getExtension("renderer","base");var y=g.prototype;var m=a;var b=a.prototype;var x=function Renderer(){g.apply(this,arguments);m.apply(this,arguments)};var w=x.prototype;for(var E in y){var T=y[E];var S=b[E]!=null;if(S)return i(E);w[E]=T}for(var k in b)w[k]=b[k];y.clientFunctions.forEach((function(e){w[e]=w[e]||function(){it("Renderer does not implement `renderer."+e+"()` on its prototype")}}));n=x}else if(e==="__proto__"||e==="constructor"||e==="prototype")return it(e+" is an illegal type to be registered, possibly lead to prototype pollutions");return ee({map:Md,keys:[e,t],value:n})}function getExtension(e,t){return te({map:Md,keys:[e,t]})}function setModule(e,t,a,n,i){return ee({map:Rd,keys:[e,t,a,n],value:i})}function getModule(e,t,a,n){return te({map:Rd,keys:[e,t,a,n]})}var Ld=function extension(){if(arguments.length===2)return getExtension.apply(null,arguments);if(arguments.length===3)return setExtension.apply(null,arguments);if(arguments.length===4)return getModule.apply(null,arguments);if(arguments.length===5)return setModule.apply(null,arguments);it("Invalid extension access syntax")};yu.prototype.extension=Ld;Id.forEach((function(e){e.extensions.forEach((function(t){setExtension(e.type,t.name,t.impl)}))}));var Nd=function Stylesheet(){if(!(this instanceof Nd))return new Nd;this.length=0};var Od=Nd.prototype;Od.instanceString=function(){return"stylesheet"};Od.selector=function(e){var t=this.length++;this[t]={selector:e,properties:[]};return this};Od.css=function(e,t){var a=this.length-1;if(l(e))this[a].properties.push({name:e,value:t});else if(c(e)){var n=e;var i=Object.keys(n);for(var o=0;o<i.length;o++){var s=i[o];var u=n[s];if(u!=null){var v=cu.properties[s]||cu.properties[M(s)];if(v!=null){var d=v.name;var h=u;this[a].properties.push({name:d,value:h})}}}}return this};Od.style=Od.css;Od.generateStyle=function(e){var t=new cu(e);return this.appendToStyle(t)};Od.appendToStyle=function(e){for(var t=0;t<this.length;t++){var a=this[t];var n=a.selector;var i=a.properties;e.selector(n);for(var o=0;o<i.length;o++){var s=i[o];e.css(s.name,s.value)}}return e};var Fd="3.31.2";var zd=function cytoscape(e){e===void 0&&(e={});return c(e)?new yu(e):l(e)?Ld.apply(Ld,arguments):void 0};zd.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(zd);e.apply(null,t);return this};zd.warnings=function(e){return ot(e)};zd.version=Fd;zd.stylesheet=zd.Stylesheet=Nd;export{zd as default};

